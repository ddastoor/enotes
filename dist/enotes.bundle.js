/*! For license information please see enotes.bundle.js.LICENSE.txt */
(()=>{var e={526:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=o(e),a=s[0],c=s[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,c)),h=0,l=c>0?a-4:a;for(r=0;r<l;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[h++]=t>>16&255,u[h++]=t>>8&255,u[h++]=255&t;return 2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[h++]=255&t),1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[h++]=t>>8&255,u[h++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],a=16383,o=0,u=n-i;o<u;o+=a)s.push(c(e,o,o+a>u?u:o+a));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=s[a],n[s.charCodeAt(a)]=a;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,s,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},312:(e,t,r)=>{var n;!function(){"use strict";var t="input is invalid type",i="object"==typeof window,s=i?window:{};s.JS_SHA256_NO_WINDOW&&(i=!1);var a=!i&&"object"==typeof self,o=!s.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;o?s=r.g:a&&(s=self);var c=!s.JS_SHA256_NO_COMMON_JS&&e.exports,u=r.amdO,h=!s.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,l="0123456789abcdef".split(""),f=[-2147483648,8388608,32768,128],y=[24,16,8,0],d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=["hex","array","digest","arrayBuffer"],g=[];!s.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!h||!s.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var A=function(e,t){return function(r){return new k(t,!0).update(r)[e]()}},w=function(e){var t=A("hex",e);o&&(t=m(t,e)),t.create=function(){return new k(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<p.length;++r){var n=p[r];t[n]=A(n,e)}return t},m=function(e,n){var i,a=r(394),o=r(903).Buffer,c=n?"sha224":"sha256";return i=o.from&&!s.JS_SHA256_NO_BUFFER_FROM?o.from:function(e){return new o(e)},function(r){if("string"==typeof r)return a.createHash(c).update(r,"utf8").digest("hex");if(null==r)throw new Error(t);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===o?a.createHash(c).update(i(r)).digest("hex"):e(r)}},b=function(e,t){return function(r,n){return new v(r,t,!0).update(n)[e]()}},E=function(e){var t=b("hex",e);t.create=function(t){return new v(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<p.length;++r){var n=p[r];t[n]=b(n,e)}return t};function k(e,t){t?(g[0]=g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0,this.blocks=g):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function v(e,r,n){var i,s=typeof e;if("string"===s){var a,o=[],c=e.length,u=0;for(i=0;i<c;++i)(a=e.charCodeAt(i))<128?o[u++]=a:a<2048?(o[u++]=192|a>>>6,o[u++]=128|63&a):a<55296||a>=57344?(o[u++]=224|a>>>12,o[u++]=128|a>>>6&63,o[u++]=128|63&a):(a=65536+((1023&a)<<10|1023&e.charCodeAt(++i)),o[u++]=240|a>>>18,o[u++]=128|a>>>12&63,o[u++]=128|a>>>6&63,o[u++]=128|63&a);e=o}else{if("object"!==s)throw new Error(t);if(null===e)throw new Error(t);if(h&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||h&&ArrayBuffer.isView(e)))throw new Error(t)}e.length>64&&(e=new k(r,!0).update(e).array());var l=[],f=[];for(i=0;i<64;++i){var y=e[i]||0;l[i]=92^y,f[i]=54^y}k.call(this,r,n),this.update(f),this.oKeyPad=l,this.inner=!0,this.sharedMemory=n}k.prototype.update=function(e){if(!this.finalized){var r,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(t);if(null===e)throw new Error(t);if(h&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||h&&ArrayBuffer.isView(e)))throw new Error(t);r=!0}for(var i,s,a=0,o=e.length,c=this.blocks;a<o;){if(this.hashed&&(this.hashed=!1,c[0]=this.block,this.block=c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),r)for(s=this.start;a<o&&s<64;++a)c[s>>>2]|=e[a]<<y[3&s++];else for(s=this.start;a<o&&s<64;++a)(i=e.charCodeAt(a))<128?c[s>>>2]|=i<<y[3&s++]:i<2048?(c[s>>>2]|=(192|i>>>6)<<y[3&s++],c[s>>>2]|=(128|63&i)<<y[3&s++]):i<55296||i>=57344?(c[s>>>2]|=(224|i>>>12)<<y[3&s++],c[s>>>2]|=(128|i>>>6&63)<<y[3&s++],c[s>>>2]|=(128|63&i)<<y[3&s++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++a)),c[s>>>2]|=(240|i>>>18)<<y[3&s++],c[s>>>2]|=(128|i>>>12&63)<<y[3&s++],c[s>>>2]|=(128|i>>>6&63)<<y[3&s++],c[s>>>2]|=(128|63&i)<<y[3&s++]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=c[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},k.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>>2]|=f[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},k.prototype.hash=function(){var e,t,r,n,i,s,a,o,c,u=this.h0,h=this.h1,l=this.h2,f=this.h3,y=this.h4,p=this.h5,g=this.h6,A=this.h7,w=this.blocks;for(e=16;e<64;++e)t=((i=w[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,r=((i=w[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,w[e]=w[e-16]+t+w[e-7]+r|0;for(c=h&l,e=0;e<64;e+=4)this.first?(this.is224?(s=300032,A=(i=w[0]-1413257819)-150054599|0,f=i+24177077|0):(s=704751109,A=(i=w[0]-210244248)-1521486534|0,f=i+143694565|0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(s=u&h)^u&l^c,A=f+(i=A+(r=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&p^~y&g)+d[e]+w[e])|0,f=i+(t+n)|0),t=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),n=(a=f&u)^f&h^s,g=l+(i=g+(r=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&y^~A&p)+d[e+1]+w[e+1])|0,t=((l=i+(t+n)|0)>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),n=(o=l&f)^l&u^a,p=h+(i=p+(r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&A^~g&y)+d[e+2]+w[e+2])|0,t=((h=i+(t+n)|0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),n=(c=h&l)^h&f^o,y=u+(i=y+(r=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&g^~p&A)+d[e+3]+w[e+3])|0,u=i+(t+n)|0,this.chromeBugWorkAround=!0;this.h0=this.h0+u|0,this.h1=this.h1+h|0,this.h2=this.h2+l|0,this.h3=this.h3+f|0,this.h4=this.h4+y|0,this.h5=this.h5+p|0,this.h6=this.h6+g|0,this.h7=this.h7+A|0},k.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,s=this.h5,a=this.h6,o=this.h7,c=l[e>>>28&15]+l[e>>>24&15]+l[e>>>20&15]+l[e>>>16&15]+l[e>>>12&15]+l[e>>>8&15]+l[e>>>4&15]+l[15&e]+l[t>>>28&15]+l[t>>>24&15]+l[t>>>20&15]+l[t>>>16&15]+l[t>>>12&15]+l[t>>>8&15]+l[t>>>4&15]+l[15&t]+l[r>>>28&15]+l[r>>>24&15]+l[r>>>20&15]+l[r>>>16&15]+l[r>>>12&15]+l[r>>>8&15]+l[r>>>4&15]+l[15&r]+l[n>>>28&15]+l[n>>>24&15]+l[n>>>20&15]+l[n>>>16&15]+l[n>>>12&15]+l[n>>>8&15]+l[n>>>4&15]+l[15&n]+l[i>>>28&15]+l[i>>>24&15]+l[i>>>20&15]+l[i>>>16&15]+l[i>>>12&15]+l[i>>>8&15]+l[i>>>4&15]+l[15&i]+l[s>>>28&15]+l[s>>>24&15]+l[s>>>20&15]+l[s>>>16&15]+l[s>>>12&15]+l[s>>>8&15]+l[s>>>4&15]+l[15&s]+l[a>>>28&15]+l[a>>>24&15]+l[a>>>20&15]+l[a>>>16&15]+l[a>>>12&15]+l[a>>>8&15]+l[a>>>4&15]+l[15&a];return this.is224||(c+=l[o>>>28&15]+l[o>>>24&15]+l[o>>>20&15]+l[o>>>16&15]+l[o>>>12&15]+l[o>>>8&15]+l[o>>>4&15]+l[15&o]),c},k.prototype.toString=k.prototype.hex,k.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,s=this.h5,a=this.h6,o=this.h7,c=[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,s>>>24&255,s>>>16&255,s>>>8&255,255&s,a>>>24&255,a>>>16&255,a>>>8&255,255&a];return this.is224||c.push(o>>>24&255,o>>>16&255,o>>>8&255,255&o),c},k.prototype.array=k.prototype.digest,k.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},v.prototype=new k,v.prototype.finalize=function(){if(k.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();k.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),k.prototype.finalize.call(this)}};var B=w();B.sha256=B,B.sha224=w(!0),B.sha256.hmac=E(),B.sha224.hmac=E(!0),c?e.exports=B:(s.sha256=B.sha256,s.sha224=B.sha224,u&&(void 0===(n=function(){return B}.call(B,r,B,e))||(e.exports=n)))}()},903:()=>{},394:()=>{},806:(e,t,r)=>{"use strict";function n(e,t){return function(){return e.apply(t,arguments)}}const{toString:i}=Object.prototype,{getPrototypeOf:s}=Object,a=(o=Object.create(null),e=>{const t=i.call(e);return o[t]||(o[t]=t.slice(8,-1).toLowerCase())});var o;const c=e=>(e=e.toLowerCase(),t=>a(t)===e),u=e=>t=>typeof t===e,{isArray:h}=Array,l=u("undefined"),f=c("ArrayBuffer"),y=u("string"),d=u("function"),p=u("number"),g=e=>null!==e&&"object"==typeof e,A=e=>{if("object"!==a(e))return!1;const t=s(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},w=c("Date"),m=c("File"),b=c("Blob"),E=c("FileList"),k=c("URLSearchParams"),[v,B,S,I]=["ReadableStream","Request","Response","Headers"].map(c);function C(e,t,{allOwnKeys:r=!1}={}){if(null==e)return;let n,i;if("object"!=typeof e&&(e=[e]),h(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let a;for(n=0;n<s;n++)a=i[n],t.call(null,e[a],a,e)}}function K(e,t){t=t.toLowerCase();const r=Object.keys(e);let n,i=r.length;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const P="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:r.g,U=e=>!l(e)&&e!==P,D=(x="undefined"!=typeof Uint8Array&&s(Uint8Array),e=>x&&e instanceof x);var x;const R=c("HTMLFormElement"),T=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),_=c("RegExp"),L=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};C(r,((r,i)=>{let s;!1!==(s=t(r,i,e))&&(n[i]=s||r)})),Object.defineProperties(e,n)},Q="abcdefghijklmnopqrstuvwxyz",O="0123456789",M={DIGIT:O,ALPHA:Q,ALPHA_DIGIT:Q+Q.toUpperCase()+O},N=c("AsyncFunction"),F=(H="function"==typeof setImmediate,z=d(P.postMessage),H?setImmediate:z?(j=`axios@${Math.random()}`,G=[],P.addEventListener("message",(({source:e,data:t})=>{e===P&&t===j&&G.length&&G.shift()()}),!1),e=>{G.push(e),P.postMessage(j,"*")}):e=>setTimeout(e));var H,z,j,G;const q="undefined"!=typeof queueMicrotask?queueMicrotask.bind(P):"undefined"!=typeof process&&process.nextTick||F;var V={isArray:h,isArrayBuffer:f,isBuffer:function(e){return null!==e&&!l(e)&&null!==e.constructor&&!l(e.constructor)&&d(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||d(e.append)&&("formdata"===(t=a(e))||"object"===t&&d(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&f(e.buffer),t},isString:y,isNumber:p,isBoolean:e=>!0===e||!1===e,isObject:g,isPlainObject:A,isReadableStream:v,isRequest:B,isResponse:S,isHeaders:I,isUndefined:l,isDate:w,isFile:m,isBlob:b,isRegExp:_,isFunction:d,isStream:e=>g(e)&&d(e.pipe),isURLSearchParams:k,isTypedArray:D,isFileList:E,forEach:C,merge:function e(){const{caseless:t}=U(this)&&this||{},r={},n=(n,i)=>{const s=t&&K(r,i)||i;A(r[s])&&A(n)?r[s]=e(r[s],n):A(n)?r[s]=e({},n):h(n)?r[s]=n.slice():r[s]=n};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&C(arguments[e],n);return r},extend:(e,t,r,{allOwnKeys:i}={})=>(C(t,((t,i)=>{r&&d(t)?e[i]=n(t,r):e[i]=t}),{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let i,a,o;const c={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],n&&!n(o,e,t)||c[o]||(t[o]=e[o],c[o]=!0);e=!1!==r&&s(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:a,kindOfTest:c,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(h(e))return e;let t=e.length;if(!p(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:R,hasOwnProperty:T,hasOwnProp:T,reduceDescriptors:L,freezeMethods:e=>{L(e,((t,r)=>{if(d(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];d(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach((e=>{r[e]=!0}))};return h(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:K,global:P,isContextDefined:U,ALPHABET:M,generateString:(e=16,t=M.ALPHA_DIGIT)=>{let r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r},isSpecCompliantForm:function(e){return!!(e&&d(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(g(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const i=h(e)?[]:{};return C(e,((e,t)=>{const s=r(e,n+1);!l(s)&&(i[t]=s)})),t[n]=void 0,i}}return e};return r(e,0)},isAsyncFn:N,isThenable:e=>e&&(g(e)||d(e))&&d(e.then)&&d(e.catch),setImmediate:F,asap:q};function J(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}V.inherits(J,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:V.toJSONObject(this.config),code:this.code,status:this.status}}});const W=J.prototype,$={};function Y(e){return V.isPlainObject(e)||V.isArray(e)}function Z(e){return V.endsWith(e,"[]")?e.slice(0,-2):e}function X(e,t,r){return e?e.concat(t).map((function(e,t){return e=Z(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{$[e]={value:e}})),Object.defineProperties(J,$),Object.defineProperty(W,"isAxiosError",{value:!0}),J.from=(e,t,r,n,i,s)=>{const a=Object.create(W);return V.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),J.call(a,e.message,t,r,n,i),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const ee=V.toFlatObject(V,{},null,(function(e){return/^is[A-Z]/.test(e)}));function te(e,t,r){if(!V.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=V.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!V.isUndefined(t[e])}))).metaTokens,i=r.visitor||u,s=r.dots,a=r.indexes,o=(r.Blob||"undefined"!=typeof Blob&&Blob)&&V.isSpecCompliantForm(t);if(!V.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(V.isDate(e))return e.toISOString();if(!o&&V.isBlob(e))throw new J("Blob is not supported. Use a Buffer instead.");return V.isArrayBuffer(e)||V.isTypedArray(e)?o&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function u(e,r,i){let o=e;if(e&&!i&&"object"==typeof e)if(V.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(V.isArray(e)&&function(e){return V.isArray(e)&&!e.some(Y)}(e)||(V.isFileList(e)||V.endsWith(r,"[]"))&&(o=V.toArray(e)))return r=Z(r),o.forEach((function(e,n){!V.isUndefined(e)&&null!==e&&t.append(!0===a?X([r],n,s):null===a?r:r+"[]",c(e))})),!1;return!!Y(e)||(t.append(X(i,r,s),c(e)),!1)}const h=[],l=Object.assign(ee,{defaultVisitor:u,convertValue:c,isVisitable:Y});if(!V.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!V.isUndefined(r)){if(-1!==h.indexOf(r))throw Error("Circular reference detected in "+n.join("."));h.push(r),V.forEach(r,(function(r,s){!0===(!(V.isUndefined(r)||null===r)&&i.call(t,r,V.isString(s)?s.trim():s,n,l))&&e(r,n?n.concat(s):[s])})),h.pop()}}(e),t}function re(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function ne(e,t){this._pairs=[],e&&te(e,this,t)}const ie=ne.prototype;function se(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ae(e,t,r){if(!t)return e;const n=r&&r.encode||se;V.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(s=i?i(t,r):V.isURLSearchParams(t)?t.toString():new ne(t,r).toString(n),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}ie.append=function(e,t){this._pairs.push([e,t])},ie.toString=function(e){const t=e?function(t){return e.call(this,t,re)}:re;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var oe=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){V.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},ce={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ue={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ne,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const he="undefined"!=typeof window&&"undefined"!=typeof document,le="object"==typeof navigator&&navigator||void 0,fe=he&&(!le||["ReactNative","NativeScript","NS"].indexOf(le.product)<0),ye="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,de=he&&window.location.href||"http://localhost";var pe={...Object.freeze({__proto__:null,hasBrowserEnv:he,hasStandardBrowserWebWorkerEnv:ye,hasStandardBrowserEnv:fe,navigator:le,origin:de}),...ue};function ge(e){function t(e,r,n,i){let s=e[i++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=i>=e.length;return s=!s&&V.isArray(n)?n.length:s,o?(V.hasOwnProp(n,s)?n[s]=[n[s],r]:n[s]=r,!a):(n[s]&&V.isObject(n[s])||(n[s]=[]),t(e,r,n[s],i)&&V.isArray(n[s])&&(n[s]=function(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}(n[s])),!a)}if(V.isFormData(e)&&V.isFunction(e.entries)){const r={};return V.forEachEntry(e,((e,n)=>{t(function(e){return V.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,r,0)})),r}return null}const Ae={transitional:ce,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,i=V.isObject(e);if(i&&V.isHTMLForm(e)&&(e=new FormData(e)),V.isFormData(e))return n?JSON.stringify(ge(e)):e;if(V.isArrayBuffer(e)||V.isBuffer(e)||V.isStream(e)||V.isFile(e)||V.isBlob(e)||V.isReadableStream(e))return e;if(V.isArrayBufferView(e))return e.buffer;if(V.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return te(e,new pe.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,n){return pe.isNode&&V.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=V.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return te(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),function(e){if(V.isString(e))try{return(0,JSON.parse)(e),V.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Ae.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(V.isResponse(e)||V.isReadableStream(e))return e;if(e&&V.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw J.from(e,J.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pe.classes.FormData,Blob:pe.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};V.forEach(["delete","get","head","post","put","patch"],(e=>{Ae.headers[e]={}}));var we=Ae;const me=V.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),be=Symbol("internals");function Ee(e){return e&&String(e).trim().toLowerCase()}function ke(e){return!1===e||null==e?e:V.isArray(e)?e.map(ke):String(e)}function ve(e,t,r,n,i){return V.isFunction(n)?n.call(this,t,r):(i&&(t=r),V.isString(t)?V.isString(n)?-1!==t.indexOf(n):V.isRegExp(n)?n.test(t):void 0:void 0)}class Be{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function i(e,t,r){const i=Ee(t);if(!i)throw new Error("header name must be a non-empty string");const s=V.findKey(n,i);(!s||void 0===n[s]||!0===r||void 0===r&&!1!==n[s])&&(n[s||t]=ke(e))}const s=(e,t)=>V.forEach(e,((e,r)=>i(e,r,t)));if(V.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(V.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let r,n,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),r=e.substring(0,i).trim().toLowerCase(),n=e.substring(i+1).trim(),!r||t[r]&&me[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)})),t})(e),t);else if(V.isHeaders(e))for(const[t,n]of e.entries())i(n,t,r);else null!=e&&i(t,e,r);return this}get(e,t){if(e=Ee(e)){const r=V.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(V.isFunction(t))return t.call(this,e,r);if(V.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ee(e)){const r=V.findKey(this,e);return!(!r||void 0===this[r]||t&&!ve(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function i(e){if(e=Ee(e)){const i=V.findKey(r,e);!i||t&&!ve(0,r[i],i,t)||(delete r[i],n=!0)}}return V.isArray(e)?e.forEach(i):i(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const i=t[r];e&&!ve(0,this[i],i,e,!0)||(delete this[i],n=!0)}return n}normalize(e){const t=this,r={};return V.forEach(this,((n,i)=>{const s=V.findKey(r,i);if(s)return t[s]=ke(n),void delete t[i];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,r)=>t.toUpperCase()+r))}(i):String(i).trim();a!==i&&delete t[i],t[a]=ke(n),r[a]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return V.forEach(this,((r,n)=>{null!=r&&!1!==r&&(t[n]=e&&V.isArray(r)?r.join(", "):r)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach((e=>r.set(e))),r}static accessor(e){const t=(this[be]=this[be]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=Ee(e);t[n]||(function(e,t){const r=V.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+r,{value:function(e,r,i){return this[n].call(this,t,e,r,i)},configurable:!0})}))}(r,e),t[n]=!0)}return V.isArray(e)?e.forEach(n):n(e),this}}Be.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),V.reduceDescriptors(Be.prototype,(({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[r]=e}}})),V.freezeMethods(Be);var Se=Be;function Ie(e,t){const r=this||we,n=t||r,i=Se.from(n.headers);let s=n.data;return V.forEach(e,(function(e){s=e.call(r,s,i.normalize(),t?t.status:void 0)})),i.normalize(),s}function Ce(e){return!(!e||!e.__CANCEL__)}function Ke(e,t,r){J.call(this,null==e?"canceled":e,J.ERR_CANCELED,t,r),this.name="CanceledError"}function Pe(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new J("Request failed with status code "+r.status,[J.ERR_BAD_REQUEST,J.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}V.inherits(Ke,J,{__CANCEL__:!0});const Ue=(e,t,r=3)=>{let n=0;const i=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i,s=0,a=0;return t=void 0!==t?t:1e3,function(o){const c=Date.now(),u=n[a];i||(i=c),r[s]=o,n[s]=c;let h=a,l=0;for(;h!==s;)l+=r[h++],h%=e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),c-i<t)return;const f=u&&c-u;return f?Math.round(1e3*l/f):void 0}}(50,250);return function(e,t){let r,n,i=0,s=1e3/t;const a=(t,s=Date.now())=>{i=s,r=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),o=t-i;o>=s?a(e,t):(r=e,n||(n=setTimeout((()=>{n=null,a(r)}),s-o)))},()=>r&&a(r)]}((r=>{const s=r.loaded,a=r.lengthComputable?r.total:void 0,o=s-n,c=i(o);n=s,e({loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:c||void 0,estimated:c&&a&&s<=a?(a-s)/c:void 0,event:r,lengthComputable:null!=a,[t?"download":"upload"]:!0})}),r)},De=(e,t)=>{const r=null!=e;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},xe=e=>(...t)=>V.asap((()=>e(...t)));var Re=pe.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,pe.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(pe.origin),pe.navigator&&/(msie|trident)/i.test(pe.navigator.userAgent)):()=>!0,Te=pe.hasStandardBrowserEnv?{write(e,t,r,n,i,s){const a=[e+"="+encodeURIComponent(t)];V.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),V.isString(n)&&a.push("path="+n),V.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function _e(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Le=e=>e instanceof Se?{...e}:e;function Qe(e,t){t=t||{};const r={};function n(e,t,r,n){return V.isPlainObject(e)&&V.isPlainObject(t)?V.merge.call({caseless:n},e,t):V.isPlainObject(t)?V.merge({},t):V.isArray(t)?t.slice():t}function i(e,t,r,i){return V.isUndefined(t)?V.isUndefined(e)?void 0:n(void 0,e,0,i):n(e,t,0,i)}function s(e,t){if(!V.isUndefined(t))return n(void 0,t)}function a(e,t){return V.isUndefined(t)?V.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function o(r,i,s){return s in t?n(r,i):s in e?n(void 0,r):void 0}const c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(e,t,r)=>i(Le(e),Le(t),0,!0)};return V.forEach(Object.keys(Object.assign({},e,t)),(function(n){const s=c[n]||i,a=s(e[n],t[n],n);V.isUndefined(a)&&s!==o||(r[n]=a)})),r}var Oe=e=>{const t=Qe({},e);let r,{data:n,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:c}=t;if(t.headers=o=Se.from(o),t.url=ae(_e(t.baseURL,t.url),e.params,e.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),V.isFormData(n))if(pe.hasStandardBrowserEnv||pe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(r=o.getContentType())){const[e,...t]=r?r.split(";").map((e=>e.trim())).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(pe.hasStandardBrowserEnv&&(i&&V.isFunction(i)&&(i=i(t)),i||!1!==i&&Re(t.url))){const e=s&&a&&Te.read(a);e&&o.set(s,e)}return t},Me="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,r){const n=Oe(e);let i=n.data;const s=Se.from(n.headers).normalize();let a,o,c,u,h,{responseType:l,onUploadProgress:f,onDownloadProgress:y}=n;function d(){u&&u(),h&&h(),n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}let p=new XMLHttpRequest;function g(){if(!p)return;const n=Se.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());Pe((function(e){t(e),d()}),(function(e){r(e),d()}),{data:l&&"text"!==l&&"json"!==l?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p}),p=null}p.open(n.method.toUpperCase(),n.url,!0),p.timeout=n.timeout,"onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(g)},p.onabort=function(){p&&(r(new J("Request aborted",J.ECONNABORTED,e,p)),p=null)},p.onerror=function(){r(new J("Network Error",J.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const i=n.transitional||ce;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),r(new J(t,i.clarifyTimeoutError?J.ETIMEDOUT:J.ECONNABORTED,e,p)),p=null},void 0===i&&s.setContentType(null),"setRequestHeader"in p&&V.forEach(s.toJSON(),(function(e,t){p.setRequestHeader(t,e)})),V.isUndefined(n.withCredentials)||(p.withCredentials=!!n.withCredentials),l&&"json"!==l&&(p.responseType=n.responseType),y&&([c,h]=Ue(y,!0),p.addEventListener("progress",c)),f&&p.upload&&([o,u]=Ue(f),p.upload.addEventListener("progress",o),p.upload.addEventListener("loadend",u)),(n.cancelToken||n.signal)&&(a=t=>{p&&(r(!t||t.type?new Ke(null,e,p):t),p.abort(),p=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const A=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);A&&-1===pe.protocols.indexOf(A)?r(new J("Unsupported protocol "+A+":",J.ERR_BAD_REQUEST,e)):p.send(i||null)}))},Ne=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,n=new AbortController;const i=function(e){if(!r){r=!0,a();const t=e instanceof Error?e:this.reason;n.abort(t instanceof J?t:new Ke(t instanceof Error?t.message:t))}};let s=t&&setTimeout((()=>{s=null,i(new J(`timeout ${t} of ms exceeded`,J.ETIMEDOUT))}),t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)})),e=null)};e.forEach((e=>e.addEventListener("abort",i)));const{signal:o}=n;return o.unsubscribe=()=>V.asap(a),o}};const Fe=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let n,i=0;for(;i<r;)n=i+t,yield e.slice(i,n),i=n},He=(e,t,r,n)=>{const i=async function*(e,t){for await(const r of async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)break;yield r}}finally{await t.cancel()}}(e))yield*Fe(r,t)}(e,t);let s,a=0,o=e=>{s||(s=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await i.next();if(t)return o(),void e.close();let s=n.byteLength;if(r){let e=a+=s;r(e)}e.enqueue(new Uint8Array(n))}catch(e){throw o(e),e}},cancel:e=>(o(e),i.return())},{highWaterMark:2})},ze="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,je=ze&&"function"==typeof ReadableStream,Ge=ze&&("function"==typeof TextEncoder?(qe=new TextEncoder,e=>qe.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var qe;const Ve=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},Je=je&&Ve((()=>{let e=!1;const t=new Request(pe.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),We=je&&Ve((()=>V.isReadableStream(new Response("").body))),$e={stream:We&&(e=>e.body)};ze&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!$e[t]&&($e[t]=V.isFunction(e[t])?e=>e[t]():(e,r)=>{throw new J(`Response type '${t}' is not supported`,J.ERR_NOT_SUPPORT,r)})}))})(new Response);const Ye={http:null,xhr:Me,fetch:ze&&(async e=>{let{url:t,method:r,data:n,signal:i,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:c,responseType:u,headers:h,withCredentials:l="same-origin",fetchOptions:f}=Oe(e);u=u?(u+"").toLowerCase():"text";let y,d=Ne([i,s&&s.toAbortSignal()],a);const p=d&&d.unsubscribe&&(()=>{d.unsubscribe()});let g;try{if(c&&Je&&"get"!==r&&"head"!==r&&0!==(g=await(async(e,t)=>{const r=V.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(V.isBlob(e))return e.size;if(V.isSpecCompliantForm(e)){const t=new Request(pe.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return V.isArrayBufferView(e)||V.isArrayBuffer(e)?e.byteLength:(V.isURLSearchParams(e)&&(e+=""),V.isString(e)?(await Ge(e)).byteLength:void 0)})(t):r})(h,n))){let e,r=new Request(t,{method:"POST",body:n,duplex:"half"});if(V.isFormData(n)&&(e=r.headers.get("content-type"))&&h.setContentType(e),r.body){const[e,t]=De(g,Ue(xe(c)));n=He(r.body,65536,e,t)}}V.isString(l)||(l=l?"include":"omit");const i="credentials"in Request.prototype;y=new Request(t,{...f,signal:d,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:i?l:void 0});let s=await fetch(y);const a=We&&("stream"===u||"response"===u);if(We&&(o||a&&p)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=s[t]}));const t=V.toFiniteNumber(s.headers.get("content-length")),[r,n]=o&&De(t,Ue(xe(o),!0))||[];s=new Response(He(s.body,65536,r,(()=>{n&&n(),p&&p()})),e)}u=u||"text";let A=await $e[V.findKey($e,u)||"text"](s,e);return!a&&p&&p(),await new Promise(((t,r)=>{Pe(t,r,{data:A,headers:Se.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:y})}))}catch(t){if(p&&p(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new J("Network Error",J.ERR_NETWORK,e,y),{cause:t.cause||t});throw J.from(t,t&&t.code,e,y)}})};V.forEach(Ye,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const Ze=e=>`- ${e}`,Xe=e=>V.isFunction(e)||null===e||!1===e;var et=e=>{e=V.isArray(e)?e:[e];const{length:t}=e;let r,n;const i={};for(let s=0;s<t;s++){let t;if(r=e[s],n=r,!Xe(r)&&(n=Ye[(t=String(r)).toLowerCase()],void 0===n))throw new J(`Unknown adapter '${t}'`);if(n)break;i[t||"#"+s]=n}if(!n){const e=Object.entries(i).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));throw new J("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(Ze).join("\n"):" "+Ze(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n};function tt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ke(null,e)}function rt(e){return tt(e),e.headers=Se.from(e.headers),e.data=Ie.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),et(e.adapter||we.adapter)(e).then((function(t){return tt(e),t.data=Ie.call(e,e.transformResponse,t),t.headers=Se.from(t.headers),t}),(function(t){return Ce(t)||(tt(e),t&&t.response&&(t.response.data=Ie.call(e,e.transformResponse,t.response),t.response.headers=Se.from(t.response.headers))),Promise.reject(t)}))}const nt={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{nt[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));const it={};nt.transitional=function(e,t,r){function n(e,t){return"[Axios v1.7.9] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,i,s)=>{if(!1===e)throw new J(n(i," has been removed"+(t?" in "+t:"")),J.ERR_DEPRECATED);return t&&!it[i]&&(it[i]=!0,console.warn(n(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,s)}},nt.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};var st={assertOptions:function(e,t,r){if("object"!=typeof e)throw new J("options must be an object",J.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],a=t[s];if(a){const t=e[s],r=void 0===t||a(t,s,e);if(!0!==r)throw new J("option "+s+" must be "+r,J.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new J("Unknown option "+s,J.ERR_BAD_OPTION)}},validators:nt};const at=st.validators;class ot{constructor(e){this.defaults=e,this.interceptors={request:new oe,response:new oe}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const r=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?r&&!String(e.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+r):e.stack=r}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Qe(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:i}=t;void 0!==r&&st.assertOptions(r,{silentJSONParsing:at.transitional(at.boolean),forcedJSONParsing:at.transitional(at.boolean),clarifyTimeoutError:at.transitional(at.boolean)},!1),null!=n&&(V.isFunction(n)?t.paramsSerializer={serialize:n}:st.assertOptions(n,{encode:at.function,serialize:at.function},!0)),st.assertOptions(t,{baseUrl:at.spelling("baseURL"),withXsrfToken:at.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=i&&V.merge(i.common,i[t.method]);i&&V.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=Se.concat(s,i);const a=[];let o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const c=[];let u;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let h,l=0;if(!o){const e=[rt.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,c),h=e.length,u=Promise.resolve(t);l<h;)u=u.then(e[l++],e[l++]);return u}h=a.length;let f=t;for(l=0;l<h;){const e=a[l++],t=a[l++];try{f=e(f)}catch(e){t.call(this,e);break}}try{u=rt.call(this,f)}catch(e){return Promise.reject(e)}for(l=0,h=c.length;l<h;)u=u.then(c[l++],c[l++]);return u}getUri(e){return ae(_e((e=Qe(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}V.forEach(["delete","get","head","options"],(function(e){ot.prototype[e]=function(t,r){return this.request(Qe(r||{},{method:e,url:t,data:(r||{}).data}))}})),V.forEach(["post","put","patch"],(function(e){function t(t){return function(r,n,i){return this.request(Qe(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}ot.prototype[e]=t(),ot.prototype[e+"Form"]=t(!0)}));var ct=ot;class ut{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const r=this;this.promise.then((e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e,n,i){r.reason||(r.reason=new Ke(e,n,i),t(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new ut((function(t){e=t})),cancel:e}}}var ht=ut;const lt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(lt).forEach((([e,t])=>{lt[t]=e}));var ft=lt;const yt=function e(t){const r=new ct(t),i=n(ct.prototype.request,r);return V.extend(i,ct.prototype,r,{allOwnKeys:!0}),V.extend(i,r,null,{allOwnKeys:!0}),i.create=function(r){return e(Qe(t,r))},i}(we);yt.Axios=ct,yt.CanceledError=Ke,yt.CancelToken=ht,yt.isCancel=Ce,yt.VERSION="1.7.9",yt.toFormData=te,yt.AxiosError=J,yt.Cancel=yt.CanceledError,yt.all=function(e){return Promise.all(e)},yt.spread=function(e){return function(t){return e.apply(null,t)}},yt.isAxiosError=function(e){return V.isObject(e)&&!0===e.isAxiosError},yt.mergeConfig=Qe,yt.AxiosHeaders=Se,yt.formToJSON=e=>ge(V.isHTMLForm(e)?new FormData(e):e),yt.getAdapter=et,yt.HttpStatusCode=ft,yt.default=yt,e.exports=yt},182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.validate=t.v7=t.v6ToV1=t.v6=t.v5=t.v4=t.v3=t.v1ToV6=t.v1=t.stringify=t.parse=t.NIL=t.MAX=void 0;var n=r(196);Object.defineProperty(t,"MAX",{enumerable:!0,get:function(){return n.default}});var i=r(465);Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return i.default}});var s=r(797);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return s.default}});var a=r(11);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return a.default}});var o=r(425);Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return o.default}});var c=r(568);Object.defineProperty(t,"v1ToV6",{enumerable:!0,get:function(){return c.default}});var u=r(591);Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return u.default}});var h=r(286);Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return h.default}});var l=r(557);Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return l.default}});var f=r(356);Object.defineProperty(t,"v6",{enumerable:!0,get:function(){return f.default}});var y=r(268);Object.defineProperty(t,"v6ToV1",{enumerable:!0,get:function(){return y.default}});var d=r(299);Object.defineProperty(t,"v7",{enumerable:!0,get:function(){return d.default}});var p=r(746);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return p.default}});var g=r(770);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return g.default}})},196:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="ffffffff-ffff-ffff-ffff-ffffffffffff"},338:(e,t)=>{"use strict";function r(e){return 14+(e+64>>>9<<4)+1}function n(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,r,i,s,a){return n((o=n(n(t,e),n(i,a)))<<(c=s)|o>>>32-c,r);var o,c}function s(e,t,r,n,s,a,o){return i(t&r|~t&n,e,t,s,a,o)}function a(e,t,r,n,s,a,o){return i(t&n|r&~n,e,t,s,a,o)}function o(e,t,r,n,s,a,o){return i(t^r^n,e,t,s,a,o)}function c(e,t,r,n,s,a,o){return i(r^(t|~n),e,t,s,a,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(e){const t=new Uint8Array(4*e.length);for(let r=0;r<4*e.length;r++)t[r]=e[r>>2]>>>r%4*8&255;return t}(function(e,t){const i=new Uint32Array(r(t)).fill(0);i.set(e),i[t>>5]|=128<<t%32,i[i.length-1]=t,e=i;let u=1732584193,h=-271733879,l=-1732584194,f=271733878;for(let t=0;t<e.length;t+=16){const r=u,i=h,y=l,d=f;u=s(u,h,l,f,e[t],7,-680876936),f=s(f,u,h,l,e[t+1],12,-389564586),l=s(l,f,u,h,e[t+2],17,606105819),h=s(h,l,f,u,e[t+3],22,-1044525330),u=s(u,h,l,f,e[t+4],7,-176418897),f=s(f,u,h,l,e[t+5],12,1200080426),l=s(l,f,u,h,e[t+6],17,-1473231341),h=s(h,l,f,u,e[t+7],22,-45705983),u=s(u,h,l,f,e[t+8],7,1770035416),f=s(f,u,h,l,e[t+9],12,-1958414417),l=s(l,f,u,h,e[t+10],17,-42063),h=s(h,l,f,u,e[t+11],22,-1990404162),u=s(u,h,l,f,e[t+12],7,1804603682),f=s(f,u,h,l,e[t+13],12,-40341101),l=s(l,f,u,h,e[t+14],17,-1502002290),h=s(h,l,f,u,e[t+15],22,1236535329),u=a(u,h,l,f,e[t+1],5,-165796510),f=a(f,u,h,l,e[t+6],9,-1069501632),l=a(l,f,u,h,e[t+11],14,643717713),h=a(h,l,f,u,e[t],20,-373897302),u=a(u,h,l,f,e[t+5],5,-701558691),f=a(f,u,h,l,e[t+10],9,38016083),l=a(l,f,u,h,e[t+15],14,-660478335),h=a(h,l,f,u,e[t+4],20,-405537848),u=a(u,h,l,f,e[t+9],5,568446438),f=a(f,u,h,l,e[t+14],9,-1019803690),l=a(l,f,u,h,e[t+3],14,-187363961),h=a(h,l,f,u,e[t+8],20,1163531501),u=a(u,h,l,f,e[t+13],5,-1444681467),f=a(f,u,h,l,e[t+2],9,-51403784),l=a(l,f,u,h,e[t+7],14,1735328473),h=a(h,l,f,u,e[t+12],20,-1926607734),u=o(u,h,l,f,e[t+5],4,-378558),f=o(f,u,h,l,e[t+8],11,-2022574463),l=o(l,f,u,h,e[t+11],16,1839030562),h=o(h,l,f,u,e[t+14],23,-35309556),u=o(u,h,l,f,e[t+1],4,-1530992060),f=o(f,u,h,l,e[t+4],11,1272893353),l=o(l,f,u,h,e[t+7],16,-155497632),h=o(h,l,f,u,e[t+10],23,-1094730640),u=o(u,h,l,f,e[t+13],4,681279174),f=o(f,u,h,l,e[t],11,-358537222),l=o(l,f,u,h,e[t+3],16,-722521979),h=o(h,l,f,u,e[t+6],23,76029189),u=o(u,h,l,f,e[t+9],4,-640364487),f=o(f,u,h,l,e[t+12],11,-421815835),l=o(l,f,u,h,e[t+15],16,530742520),h=o(h,l,f,u,e[t+2],23,-995338651),u=c(u,h,l,f,e[t],6,-198630844),f=c(f,u,h,l,e[t+7],10,1126891415),l=c(l,f,u,h,e[t+14],15,-1416354905),h=c(h,l,f,u,e[t+5],21,-57434055),u=c(u,h,l,f,e[t+12],6,1700485571),f=c(f,u,h,l,e[t+3],10,-1894986606),l=c(l,f,u,h,e[t+10],15,-1051523),h=c(h,l,f,u,e[t+1],21,-2054922799),u=c(u,h,l,f,e[t+8],6,1873313359),f=c(f,u,h,l,e[t+15],10,-30611744),l=c(l,f,u,h,e[t+6],15,-1560198380),h=c(h,l,f,u,e[t+13],21,1309151649),u=c(u,h,l,f,e[t+4],6,-145523070),f=c(f,u,h,l,e[t+11],10,-1120210379),l=c(l,f,u,h,e[t+2],15,718787259),h=c(h,l,f,u,e[t+9],21,-343485551),u=n(u,r),h=n(h,i),l=n(l,y),f=n(f,d)}return Uint32Array.of(u,h,l,f)}(function(e){if(0===e.length)return new Uint32Array;const t=new Uint32Array(r(8*e.length)).fill(0);for(let r=0;r<e.length;r++)t[r>>2]|=(255&e[r])<<r%4*8;return t}(e),8*e.length))}},779:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:r}},465:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="00000000-0000-0000-0000-000000000000"},797:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(746);t.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)}},697:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i},291:(e,t)=>{"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0});const n=new Uint8Array(16);t.default=function(){if(!r){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(n)}},829:(e,t)=>{"use strict";function r(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function n(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520],s=new Uint8Array(e.length+1);s.set(e),s[e.length]=128;const a=(e=s).length/4+2,o=Math.ceil(a/16),c=new Array(o);for(let t=0;t<o;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];c[t]=r}c[o-1][14]=8*(e.length-1)/Math.pow(2,32),c[o-1][14]=Math.floor(c[o-1][14]),c[o-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<o;++e){const s=new Uint32Array(80);for(let t=0;t<16;++t)s[t]=c[e][t];for(let e=16;e<80;++e)s[e]=n(s[e-3]^s[e-8]^s[e-14]^s[e-16],1);let a=i[0],o=i[1],u=i[2],h=i[3],l=i[4];for(let e=0;e<80;++e){const i=Math.floor(e/20),c=n(a,5)+r(i,o,u,h)+l+t[i]+s[e]>>>0;l=h,h=u,u=n(o,30)>>>0,o=a,a=c}i[0]=i[0]+a>>>0,i[1]=i[1]+o>>>0,i[2]=i[2]+u>>>0,i[3]=i[3]+h>>>0,i[4]=i[4]+l>>>0}return Uint8Array.of(i[0]>>24,i[0]>>16,i[0]>>8,i[0],i[1]>>24,i[1]>>16,i[1]>>8,i[1],i[2]>>24,i[2]>>16,i[2]>>8,i[2],i[3]>>24,i[3]>>16,i[3]>>8,i[3],i[4]>>24,i[4]>>16,i[4]>>8,i[4])}},11:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeStringify=void 0;const n=r(746),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function s(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}t.unsafeStringify=s,t.default=function(e,t=0){const r=s(e,t);if(!(0,n.default)(r))throw TypeError("Stringified UUID is invalid");return r}},425:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateV1State=void 0;const n=r(291),i=r(11),s={};function a(e,t,r){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=r.slice(10,16),e.node[0]|=1,e.clockseq=16383&(r[8]<<8|r[9])),e.msecs=t,e}function o(e,t,r,n,i,s,a=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(s){if(a<0||a+16>s.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`)}else s=new Uint8Array(16),a=0;t??=Date.now(),r??=0,n??=16383&(e[8]<<8|e[9]),i??=e.slice(10,16);const o=(1e4*(268435455&(t+=122192928e5))+r)%4294967296;s[a++]=o>>>24&255,s[a++]=o>>>16&255,s[a++]=o>>>8&255,s[a++]=255&o;const c=t/4294967296*1e4&268435455;s[a++]=c>>>8&255,s[a++]=255&c,s[a++]=c>>>24&15|16,s[a++]=c>>>16&255,s[a++]=n>>>8|128,s[a++]=255&n;for(let e=0;e<6;++e)s[a++]=i[e];return s}t.updateV1State=a,t.default=function(e,t,r){let c;const u=e?._v6??!1;if(e){const t=Object.keys(e);1===t.length&&"_v6"===t[0]&&(e=void 0)}if(e)c=o(e.random??e.rng?.()??(0,n.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,r);else{const e=Date.now(),i=(0,n.default)();a(s,e,i),c=o(i,s.msecs,s.nsecs,u?void 0:s.clockseq,u?void 0:s.node,t,r)}return t?c:(0,i.unsafeStringify)(c)}},568:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(797),i=r(11);t.default=function(e){const t=(r="string"==typeof e?(0,n.default)(e):e,Uint8Array.of((15&r[6])<<4|r[7]>>4&15,(15&r[7])<<4|(240&r[4])>>4,(15&r[4])<<4|(240&r[5])>>4,(15&r[5])<<4|(240&r[0])>>4,(15&r[0])<<4|(240&r[1])>>4,(15&r[1])<<4|(240&r[2])>>4,96|15&r[2],r[3],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]));var r;return"string"==typeof e?(0,i.unsafeStringify)(t):t}},591:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const n=r(338),i=r(988);var s=r(988);function a(e,t,r,s){return(0,i.default)(48,n.default,e,t,r,s)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return s.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return s.URL}}),a.DNS=i.DNS,a.URL=i.URL,t.default=a},988:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=t.stringToBytes=void 0;const n=r(797),i=r(11);function s(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}t.stringToBytes=s,t.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",t.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",t.default=function(e,t,r,a,o,c){const u="string"==typeof r?s(r):r,h="string"==typeof a?(0,n.default)(a):a;if("string"==typeof a&&(a=(0,n.default)(a)),16!==a?.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+u.length);if(l.set(h),l.set(u,h.length),l=t(l),l[6]=15&l[6]|e,l[8]=63&l[8]|128,o){c=c||0;for(let e=0;e<16;++e)o[c+e]=l[e];return o}return(0,i.unsafeStringify)(l)}},286:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(779),i=r(291),s=r(11);t.default=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();const a=(e=e||{}).random??e.rng?.()??(0,i.default)();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=a[e];return t}return(0,s.unsafeStringify)(a)}},557:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const n=r(829),i=r(988);var s=r(988);function a(e,t,r,s){return(0,i.default)(80,n.default,e,t,r,s)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return s.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return s.URL}}),a.DNS=i.DNS,a.URL=i.URL,t.default=a},356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(11),i=r(425),s=r(568);t.default=function(e,t,r){e??={},r??=0;let a=(0,i.default)({...e,_v6:!0},new Uint8Array(16));if(a=(0,s.default)(a),t){for(let e=0;e<16;e++)t[r+e]=a[e];return t}return(0,n.unsafeStringify)(a)}},268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(797),i=r(11);t.default=function(e){const t=(r="string"==typeof e?(0,n.default)(e):e,Uint8Array.of((15&r[3])<<4|r[4]>>4&15,(15&r[4])<<4|(240&r[5])>>4,(15&r[5])<<4|15&r[6],r[7],(15&r[1])<<4|(240&r[2])>>4,(15&r[2])<<4|(240&r[3])>>4,16|(240&r[0])>>4,(15&r[0])<<4|(240&r[1])>>4,r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]));var r;return"string"==typeof e?(0,i.unsafeStringify)(t):t}},299:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateV7State=void 0;const n=r(291),i=r(11),s={};function a(e,t,r){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=r[6]<<23|r[7]<<16|r[8]<<8|r[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function o(e,t,r,n,i=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(n){if(i<0||i+16>n.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else n=new Uint8Array(16),i=0;return t??=Date.now(),r??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],n[i++]=t/1099511627776&255,n[i++]=t/4294967296&255,n[i++]=t/16777216&255,n[i++]=t/65536&255,n[i++]=t/256&255,n[i++]=255&t,n[i++]=112|r>>>28&15,n[i++]=r>>>20&255,n[i++]=128|r>>>14&63,n[i++]=r>>>6&255,n[i++]=r<<2&255|3&e[10],n[i++]=e[11],n[i++]=e[12],n[i++]=e[13],n[i++]=e[14],n[i++]=e[15],n}t.updateV7State=a,t.default=function(e,t,r){let c;if(e)c=o(e.random??e.rng?.()??(0,n.default)(),e.msecs,e.seq,t,r);else{const e=Date.now(),i=(0,n.default)();a(s,e,i),c=o(i,s.msecs,s.seq,t,r)}return t?c:(0,i.unsafeStringify)(c)}},746:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(697);t.default=function(e){return"string"==typeof e&&n.default.test(e)}},770:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(746);t.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},604:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AEADEncryptedDataPacket:()=>Ea,CleartextMessage:()=>So,CompressedDataPacket:()=>la,LiteralDataPacket:()=>Xs,MarkerPacket:()=>Ka,Message:()=>mo,OnePassSignaturePacket:()=>oa,PacketList:()=>ua,PaddingPacket:()=>La,PrivateKey:()=>oo,PublicKey:()=>ao,PublicKeyEncryptedSessionKeyPacket:()=>ka,PublicKeyPacket:()=>Sa,PublicSubkeyPacket:()=>Pa,SecretKeyPacket:()=>Da,SecretSubkeyPacket:()=>Ta,Signature:()=>Oa,SignaturePacket:()=>ia,Subkey:()=>to,SymEncryptedIntegrityProtectedDataPacket:()=>wa,SymEncryptedSessionKeyPacket:()=>Ba,SymmetricallyEncryptedDataPacket:()=>Ca,TrustPacket:()=>_a,UnparseablePacket:()=>Hn,UserAttributePacket:()=>Ua,UserIDPacket:()=>Ra,armor:()=>re,config:()=>O,createCleartextMessage:()=>Co,createMessage:()=>vo,decrypt:()=>To,decryptKey:()=>Do,decryptSessionKeys:()=>Mo,encrypt:()=>Ro,encryptKey:()=>xo,encryptSessionKey:()=>Oo,enums:()=>Q,generateKey:()=>Ko,generateSessionKey:()=>Qo,readCleartextMessage:()=>Io,readKey:()=>lo,readKeys:()=>yo,readMessage:()=>ko,readPrivateKey:()=>fo,readPrivateKeys:()=>po,readSignature:()=>Ma,reformatKey:()=>Po,revokeKey:()=>Uo,sign:()=>_o,unarmor:()=>te,verify:()=>Lo});const n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}const s=Symbol("doneWritingPromise"),a=Symbol("doneWritingResolve"),o=Symbol("doneWritingReject"),c=Symbol("readingIndex");class u extends Array{constructor(){super(),Object.setPrototypeOf(this,u.prototype),this[s]=new Promise(((e,t)=>{this[a]=e,this[o]=t})),this[s].catch((()=>{}))}}function h(e){return e&&e.getReader&&Array.isArray(e)}function l(e){if(!h(e)){const t=e.getWriter(),r=t.releaseLock;return t.releaseLock=()=>{t.closed.catch((function(){})),r.call(t)},t}this.stream=e}function f(e){if(h(e))return"array";if(n.ReadableStream&&n.ReadableStream.prototype.isPrototypeOf(e))return"web";if(e&&!(n.ReadableStream&&e instanceof n.ReadableStream)&&"function"==typeof e._read&&"object"==typeof e._readableState)throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!e||!e.getReader)&&"web-like"}function y(e){return Uint8Array.prototype.isPrototypeOf(e)}function d(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++){if(!y(e[r]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=e[r].length}const r=new Uint8Array(t);let n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}u.prototype.getReader=function(){return void 0===this[c]&&(this[c]=0),{read:async()=>(await this[s],this[c]===this.length?{value:void 0,done:!0}:{value:this[this[c]++],done:!1})}},u.prototype.readToEnd=async function(e){await this[s];const t=e(this.slice(this[c]));return this.length=0,t},u.prototype.clone=function(){const e=new u;return e[s]=this[s].then((()=>{e.push(...this)})),e},l.prototype.write=async function(e){this.stream.push(e)},l.prototype.close=async function(){this.stream[a]()},l.prototype.abort=async function(e){return this.stream[o](e),e},l.prototype.releaseLock=function(){},"object"==typeof n.process&&n.process.versions;const p=new WeakSet,g=Symbol("externalBuffer");function A(e){if(this.stream=e,e[g]&&(this[g]=e[g].slice()),h(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(f(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{t.closed.catch((function(){})),t.releaseLock()},void(this._cancel=t.cancel.bind(t))}let t=!1;this._read=async()=>t||p.has(e)?{value:void 0,done:!0}:(t=!0,{value:e,done:!1}),this._releaseLock=()=>{if(t)try{p.add(e)}catch(e){}}}function w(e){return f(e)?e:new ReadableStream({start(t){t.enqueue(e),t.close()}})}function m(e){if(f(e))return e;const t=new u;return(async()=>{const r=_(t);await r.write(e),await r.close()})(),t}function b(e){return e.some((e=>f(e)&&!h(e)))?function(e){e=e.map(w);const t=v((async function(e){await Promise.all(n.map((t=>x(t,e))))}));let r=Promise.resolve();const n=e.map(((n,i)=>S(n,((n,s)=>(r=r.then((()=>E(n,t.writable,{preventClose:i!==e.length-1}))),r)))));return t.readable}(e):e.some((e=>h(e)))?function(e){const t=new u;let r=Promise.resolve();return e.forEach(((n,i)=>(r=r.then((()=>E(n,t,{preventClose:i!==e.length-1}))),r))),t}(e):"string"==typeof e[0]?e.join(""):d(e)}async function E(e,t,{preventClose:r=!1,preventAbort:n=!1,preventCancel:i=!1}={}){if(f(e)&&!h(e)){e=w(e);try{if(e[g]){const r=_(t);for(let t=0;t<e[g].length;t++)await r.ready,await r.write(e[g][t]);r.releaseLock()}await e.pipeTo(t,{preventClose:r,preventAbort:n,preventCancel:i})}catch(e){}return}const s=T(e=m(e)),a=_(t);try{for(;;){await a.ready;const{done:e,value:t}=await s.read();if(e){r||await a.close();break}await a.write(t)}}catch(e){n||await a.abort(e)}finally{s.releaseLock(),a.releaseLock()}}function k(e,t){const r=new TransformStream(t);return E(e,r.writable),r.readable}function v(e){let t,r,n,i=!1,s=!1;return{readable:new ReadableStream({start(e){n=e},pull(){t?t():i=!0},async cancel(t){s=!0,e&&await e(t),r&&r(t)}},{highWaterMark:0}),writable:new WritableStream({write:async function(e){if(s)throw Error("Stream is cancelled");n.enqueue(e),i?i=!1:(await new Promise(((e,n)=>{t=e,r=n})),t=null,r=null)},close:n.close.bind(n),abort:n.error.bind(n)})}}function B(e,t=()=>{},r=()=>{}){if(h(e)){const n=new u;return(async()=>{const i=_(n);try{const n=await D(e),s=t(n),a=r();let o;o=void 0!==s&&void 0!==a?b([s,a]):void 0!==s?s:a,await i.write(o),await i.close()}catch(e){await i.abort(e)}})(),n}if(f(e))return k(e,{async transform(e,r){try{const n=await t(e);void 0!==n&&r.enqueue(n)}catch(e){r.error(e)}},async flush(e){try{const t=await r();void 0!==t&&e.enqueue(t)}catch(t){e.error(t)}}});const n=t(e),i=r();return void 0!==n&&void 0!==i?b([n,i]):void 0!==n?n:i}function S(e,t){if(f(e)&&!h(e)){let r;const n=new TransformStream({start(e){r=e}}),i=E(e,n.writable),s=v((async function(e){r.error(e),await i,await new Promise(setTimeout)}));return t(n.readable,s.writable),s.readable}e=m(e);const r=new u;return t(e,r),r}function I(e,t){let r;const n=S(e,((e,i)=>{const s=T(e);s.remainder=()=>(s.releaseLock(),E(e,i),n),r=t(s)}));return r}function C(e){if(h(e))return e.clone();if(f(e)){const t=function(e){if(h(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(f(e)){const t=w(e).tee();return t[0][g]=t[1][g]=e[g],t}return[U(e),U(e)]}(e);return P(e,t[0]),t[1]}return U(e)}function K(e){return h(e)?C(e):f(e)?new ReadableStream({start(t){const r=S(e,(async(e,r)=>{const n=T(e),i=_(r);try{for(;;){await i.ready;const{done:r,value:s}=await n.read();if(r){try{t.close()}catch(e){}return void await i.close()}try{t.enqueue(s)}catch(e){}await i.write(s)}}catch(e){t.error(e),await i.abort(e)}}));P(e,r)}}):U(e)}function P(e,t){Object.entries(Object.getOwnPropertyDescriptors(e.constructor.prototype)).forEach((([r,n])=>{"constructor"!==r&&(n.value?n.value=n.value.bind(t):n.get=n.get.bind(t),Object.defineProperty(e,r,n))}))}function U(e,t=0,r=1/0){if(h(e))throw Error("Not implemented");if(f(e)){if(t>=0&&r>=0){let n=0;return k(e,{transform(e,i){n<r?(n+e.length>=t&&i.enqueue(U(e,Math.max(t-n,0),r-n)),n+=e.length):i.terminate()}})}if(t<0&&(r<0||r===1/0)){let n=[];return B(e,(e=>{e.length>=-t?n=[e]:n.push(e)}),(()=>U(b(n),t,r)))}if(0===t&&r<0){let n;return B(e,(e=>{const i=n?b([n,e]):e;if(i.length>=-r)return n=U(i,r),U(i,t,r);n=i}))}return console.warn(`stream.slice(input, ${t}, ${r}) not implemented efficiently.`),R((async()=>U(await D(e),t,r)))}return e[g]&&(e=b(e[g].concat([e]))),y(e)?e.subarray(t,r===1/0?e.length:r):e.slice(t,r)}async function D(e,t=b){return h(e)?e.readToEnd(t):f(e)?T(e).readToEnd(t):e}async function x(e,t){if(f(e)){if(e.cancel){const r=await e.cancel(t);return await new Promise(setTimeout),r}if(e.destroy)return e.destroy(t),await new Promise(setTimeout),t}}function R(e){const t=new u;return(async()=>{const r=_(t);try{await r.write(await e()),await r.close()}catch(e){await r.abort(e)}})(),t}function T(e){return new A(e)}function _(e){return new l(e)}A.prototype.read=async function(){return this[g]&&this[g].length?{done:!1,value:this[g].shift()}:this._read()},A.prototype.releaseLock=function(){this[g]&&(this.stream[g]=this[g]),this._releaseLock()},A.prototype.cancel=function(e){return this._cancel(e)},A.prototype.readLine=async function(){let e,t=[];for(;!e;){let{done:r,value:n}=await this.read();if(n+="",r)return t.length?b(t):void 0;const i=n.indexOf("\n")+1;i&&(e=b(t.concat(n.substr(0,i))),t=[]),i!==n.length&&t.push(n.substr(i))}return this.unshift(...t),e},A.prototype.readByte=async function(){const{done:e,value:t}=await this.read();if(e)return;const r=t[0];return this.unshift(U(t,1)),r},A.prototype.readBytes=async function(e){const t=[];let r=0;for(;;){const{done:n,value:i}=await this.read();if(n)return t.length?b(t):void 0;if(t.push(i),r+=i.length,r>=e){const r=b(t);return this.unshift(U(r,e)),U(r,0,e)}}},A.prototype.peekBytes=async function(e){const t=await this.readBytes(e);return this.unshift(t),t},A.prototype.unshift=function(...e){this[g]||(this[g]=[]),1===e.length&&y(e[0])&&this[g].length&&e[0].length&&this[g][0].byteOffset>=e[0].length?this[g][0]=new Uint8Array(this[g][0].buffer,this[g][0].byteOffset-e[0].length,this[g][0].byteLength+e[0].length):this[g].unshift(...e.filter((e=>e&&e.length)))},A.prototype.readToEnd=async function(e=b){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return e(t)};const L=Symbol("byValue");var Q={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(e,t){if("number"==typeof t&&(t=this.read(e,t)),void 0!==e[t])return e[t];throw Error("Invalid enum value.")},read:function(e,t){if(e[L]||(e[L]=[],Object.entries(e).forEach((([t,r])=>{e[L][r]=t}))),void 0!==e[L][t])return e[L][t];throw Error("Invalid enum value.")}},O={preferredHashAlgorithm:Q.hash.sha512,preferredSymmetricAlgorithm:Q.symmetric.aes256,preferredCompressionAlgorithm:Q.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:Q.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:Q.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([Q.symmetric.aes128,Q.symmetric.aes192,Q.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.0.1",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([Q.hash.md5,Q.hash.ripemd]),rejectMessageHashAlgorithms:new Set([Q.hash.md5,Q.hash.ripemd,Q.hash.sha1]),rejectPublicKeyAlgorithms:new Set([Q.publicKey.elgamal,Q.publicKey.dsa]),rejectCurves:new Set([Q.curve.secp256k1])};const M=(()=>{try{return!1}catch(e){}return!1})(),N={isString:function(e){return"string"==typeof e||e instanceof String},nodeRequire:()=>{},isArray:function(e){return e instanceof Array},isUint8Array:y,isStream:f,getNobleCurve:async(e,t)=>{if(!O.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await Promise.resolve().then((function(){return nl}));switch(e){case Q.publicKey.ecdh:case Q.publicKey.ecdsa:{const e=r.get(t);if(!e)throw Error("Unsupported curve");return e}case Q.publicKey.x448:return r.get("x448");case Q.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(e){let t=0;for(let r=0;r<e.length;r++)t+=256**r*e[e.length-1-r];return t},writeNumber:function(e,t){const r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e>>8*(t-n-1)&255;return r},readDate:function(e){const t=N.readNumber(e);return new Date(1e3*t)},writeDate:function(e){const t=Math.floor(e.getTime()/1e3);return N.writeNumber(t,4)},normalizeDate:function(e=Date.now()){return null===e||e===1/0?e:new Date(1e3*Math.floor(+e/1e3))},readMPI:function(e){const t=7+(e[0]<<8|e[1])>>>3;return N.readExactSubarray(e,2,2+t)},readExactSubarray:function(e,t,r){if(e.length<r-t)throw Error("Input array too short");return e.subarray(t,r)},leftPad(e,t){if(e.length>t)throw Error("Input array too long");const r=new Uint8Array(t),n=t-e.length;return r.set(e,n),r},uint8ArrayToMPI:function(e){const t=N.uint8ArrayBitLength(e);if(0===t)throw Error("Zero MPI");const r=e.subarray(e.length-Math.ceil(t/8)),n=new Uint8Array([(65280&t)>>8,255&t]);return N.concatUint8Array([n,r])},uint8ArrayBitLength:function(e){let t;for(t=0;t<e.length&&0===e[t];t++);if(t===e.length)return 0;const r=e.subarray(t);return 8*(r.length-1)+N.nbits(r[0])},hexToUint8Array:function(e){const t=new Uint8Array(e.length>>1);for(let r=0;r<e.length>>1;r++)t[r]=parseInt(e.substr(r<<1,2),16);return t},uint8ArrayToHex:function(e){const t="0123456789abcdef";let r="";return e.forEach((e=>{r+=t[e>>4]+t[15&e]})),r},stringToUint8Array:function(e){return B(e,(e=>{if(!N.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}))},uint8ArrayToString:function(e){const t=[],r=16384,n=(e=new Uint8Array(e)).length;for(let i=0;i<n;i+=r)t.push(String.fromCharCode.apply(String,e.subarray(i,i+r<n?i+r:n)));return t.join("")},encodeUTF8:function(e){const t=new TextEncoder("utf-8");function r(e,r=!1){return t.encode(e,{stream:!r})}return B(e,r,(()=>r("",!0)))},decodeUTF8:function(e){const t=new TextDecoder("utf-8");function r(e,r=!1){return t.decode(e,{stream:!r})}return B(e,r,(()=>r(new Uint8Array,!0)))},concat:b,concatUint8Array:d,equalsUint8Array:function(e,t){if(!N.isUint8Array(e)||!N.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},writeChecksum:function(e){let t=0;for(let r=0;r<e.length;r++)t=t+e[r]&65535;return N.writeNumber(t,2)},printDebug:function(e){M&&console.log("[OpenPGP.js debug]",e)},printDebugError:function(e){M&&console.error("[OpenPGP.js debug]",e)},nbits:function(e){let t=1,r=e>>>16;return 0!==r&&(e=r,t+=16),r=e>>8,0!==r&&(e=r,t+=8),r=e>>4,0!==r&&(e=r,t+=4),r=e>>2,0!==r&&(e=r,t+=2),r=e>>1,0!==r&&(e=r,t+=1),t},double:function(e){const t=new Uint8Array(e.length),r=e.length-1;for(let n=0;n<r;n++)t[n]=e[n]<<1^e[n+1]>>7;return t[r]=e[r]<<1^135*(e[0]>>7),t},shiftRight:function(e,t){if(t)for(let r=e.length-1;r>=0;r--)e[r]>>=t,r>0&&(e[r]|=e[r-1]<<8-t);return e},getWebCrypto:function(){const e=void 0!==n&&n.crypto&&n.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!e)throw Error("The WebCrypto API is not available");return e},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return"undefined"!=typeof navigator?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(e){return!!N.isString(e)&&/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(e)},canonicalizeEOL:function(e){let t=!1;return B(e,(e=>{let r;t&&(e=N.concatUint8Array([new Uint8Array([13]),e])),13===e[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;const n=[];for(let t=0;r=e.indexOf(10,t)+1,r;t=r)13!==e[r-2]&&n.push(r);if(!n.length)return e;const i=new Uint8Array(e.length+n.length);let s=0;for(let t=0;t<n.length;t++){const r=e.subarray(n[t-1]||0,n[t]);i.set(r,s),s+=r.length,i[s-1]=13,i[s]=10,s++}return i.set(e.subarray(n[n.length-1]||0),s),i}),(()=>t?new Uint8Array([13]):void 0))},nativeEOL:function(e){let t=!1;return B(e,(e=>{let r;13===(e=t&&10!==e[0]?N.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;let n=0;for(let t=0;t!==e.length;t=r){r=e.indexOf(13,t)+1,r||(r=e.length);const i=r-(10===e[r]?1:0);t&&e.copyWithin(n,t,i),n+=i-t}return e.subarray(0,n)}),(()=>t?new Uint8Array([13]):void 0))},removeTrailingSpaces:function(e){return e.split("\n").map((e=>{let t=e.length-1;for(;t>=0&&(" "===e[t]||"\t"===e[t]||"\r"===e[t]);t--);return e.substr(0,t+1)})).join("\n")},wrapError:function(e,t){if(!t)return Error(e);try{t.message=e+": "+t.message}catch(e){}return t},constructAllowedPackets:function(e){const t={};return e.forEach((e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e})),t},anyPromise:function(e){return new Promise((async(t,r)=>{let n;await Promise.all(e.map((async e=>{try{t(await e)}catch(e){n=e}}))),r(n)}))},selectUint8Array:function(e,t,r){const n=Math.max(t.length,r.length),i=new Uint8Array(n);let s=0;for(let n=0;n<i.length;n++)i[n]=t[n]&256-e|r[n]&255+e,s+=e&n<t.length|1-e&n<r.length;return i.subarray(0,s)},selectUint8:function(e,t,r){return t&256-e|r&255+e},isAES:function(e){return e===Q.symmetric.aes128||e===Q.symmetric.aes192||e===Q.symmetric.aes256}},F=N.getNodeBuffer();let H,z;function j(e){let t=new Uint8Array;return B(e,(e=>{t=N.concatUint8Array([t,e]);const r=[],n=Math.floor(t.length/45),i=45*n,s=H(t.subarray(0,i));for(let e=0;e<n;e++)r.push(s.substr(60*e,60)),r.push("\n");return t=t.subarray(i),r.join("")}),(()=>t.length?H(t)+"\n":""))}function G(e){let t="";return B(e,(e=>{t+=e;let r=0;const n=[" ","\t","\r","\n"];for(let e=0;e<n.length;e++){const i=n[e];for(let e=t.indexOf(i);-1!==e;e=t.indexOf(i,e+1))r++}let i=t.length;for(;i>0&&(i-r)%4!=0;i--)n.includes(t[i])&&r--;const s=z(t.substr(0,i));return t=t.substr(i),s}),(()=>z(t)))}function q(e){return G(e.replace(/-/g,"+").replace(/_/g,"/"))}function V(e,t){let r=j(e).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function J(e){const t=e.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?Q.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?Q.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?Q.armor.signed:/MESSAGE/.test(t[1])?Q.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?Q.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?Q.armor.privateKey:/SIGNATURE/.test(t[1])?Q.armor.signature:void 0}function W(e,t){let r="";return t.showVersion&&(r+="Version: "+t.versionString+"\n"),t.showComment&&(r+="Comment: "+t.commentString+"\n"),e&&(r+="Comment: "+e+"\n"),r+="\n",r}function $(e){const t=function(e){let t=13501623;return B(e,(e=>{const r=Z?Math.floor(e.length/4):0,n=new Uint32Array(e.buffer,e.byteOffset,r);for(let e=0;e<r;e++)t^=n[e],t=Y[0][t>>24&255]^Y[1][t>>16&255]^Y[2][t>>8&255]^Y[3][255&t];for(let n=4*r;n<e.length;n++)t=t>>8^Y[0][255&t^e[n]]}),(()=>new Uint8Array([t,t>>8,t>>16])))}(e);return j(t)}F?(H=e=>F.from(e).toString("base64"),z=e=>{const t=F.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(H=e=>btoa(N.uint8ArrayToString(e)),z=e=>N.stringToUint8Array(atob(e)));const Y=[Array(255),Array(255),Array(255),Array(255)];for(let e=0;e<=255;e++){let t=e<<16;for(let e=0;e<8;e++)t=t<<1^(8388608&t?8801531:0);Y[0][e]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let e=0;e<=255;e++)Y[1][e]=Y[0][e]>>8^Y[0][255&Y[0][e]];for(let e=0;e<=255;e++)Y[2][e]=Y[1][e]>>8^Y[0][255&Y[1][e]];for(let e=0;e<=255;e++)Y[3][e]=Y[2][e]>>8^Y[0][255&Y[2][e]];const Z=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,255,!0),255===new Int16Array(e)[0]}();function X(e){for(let t=0;t<e.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(e[t])||N.printDebugError(Error("Improperly formatted armor header: "+e[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(e[t])||N.printDebugError(Error("Unknown header: "+e[t]))}function ee(e){let t=e;const r=e.lastIndexOf("=");return r>=0&&r!==e.length-1&&(t=e.slice(0,r)),t}function te(e){return new Promise((async(t,r)=>{try{const n=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,h=[];const l=G(S(e,(async(e,f)=>{const y=T(e);try{for(;;){let e=await y.readLine();if(void 0===e)throw Error("Misformed armored text");if(e=N.removeTrailingSpaces(e.replace(/[\r\n]/g,"")),s)if(o)c||s!==Q.armor.signed||(n.test(e)?(h=h.join("\r\n"),c=!0,X(u),u=[],o=!1):h.push(e.replace(/^- /,"")));else if(n.test(e)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(e)){if(X(u),o=!0,c||s!==Q.armor.signed){t({text:h,data:l,headers:a,type:s});break}}else u.push(e);else n.test(e)&&(s=J(e))}}catch(e){return void r(e)}const d=_(f);try{for(;;){await d.ready;const{done:e,value:t}=await y.read();if(e)throw Error("Misformed armored text");const r=t+"";if(-1!==r.indexOf("=")||-1!==r.indexOf("-")){let e=await y.readToEnd();e.length||(e=""),e=r+e,e=N.removeTrailingSpaces(e.replace(/\r/g,""));const t=e.split(n);if(1===t.length)throw Error("Misformed armored text");const i=ee(t[0].slice(0,-1));await d.write(i);break}await d.write(r)}await d.ready,await d.close()}catch(e){await d.abort(e)}})))}catch(e){r(e)}})).then((async e=>(h(e.data)&&(e.data=await D(e.data)),e)))}function re(e,t,r,n,i,s=!1,a=O){let o,c;e===Q.armor.signed&&(o=t.text,c=t.hash,t=t.data);const u=s&&K(t),h=[];switch(e){case Q.armor.multipartSection:h.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+n+"-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP MESSAGE, PART "+r+"/"+n+"-----\n");break;case Q.armor.multipartLast:h.push("-----BEGIN PGP MESSAGE, PART "+r+"-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP MESSAGE, PART "+r+"-----\n");break;case Q.armor.signed:h.push("-----BEGIN PGP SIGNED MESSAGE-----\n"),h.push(c?`Hash: ${c}\n\n`:"\n"),h.push(o.replace(/^-/gm,"- -")),h.push("\n-----BEGIN PGP SIGNATURE-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP SIGNATURE-----\n");break;case Q.armor.message:h.push("-----BEGIN PGP MESSAGE-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP MESSAGE-----\n");break;case Q.armor.publicKey:h.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case Q.armor.privateKey:h.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case Q.armor.signature:h.push("-----BEGIN PGP SIGNATURE-----\n"),h.push(W(i,a)),h.push(j(t)),u&&h.push("=",$(u)),h.push("-----END PGP SIGNATURE-----\n")}return N.concat(h)}async function ne(e){switch(e){case Q.symmetric.aes128:case Q.symmetric.aes192:case Q.symmetric.aes256:throw Error("Not a legacy cipher");case Q.symmetric.cast5:case Q.symmetric.blowfish:case Q.symmetric.twofish:case Q.symmetric.tripledes:{const{legacyCiphers:t}=await Promise.resolve().then((function(){return wl})),r=t.get(e);if(!r)throw Error("Unsupported cipher algorithm");return r}default:throw Error("Unsupported cipher algorithm")}}function ie(e){switch(e){case Q.symmetric.aes128:case Q.symmetric.aes192:case Q.symmetric.aes256:case Q.symmetric.twofish:return 16;case Q.symmetric.blowfish:case Q.symmetric.cast5:case Q.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function se(e){switch(e){case Q.symmetric.aes128:case Q.symmetric.blowfish:case Q.symmetric.cast5:return 16;case Q.symmetric.aes192:case Q.symmetric.tripledes:return 24;case Q.symmetric.aes256:case Q.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function ae(e){return{keySize:se(e),blockSize:ie(e)}}var oe=Object.freeze({__proto__:null,getCipherParams:ae,getLegacyCipher:ne});function ce(e,t){let r=e[0],n=e[1],i=e[2],s=e[3];r=he(r,n,i,s,t[0],7,-680876936),s=he(s,r,n,i,t[1],12,-389564586),i=he(i,s,r,n,t[2],17,606105819),n=he(n,i,s,r,t[3],22,-1044525330),r=he(r,n,i,s,t[4],7,-176418897),s=he(s,r,n,i,t[5],12,1200080426),i=he(i,s,r,n,t[6],17,-1473231341),n=he(n,i,s,r,t[7],22,-45705983),r=he(r,n,i,s,t[8],7,1770035416),s=he(s,r,n,i,t[9],12,-1958414417),i=he(i,s,r,n,t[10],17,-42063),n=he(n,i,s,r,t[11],22,-1990404162),r=he(r,n,i,s,t[12],7,1804603682),s=he(s,r,n,i,t[13],12,-40341101),i=he(i,s,r,n,t[14],17,-1502002290),n=he(n,i,s,r,t[15],22,1236535329),r=le(r,n,i,s,t[1],5,-165796510),s=le(s,r,n,i,t[6],9,-1069501632),i=le(i,s,r,n,t[11],14,643717713),n=le(n,i,s,r,t[0],20,-373897302),r=le(r,n,i,s,t[5],5,-701558691),s=le(s,r,n,i,t[10],9,38016083),i=le(i,s,r,n,t[15],14,-660478335),n=le(n,i,s,r,t[4],20,-405537848),r=le(r,n,i,s,t[9],5,568446438),s=le(s,r,n,i,t[14],9,-1019803690),i=le(i,s,r,n,t[3],14,-187363961),n=le(n,i,s,r,t[8],20,1163531501),r=le(r,n,i,s,t[13],5,-1444681467),s=le(s,r,n,i,t[2],9,-51403784),i=le(i,s,r,n,t[7],14,1735328473),n=le(n,i,s,r,t[12],20,-1926607734),r=fe(r,n,i,s,t[5],4,-378558),s=fe(s,r,n,i,t[8],11,-2022574463),i=fe(i,s,r,n,t[11],16,1839030562),n=fe(n,i,s,r,t[14],23,-35309556),r=fe(r,n,i,s,t[1],4,-1530992060),s=fe(s,r,n,i,t[4],11,1272893353),i=fe(i,s,r,n,t[7],16,-155497632),n=fe(n,i,s,r,t[10],23,-1094730640),r=fe(r,n,i,s,t[13],4,681279174),s=fe(s,r,n,i,t[0],11,-358537222),i=fe(i,s,r,n,t[3],16,-722521979),n=fe(n,i,s,r,t[6],23,76029189),r=fe(r,n,i,s,t[9],4,-640364487),s=fe(s,r,n,i,t[12],11,-421815835),i=fe(i,s,r,n,t[15],16,530742520),n=fe(n,i,s,r,t[2],23,-995338651),r=ye(r,n,i,s,t[0],6,-198630844),s=ye(s,r,n,i,t[7],10,1126891415),i=ye(i,s,r,n,t[14],15,-1416354905),n=ye(n,i,s,r,t[5],21,-57434055),r=ye(r,n,i,s,t[12],6,1700485571),s=ye(s,r,n,i,t[3],10,-1894986606),i=ye(i,s,r,n,t[10],15,-1051523),n=ye(n,i,s,r,t[1],21,-2054922799),r=ye(r,n,i,s,t[8],6,1873313359),s=ye(s,r,n,i,t[15],10,-30611744),i=ye(i,s,r,n,t[6],15,-1560198380),n=ye(n,i,s,r,t[13],21,1309151649),r=ye(r,n,i,s,t[4],6,-145523070),s=ye(s,r,n,i,t[11],10,-1120210379),i=ye(i,s,r,n,t[2],15,718787259),n=ye(n,i,s,r,t[9],21,-343485551),e[0]=Ae(r,e[0]),e[1]=Ae(n,e[1]),e[2]=Ae(i,e[2]),e[3]=Ae(s,e[3])}function ue(e,t,r,n,i,s){return t=Ae(Ae(t,e),Ae(n,s)),Ae(t<<i|t>>>32-i,r)}function he(e,t,r,n,i,s,a){return ue(t&r|~t&n,e,t,i,s,a)}function le(e,t,r,n,i,s,a){return ue(t&n|r&~n,e,t,i,s,a)}function fe(e,t,r,n,i,s,a){return ue(t^r^n,e,t,i,s,a)}function ye(e,t,r,n,i,s,a){return ue(r^(t|~n),e,t,i,s,a)}function de(e){const t=[];let r;for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}const pe="0123456789abcdef".split("");function ge(e){let t="",r=0;for(;r<4;r++)t+=pe[e>>8*r+4&15]+pe[e>>8*r&15];return t}function Ae(e,t){return e+t&4294967295}const we=N.getWebCrypto(),me=N.getNodeCrypto(),be=me&&me.getHashes();function Ee(e){if(me&&be.includes(e))return async function(t){const r=me.createHash(e);return B(t,(e=>{r.update(e)}),(()=>new Uint8Array(r.digest())))}}function ke(e,t){const r=async()=>{const{nobleHashes:t}=await Promise.resolve().then((function(){return Ql})),r=t.get(e);if(!r)throw Error("Unsupported hash");return r};return async function(e){if(h(e)&&(e=await D(e)),N.isStream(e)){const t=(await r()).create();return B(e,(e=>{t.update(e)}),(()=>t.digest()))}return we&&t?new Uint8Array(await we.digest(t,e)):(await r())(e)}}var ve={md5:Ee("md5")||async function(e){const t=function(e){const t=e.length,r=[1732584193,-271733879,-1732584194,271733878];let n;for(n=64;n<=e.length;n+=64)ce(r,de(e.substring(n-64,n)));e=e.substring(n-64);const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)i[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(ce(r,i),n=0;n<16;n++)i[n]=0;return i[14]=8*t,ce(r,i),r}(N.uint8ArrayToString(e));return N.hexToUint8Array(function(e){for(let t=0;t<e.length;t++)e[t]=ge(e[t]);return e.join("")}(t))},sha1:Ee("sha1")||ke("sha1","SHA-1"),sha224:Ee("sha224")||ke("sha224"),sha256:Ee("sha256")||ke("sha256","SHA-256"),sha384:Ee("sha384")||ke("sha384","SHA-384"),sha512:Ee("sha512")||ke("sha512","SHA-512"),ripemd:Ee("ripemd160")||ke("ripemd160"),sha3_256:Ee("sha3-256")||ke("sha3_256"),sha3_512:Ee("sha3-512")||ke("sha3_512"),digest:function(e,t){switch(e){case Q.hash.md5:return this.md5(t);case Q.hash.sha1:return this.sha1(t);case Q.hash.ripemd:return this.ripemd(t);case Q.hash.sha256:return this.sha256(t);case Q.hash.sha384:return this.sha384(t);case Q.hash.sha512:return this.sha512(t);case Q.hash.sha224:return this.sha224(t);case Q.hash.sha3_256:return this.sha3_256(t);case Q.hash.sha3_512:return this.sha3_512(t);default:throw Error("Unsupported hash function")}},getHashByteLength:function(e){switch(e){case Q.hash.md5:return 16;case Q.hash.sha1:case Q.hash.ripemd:return 20;case Q.hash.sha256:return 32;case Q.hash.sha384:return 48;case Q.hash.sha512:return 64;case Q.hash.sha224:return 28;case Q.hash.sha3_256:return 32;case Q.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}};function Be(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function Se(e,...t){if(!Be(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Ie(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function Ce(e,t){Se(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}const Ke=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),Pe=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ue=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw Error("Non little-endian hardware is not supported");function De(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Be(e))throw Error("Uint8Array expected, got "+typeof e);e=Le(e)}return e}function xe(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}const Re=(e,t)=>(Object.assign(t,e),t);function Te(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);e.setUint32(t+0,a,n),e.setUint32(t+4,o,n)}function _e(e){return e.byteOffset%4==0}function Le(e){return Uint8Array.from(e)}function Qe(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Oe=16,Me=new Uint8Array(16),Ne=Pe(Me),Fe=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class He{constructor(e,t){this.blockLen=Oe,this.outputLen=Oe,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,Se(e=De(e),16);const r=Ue(e);let n=r.getUint32(0,!1),i=r.getUint32(4,!1),s=r.getUint32(8,!1),a=r.getUint32(12,!1);const o=[];for(let e=0;e<128;e++)o.push({s0:Fe(n),s1:Fe(i),s2:Fe(s),s3:Fe(a)}),({s0:n,s1:i,s2:s,s3:a}={s3:(h=s)<<31|(l=a)>>>1,s2:(u=i)<<31|h>>>1,s1:(c=n)<<31|u>>>1,s0:c>>>1^225<<24&-(1&l)});var c,u,h,l;const f=(e=>e>65536?8:e>1024?4:2)(t||1024);if(![1,2,4,8].includes(f))throw Error(`ghash: wrong window size=${f}, should be 2, 4 or 8`);this.W=f;const y=128/f,d=this.windowSize=2**f,p=[];for(let e=0;e<y;e++)for(let t=0;t<d;t++){let r=0,n=0,i=0,s=0;for(let a=0;a<f;a++){if(!(t>>>f-a-1&1))continue;const{s0:c,s1:u,s2:h,s3:l}=o[f*e+a];r^=c,n^=u,i^=h,s^=l}p.push({s0:r,s1:n,s2:i,s3:s})}this.t=p}_updateBlock(e,t,r,n){e^=this.s0,t^=this.s1,r^=this.s2,n^=this.s3;const{W:i,t:s,windowSize:a}=this;let o=0,c=0,u=0,h=0;const l=(1<<i)-1;let f=0;for(const y of[e,t,r,n])for(let e=0;e<4;e++){const t=y>>>8*e&255;for(let e=8/i-1;e>=0;e--){const r=t>>>i*e&l,{s0:n,s1:y,s2:d,s3:p}=s[f*a+r];o^=n,c^=y,u^=d,h^=p,f+=1}}this.s0=o,this.s1=c,this.s2=u,this.s3=h}update(e){e=De(e),Ie(this);const t=Pe(e),r=Math.floor(e.length/Oe),n=e.length%Oe;for(let e=0;e<r;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return n&&(Me.set(e.subarray(r*Oe)),this._updateBlock(Ne[0],Ne[1],Ne[2],Ne[3]),Qe(Ne)),this}destroy(){const{t:e}=this;for(const t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){Ie(this),Ce(e,this),this.finished=!0;const{s0:t,s1:r,s2:n,s3:i}=this,s=Pe(e);return s[0]=t,s[1]=r,s[2]=n,s[3]=i,e}digest(){const e=new Uint8Array(Oe);return this.digestInto(e),this.destroy(),e}}class ze extends He{constructor(e,t){const r=function(e){e.reverse();const t=1&e[15];let r=0;for(let t=0;t<e.length;t++){const n=e[t];e[t]=n>>>1|r,r=(1&n)<<7}return e[0]^=225&-t,e}(Le(e=De(e)));super(r,t),Qe(r)}update(e){e=De(e),Ie(this);const t=Pe(e),r=e.length%Oe,n=Math.floor(e.length/Oe);for(let e=0;e<n;e++)this._updateBlock(Fe(t[4*e+3]),Fe(t[4*e+2]),Fe(t[4*e+1]),Fe(t[4*e+0]));return r&&(Me.set(e.subarray(n*Oe)),this._updateBlock(Fe(Ne[3]),Fe(Ne[2]),Fe(Ne[1]),Fe(Ne[0])),Qe(Ne)),this}digestInto(e){Ie(this),Ce(e,this),this.finished=!0;const{s0:t,s1:r,s2:n,s3:i}=this,s=Pe(e);return s[0]=t,s[1]=r,s[2]=n,s[3]=i,e.reverse()}}function je(e){const t=(t,r)=>e(r,t.length).update(De(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}const Ge=je(((e,t)=>new He(e,t)));je(((e,t)=>new ze(e,t)));const qe=16,Ve=new Uint8Array(qe);function Je(e){return e<<1^283&-(e>>7)}function We(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=Je(e);return r}const $e=(()=>{const e=new Uint8Array(256);for(let t=0,r=1;t<256;t++,r^=Je(r))e[t]=r;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=255&(n^n>>4^n>>5^n>>6^n>>7^99)}return Qe(e),t})(),Ye=$e.map(((e,t)=>$e.indexOf(t))),Ze=e=>e<<24|e>>>8,Xe=e=>e<<8|e>>>24,et=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function tt(e,t){if(256!==e.length)throw Error("Wrong sbox length");const r=new Uint32Array(256).map(((r,n)=>t(e[n]))),n=r.map(Xe),i=n.map(Xe),s=i.map(Xe),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let t=0;t<256;t++)for(let u=0;u<256;u++){const h=256*t+u;a[h]=r[t]^n[u],o[h]=i[t]^s[u],c[h]=e[t]<<8|e[u]}return{sbox:e,sbox2:c,T0:r,T1:n,T2:i,T3:s,T01:a,T23:o}}const rt=tt($e,(e=>We(e,3)<<24|e<<16|e<<8|We(e,2))),nt=tt(Ye,(e=>We(e,11)<<24|We(e,13)<<16|We(e,9)<<8|We(e,14))),it=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=Je(r))e[t]=r;return e})();function st(e){Se(e);const t=e.length;if(![16,24,32].includes(t))throw Error("aes: wrong key size: should be 16, 24 or 32, got: "+t);const{sbox2:r}=rt,n=[];_e(e)||n.push(e=Le(e));const i=Pe(e),s=i.length,a=e=>ct(r,e,e,e,e),o=new Uint32Array(t+28);o.set(i);for(let e=s;e<o.length;e++){let t=o[e-1];e%s==0?t=a(Ze(t))^it[e/s-1]:s>6&&e%s==4&&(t=a(t)),o[e]=o[e-s]^t}return Qe(...n),o}function at(e){const t=st(e),r=t.slice(),n=t.length,{sbox2:i}=rt,{T0:s,T1:a,T2:o,T3:c}=nt;for(let e=0;e<n;e+=4)for(let i=0;i<4;i++)r[e+i]=t[n-e-4+i];Qe(t);for(let e=4;e<n-4;e++){const t=r[e],n=ct(i,t,t,t,t);r[e]=s[255&n]^a[n>>>8&255]^o[n>>>16&255]^c[n>>>24]}return r}function ot(e,t,r,n,i,s){return e[r<<8&65280|n>>>8&255]^t[i>>>8&65280|s>>>24&255]}function ct(e,t,r,n,i){return e[255&t|65280&r]|e[n>>>16&255|i>>>16&65280]<<16}function ut(e,t,r,n,i){const{sbox2:s,T01:a,T23:o}=rt;let c=0;t^=e[c++],r^=e[c++],n^=e[c++],i^=e[c++];const u=e.length/4-2;for(let s=0;s<u;s++){const s=e[c++]^ot(a,o,t,r,n,i),u=e[c++]^ot(a,o,r,n,i,t),h=e[c++]^ot(a,o,n,i,t,r),l=e[c++]^ot(a,o,i,t,r,n);t=s,r=u,n=h,i=l}return{s0:e[c++]^ct(s,t,r,n,i),s1:e[c++]^ct(s,r,n,i,t),s2:e[c++]^ct(s,n,i,t,r),s3:e[c++]^ct(s,i,t,r,n)}}function ht(e,t,r,n,i){const{sbox2:s,T01:a,T23:o}=nt;let c=0;t^=e[c++],r^=e[c++],n^=e[c++],i^=e[c++];const u=e.length/4-2;for(let s=0;s<u;s++){const s=e[c++]^ot(a,o,t,i,n,r),u=e[c++]^ot(a,o,r,t,i,n),h=e[c++]^ot(a,o,n,r,t,i),l=e[c++]^ot(a,o,i,n,r,t);t=s,r=u,n=h,i=l}return{s0:e[c++]^ct(s,t,i,n,r),s1:e[c++]^ct(s,r,t,i,n),s2:e[c++]^ct(s,n,r,t,i),s3:e[c++]^ct(s,i,n,r,t)}}function lt(e,t){if(void 0===t)return new Uint8Array(e);if(Se(t),t.length<e)throw Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);if(!_e(t))throw Error("unaligned dst");return t}function ft(e,t,r,n){Se(t,qe),Se(r);const i=r.length;n=lt(i,n);const s=t,a=Pe(s);let{s0:o,s1:c,s2:u,s3:h}=ut(e,a[0],a[1],a[2],a[3]);const l=Pe(r),f=Pe(n);for(let t=0;t+4<=l.length;t+=4){f[t+0]=l[t+0]^o,f[t+1]=l[t+1]^c,f[t+2]=l[t+2]^u,f[t+3]=l[t+3]^h;let r=1;for(let e=s.length-1;e>=0;e--)r=r+(255&s[e])|0,s[e]=255&r,r>>>=8;({s0:o,s1:c,s2:u,s3:h}=ut(e,a[0],a[1],a[2],a[3]))}const y=qe*Math.floor(l.length/4);if(y<i){const e=new Uint32Array([o,c,u,h]),t=Ke(e);for(let e=y,s=0;e<i;e++,s++)n[e]=r[e]^t[s];Qe(e)}return n}function yt(e,t,r,n,i){Se(r,qe),Se(n),i=lt(n.length,i);const s=r,a=Pe(s),o=Ue(s),c=Pe(n),u=Pe(i),h=t?0:12,l=n.length;let f=o.getUint32(h,t),{s0:y,s1:d,s2:p,s3:g}=ut(e,a[0],a[1],a[2],a[3]);for(let r=0;r+4<=c.length;r+=4)u[r+0]=c[r+0]^y,u[r+1]=c[r+1]^d,u[r+2]=c[r+2]^p,u[r+3]=c[r+3]^g,f=f+1>>>0,o.setUint32(h,f,t),({s0:y,s1:d,s2:p,s3:g}=ut(e,a[0],a[1],a[2],a[3]));const A=qe*Math.floor(c.length/4);if(A<l){const e=new Uint32Array([y,d,p,g]),t=Ke(e);for(let e=A,r=0;e<l;e++,r++)i[e]=n[e]^t[r];Qe(e)}return i}const dt=Re({blockSize:16,nonceLength:16},(function(e,t){function r(r,n){if(Se(r),void 0!==n&&(Se(n),!_e(n)))throw Error("unaligned destination");const i=st(e),s=Le(t),a=[i,s];_e(r)||a.push(r=Le(r));const o=ft(i,s,r,n);return Qe(...a),o}return Se(e),Se(t,qe),{encrypt:(e,t)=>r(e,t),decrypt:(e,t)=>r(e,t)}})),pt=Re({blockSize:16,nonceLength:16},(function(e,t,r={}){Se(e),Se(t,16);const n=!r.disablePadding;return{encrypt(r,i){const s=st(e),{b:a,o,out:c}=function(e,t,r){Se(e);let n=e.length;const i=n%qe;if(!t&&0!==i)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");_e(e)||(e=Le(e));const s=Pe(e);if(t){let e=qe-i;e||(e=qe),n+=e}const a=lt(n,r);return{b:s,o:Pe(a),out:a}}(r,n,i);let u=t;const h=[s];_e(u)||h.push(u=Le(u));const l=Pe(u);let f=l[0],y=l[1],d=l[2],p=l[3],g=0;for(;g+4<=a.length;)f^=a[g+0],y^=a[g+1],d^=a[g+2],p^=a[g+3],({s0:f,s1:y,s2:d,s3:p}=ut(s,f,y,d,p)),o[g++]=f,o[g++]=y,o[g++]=d,o[g++]=p;if(n){const e=function(e){const t=new Uint8Array(16),r=Pe(t);t.set(e);const n=qe-e.length;for(let e=qe-n;e<qe;e++)t[e]=n;return r}(r.subarray(4*g));f^=e[0],y^=e[1],d^=e[2],p^=e[3],({s0:f,s1:y,s2:d,s3:p}=ut(s,f,y,d,p)),o[g++]=f,o[g++]=y,o[g++]=d,o[g++]=p}return Qe(...h),c},decrypt(r,i){!function(e){if(Se(e),e.length%qe!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}(r);const s=at(e);let a=t;const o=[s];_e(a)||o.push(a=Le(a));const c=Pe(a),u=lt(r.length,i);_e(r)||o.push(r=Le(r));const h=Pe(r),l=Pe(u);let f=c[0],y=c[1],d=c[2],p=c[3];for(let e=0;e+4<=h.length;){const t=f,r=y,n=d,i=p;f=h[e+0],y=h[e+1],d=h[e+2],p=h[e+3];const{s0:a,s1:o,s2:c,s3:u}=ht(s,f,y,d,p);l[e++]=a^t,l[e++]=o^r,l[e++]=c^n,l[e++]=u^i}return Qe(...o),function(e,t){if(!t)return e;const r=e.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");const n=e[r-1];if(n<=0||n>16)throw Error("aes/pcks5: wrong padding");const i=e.subarray(0,-n);for(let t=0;t<n;t++)if(e[r-t-1]!==n)throw Error("aes/pcks5: wrong padding");return i}(u,n)}}})),gt=Re({blockSize:16,nonceLength:16},(function(e,t){function r(r,n,i){Se(r);const s=r.length;i=lt(s,i);const a=st(e);let o=t;const c=[a];_e(o)||c.push(o=Le(o)),_e(r)||c.push(r=Le(r));const u=Pe(r),h=Pe(i),l=n?h:u,f=Pe(o);let y=f[0],d=f[1],p=f[2],g=f[3];for(let e=0;e+4<=u.length;){const{s0:t,s1:r,s2:n,s3:i}=ut(a,y,d,p,g);h[e+0]=u[e+0]^t,h[e+1]=u[e+1]^r,h[e+2]=u[e+2]^n,h[e+3]=u[e+3]^i,y=l[e++],d=l[e++],p=l[e++],g=l[e++]}const A=qe*Math.floor(u.length/4);if(A<s){({s0:y,s1:d,s2:p,s3:g}=ut(a,y,d,p,g));const e=Ke(new Uint32Array([y,d,p,g]));for(let t=A,n=0;t<s;t++,n++)i[t]=r[t]^e[n];Qe(e)}return Qe(...c),i}return Se(e),Se(t,16),{encrypt:(e,t)=>r(e,!0,t),decrypt:(e,t)=>r(e,!1,t)}})),At=Re({blockSize:16,nonceLength:12,tagLength:16},(function(e,t,r){if(Se(e),Se(t),void 0!==r&&Se(r),t.length<8)throw Error("aes/gcm: invalid nonce length");function n(e,t,n){const i=function(e,t,r,n,i){const s=null==i?0:i.length,a=e.create(r,n.length+s);i&&a.update(i),a.update(n);const o=new Uint8Array(16),c=Ue(o);i&&Te(c,0,BigInt(8*s),t),Te(c,8,BigInt(8*n.length),t),a.update(o);const u=a.digest();return Qe(o),u}(Ge,!1,e,n,r);for(let e=0;e<t.length;e++)i[e]^=t[e];return i}function i(){const r=st(e),n=Ve.slice(),i=Ve.slice();if(yt(r,!1,i,i,n),12===t.length)i.set(t);else{const e=Ve.slice();Te(Ue(e),8,BigInt(8*t.length),!1);const r=Ge.create(n).update(t).update(e);r.digestInto(i),r.destroy()}return{xk:r,authKey:n,counter:i,tagMask:yt(r,!1,i,Ve)}}return{encrypt(e){Se(e);const{xk:t,authKey:r,counter:s,tagMask:a}=i(),o=new Uint8Array(e.length+16),c=[t,r,s,a];_e(e)||c.push(e=Le(e)),yt(t,!1,s,e,o);const u=n(r,a,o.subarray(0,o.length-16));return c.push(u),o.set(u,e.length),Qe(...c),o},decrypt(e){if(Se(e),e.length<16)throw Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:t,authKey:r,counter:s,tagMask:a}=i(),o=[t,r,a,s];_e(e)||o.push(e=Le(e));const c=e.subarray(0,-16),u=e.subarray(-16),h=n(r,a,c);if(o.push(h),!xe(h,u))throw Error("aes/gcm: invalid ghash tag");const l=yt(t,!1,s,c);return Qe(...o),l}}}));function wt(e){return null!=e&&"object"==typeof e&&(e instanceof Uint32Array||"Uint32Array"===e.constructor.name)}function mt(e,t){if(Se(t,16),!wt(e))throw Error("_encryptBlock accepts result of expandKeyLE");const r=Pe(t);let{s0:n,s1:i,s2:s,s3:a}=ut(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,t}function bt(e,t){if(Se(t,16),!wt(e))throw Error("_decryptBlock accepts result of expandKeyLE");const r=Pe(t);let{s0:n,s1:i,s2:s,s3:a}=ht(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,t}const Et={encrypt(e,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const r=st(e);if(16===t.length)mt(r,t);else{const e=Pe(t);let n=e[0],i=e[1];for(let t=0,s=1;t<6;t++)for(let t=2;t<e.length;t+=2,s++){const{s0:a,s1:o,s2:c,s3:u}=ut(r,n,i,e[t],e[t+1]);n=a,i=o^et(s),e[t]=c,e[t+1]=u}e[0]=n,e[1]=i}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=at(e),n=t.length/8-1;if(1===n)bt(r,t);else{const e=Pe(t);let i=e[0],s=e[1];for(let t=0,a=6*n;t<6;t++)for(let t=2*n;t>=1;t-=2,a--){s^=et(a);const{s0:n,s1:o,s2:c,s3:u}=ht(r,i,s,e[t],e[t+1]);i=n,s=o,e[t]=c,e[t+1]=u}e[0]=i,e[1]=s}r.fill(0)}},kt=new Uint8Array(8).fill(166),vt=Re({blockSize:8},(e=>({encrypt(t){if(Se(t),!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(8===t.length)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];Se(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(kt,t);return Et.encrypt(e,r),r},decrypt(t){if(Se(t),t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const r=Le(t);if(Et.decrypt(e,r),!xe(r.subarray(0,8),kt))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}}))),Bt={expandKeyLE:st,expandKeyDecLE:at,encrypt:ut,decrypt:ht,encryptBlock:mt,decryptBlock:bt,ctrCounter:ft,ctr32:yt},St=N.getWebCrypto(),It=N.getNodeCrypto(),Ct=It?It.getCiphers():[],Kt={idea:Ct.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Ct.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Ct.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Ct.includes("bf-cfb")?"bf-cfb":void 0,aes128:Ct.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Ct.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Ct.includes("aes-256-cfb")?"aes-256-cfb":void 0};class Pt{constructor(e,t,r){const{blockSize:n}=ae(e);this.key=t,this.prevBlock=r,this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:t}=ae(e);return St.importKey("raw",new Uint8Array(t),"aes-cbc",!1,["encrypt"]).then((()=>!0),(()=>!1))}async _runCBC(e,t){const r="AES-CBC";this.keyRef=this.keyRef||await St.importKey("raw",this.key,r,!1,["encrypt"]);const n=await St.encrypt({name:r,iv:t||this.zeroBlock},this.keyRef,e);return new Uint8Array(n).subarray(0,e.length)}async encryptChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,n=N.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),i=N.concatUint8Array([this.prevBlock,n.subarray(0,n.length-this.blockSize)]),s=await this._runCBC(i);return Dt(s,n),this.prevBlock=s.slice(-this.blockSize),r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,s}let n;if(this.i+=r.length,this.i===this.nextBlock.length){const t=this.nextBlock;n=await this._runCBC(this.prevBlock),Dt(n,t),this.prevBlock=n.slice(),this.i=0;const i=e.subarray(r.length);this.nextBlock.set(i,this.i),this.i+=i.length}else n=new Uint8Array;return n}async finish(){let e;if(0===this.i)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const t=this.nextBlock,r=await this._runCBC(this.prevBlock);Dt(r,t),e=r.subarray(0,t.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const t=(await this._runCBC(N.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return Dt(t,e),this.clearSensitiveData(),t}}class Ut{constructor(e,t,r,n){this.forEncryption=e;const{blockSize:i}=ae(t);this.key=Bt.expandKeyLE(r),n.byteOffset%4!=0&&(n=n.slice()),this.prevBlock=xt(n),this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i}_runCFB(e){const t=xt(e),r=new Uint8Array(e.length),n=xt(r);for(let e=0;e+4<=n.length;e+=4){const{s0:r,s1:i,s2:s,s3:a}=Bt.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);n[e+0]=t[e+0]^r,n[e+1]=t[e+1]^i,n[e+2]=t[e+2]^s,n[e+3]=t[e+3]^a,this.prevBlock=(this.forEncryption?n:t).slice(e,e+4)}return r}async processChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,n=N.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),i=this._runCFB(n);return r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,i}let n;if(this.i+=r.length,this.i===this.nextBlock.length){n=this._runCFB(this.nextBlock),this.i=0;const t=e.subarray(r.length);this.nextBlock.set(t,this.i),this.i+=t.length}else n=new Uint8Array;return n}async finish(){let e;return e=0===this.i?new Uint8Array:this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function Dt(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++)e[n]=e[n]^t[n]}const xt=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));var Rt=Object.freeze({__proto__:null,decrypt:async function(e,t,r,n){const i=Q.read(Q.symmetric,e);if(It&&Kt[i])return function(e,t,r,n){const i=Q.read(Q.symmetric,e),s=new It.createDecipheriv(Kt[i],t,n);return B(r,(e=>new Uint8Array(s.update(e))))}(e,t,r,n);if(N.isAES(e))return async function(e,t,r,n){if(N.isStream(r)){const i=new Ut(!1,e,t,n);return B(r,(e=>i.processChunk(e)),(()=>i.finish()))}return gt(t,n).decrypt(r)}(e,t,r,n);const s=new(await ne(e))(t),a=s.blockSize;let o=n,c=new Uint8Array;const u=e=>{e&&(c=N.concatUint8Array([c,e]));const t=new Uint8Array(c.length);let r,n=0;for(;e?c.length>=a:c.length;){const e=s.encrypt(o);for(o=c.subarray(0,a),r=0;r<a;r++)t[n++]=o[r]^e[r];c=c.subarray(a)}return t.subarray(0,n)};return B(r,u,u)},encrypt:async function(e,t,r,n,i){const s=Q.read(Q.symmetric,e);if(N.getNodeCrypto()&&Kt[s])return function(e,t,r,n){const i=Q.read(Q.symmetric,e),s=new It.createCipheriv(Kt[i],t,n);return B(r,(e=>new Uint8Array(s.update(e))))}(e,t,r,n);if(N.isAES(e))return async function(e,t,r,n){if(St&&await Pt.isSupported(e)){const i=new Pt(e,t,n);return N.isStream(r)?B(r,(e=>i.encryptChunk(e)),(()=>i.finish())):i.encrypt(r)}if(N.isStream(r)){const i=new Ut(!0,e,t,n);return B(r,(e=>i.processChunk(e)),(()=>i.finish()))}return gt(t,n).encrypt(r)}(e,t,r,n);const a=new(await ne(e))(t),o=a.blockSize,c=n.slice();let u=new Uint8Array;const h=e=>{e&&(u=N.concatUint8Array([u,e]));const t=new Uint8Array(u.length);let r,n=0;for(;e?u.length>=o:u.length;){const e=a.encrypt(c);for(r=0;r<o;r++)c[r]=u[r]^e[r],t[n++]=c[r];u=u.subarray(o)}return t.subarray(0,n)};return B(r,h,h)}});const Tt=N.getWebCrypto(),_t=N.getNodeCrypto(),Lt=16;function Qt(e,t){const r=e.length-Lt;for(let n=0;n<Lt;n++)e[n+r]^=t[n];return e}const Ot=new Uint8Array(Lt);const Mt=N.getWebCrypto(),Nt=N.getNodeCrypto(),Ft=N.getNodeBuffer(),Ht=new Uint8Array(16),zt=new Uint8Array(16);zt[15]=1;const jt=new Uint8Array(16);async function Gt(e){const t=await async function(e){const t=await async function(e){if(N.getNodeCrypto())return async function(t){const r=new _t.createCipheriv("aes-"+8*e.length+"-cbc",e,Ot).update(t);return new Uint8Array(r)};if(N.getWebCrypto())try{return e=await Tt.importKey("raw",e,{name:"AES-CBC",length:8*e.length},!1,["encrypt"]),async function(t){const r=await Tt.encrypt({name:"AES-CBC",iv:Ot,length:128},e,t);return new Uint8Array(r).subarray(0,r.byteLength-Lt)}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;N.printDebugError("Browser did not support operation: "+t.message)}return async function(t){return pt(e,Ot,{disablePadding:!0}).encrypt(t)}}(e),r=N.double(await t(Ot)),n=N.double(r);return async function(e){return(await t(function(e,t,r){if(e.length&&e.length%Lt==0)return Qt(e,t);const n=new Uint8Array(e.length+(Lt-e.length%Lt));return n.set(e),n[e.length]=128,Qt(n,r)}(e,r,n))).subarray(-16)}}(e);return function(e,r){return t(N.concatUint8Array([e,r]))}}async function qt(e){if(N.getNodeCrypto())return async function(t,r){const n=new Nt.createCipheriv("aes-"+8*e.length+"-ctr",e,r),i=Ft.concat([n.update(t),n.final()]);return new Uint8Array(i)};if(N.getWebCrypto())try{const t=await Mt.importKey("raw",e,{name:"AES-CTR",length:8*e.length},!1,["encrypt"]);return async function(e,r){const n=await Mt.encrypt({name:"AES-CTR",counter:r,length:128},t,e);return new Uint8Array(n)}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;N.printDebugError("Browser did not support operation: "+t.message)}return async function(t,r){return dt(e,r).encrypt(t)}}async function Vt(e,t){if(e!==Q.symmetric.aes128&&e!==Q.symmetric.aes192&&e!==Q.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,n]=await Promise.all([Gt(t),qt(t)]);return{encrypt:async function(e,t,i){const[s,a]=await Promise.all([r(Ht,t),r(zt,i)]),o=await n(e,s),c=await r(jt,o);for(let e=0;e<16;e++)c[e]^=a[e]^s[e];return N.concatUint8Array([o,c])},decrypt:async function(e,t,i){if(e.length<16)throw Error("Invalid EAX ciphertext");const s=e.subarray(0,-16),a=e.subarray(-16),[o,c,u]=await Promise.all([r(Ht,t),r(zt,i),r(jt,s)]),h=u;for(let e=0;e<16;e++)h[e]^=c[e]^o[e];if(!N.equalsUint8Array(a,h))throw Error("Authentication tag mismatch");return await n(s,o)}}}jt[15]=2,Vt.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[8+e]^=t[e];return r},Vt.blockLength=16,Vt.ivLength=16,Vt.tagLength=16;const Jt=16;function Wt(e){let t=0;for(let r=1;!(e&r);r<<=1)t++;return t}function $t(e,t){for(let r=0;r<e.length;r++)e[r]^=t[r];return e}function Yt(e,t){return $t(e.slice(),t)}const Zt=new Uint8Array(Jt),Xt=new Uint8Array([1]);async function er(e,t){const{keySize:r}=ae(e);if(!N.isAES(e)||t.length!==r)throw Error("Unexpected algorithm or key size");let n=0;const i=pt(t,Zt,{disablePadding:!0}),s=e=>i.encrypt(e),a=e=>i.decrypt(e);let o;function c(e,t,r,i){const a=t.length/Jt|0;!function(e,t){const r=N.nbits(Math.max(e.length,t.length)/Jt|0)-1;for(let e=n+1;e<=r;e++)o[e]=N.double(o[e-1]);n=r}(t,i);const c=N.concatUint8Array([Zt.subarray(0,15-r.length),Xt,r]),u=63&c[15];c[15]&=192;const h=s(c),l=N.concatUint8Array([h,Yt(h.subarray(0,8),h.subarray(1,9))]),f=N.shiftRight(l.subarray(0+(u>>3),17+(u>>3)),8-(7&u)).subarray(1),y=new Uint8Array(Jt),d=new Uint8Array(t.length+16);let p,g=0;for(p=0;p<a;p++)$t(f,o[Wt(p+1)]),d.set($t(e(Yt(f,t)),f),g),$t(y,e===s?t:d.subarray(g)),t=t.subarray(Jt),g+=Jt;if(t.length){$t(f,o.x);const r=s(f);d.set(Yt(t,r),g);const n=new Uint8Array(Jt);n.set(e===s?t:d.subarray(g,-16),0),n[t.length]=128,$t(y,n),g+=t.length}const A=$t(s($t($t(y,f),o.$)),function(e){if(!e.length)return Zt;const t=e.length/Jt|0,r=new Uint8Array(Jt),n=new Uint8Array(Jt);for(let i=0;i<t;i++)$t(r,o[Wt(i+1)]),$t(n,s(Yt(r,e))),e=e.subarray(Jt);if(e.length){$t(r,o.x);const t=new Uint8Array(Jt);t.set(e,0),t[e.length]=128,$t(t,r),$t(n,s(t))}return n}(i));return d.set(A,g),d}return function(){const e=s(Zt),t=N.double(e);o=[],o[0]=N.double(t),o.x=e,o.$=t}(),{encrypt:async function(e,t,r){return c(s,e,t,r)},decrypt:async function(e,t,r){if(e.length<16)throw Error("Invalid OCB ciphertext");const n=e.subarray(-16);e=e.subarray(0,-16);const i=c(a,e,t,r);if(N.equalsUint8Array(n,i.subarray(-16)))return i.subarray(0,-16);throw Error("Authentication tag mismatch")}}}er.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[7+e]^=t[e];return r},er.blockLength=Jt,er.ivLength=15,er.tagLength=16;const tr=N.getWebCrypto(),rr=N.getNodeCrypto(),nr=N.getNodeBuffer(),ir="AES-GCM";async function sr(e,t){if(e!==Q.symmetric.aes128&&e!==Q.symmetric.aes192&&e!==Q.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(N.getNodeCrypto())return{encrypt:async function(e,r,n=new Uint8Array){const i=new rr.createCipheriv("aes-"+8*t.length+"-gcm",t,r);i.setAAD(n);const s=nr.concat([i.update(e),i.final(),i.getAuthTag()]);return new Uint8Array(s)},decrypt:async function(e,r,n=new Uint8Array){const i=new rr.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);i.setAAD(n),i.setAuthTag(e.slice(e.length-16,e.length));const s=nr.concat([i.update(e.slice(0,e.length-16)),i.final()]);return new Uint8Array(s)}};if(N.getWebCrypto())try{const e=await tr.importKey("raw",t,{name:ir},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(n,i,s=new Uint8Array){if(r&&!n.length)return At(t,i,s).encrypt(n);const a=await tr.encrypt({name:ir,iv:i,additionalData:s,tagLength:128},e,n);return new Uint8Array(a)},decrypt:async function(n,i,s=new Uint8Array){if(r&&16===n.length)return At(t,i,s).decrypt(n);try{const t=await tr.decrypt({name:ir,iv:i,additionalData:s,tagLength:128},e,n);return new Uint8Array(t)}catch(e){if("OperationError"===e.name)throw Error("Authentication tag mismatch")}}}}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;N.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,n){return At(t,r,n).encrypt(e)},decrypt:async function(e,r,n){return At(t,r,n).decrypt(e)}}}sr.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[4+e]^=t[e];return r},sr.blockLength=16,sr.ivLength=12,sr.tagLength=16;var ar={cfb:Rt,gcm:sr,experimentalGCM:sr,eax:Vt,ocb:er};const or=BigInt(0),cr=BigInt(1);function ur(e){const t="0123456789ABCDEF";let r="";return e.forEach((e=>{r+=t[e>>4]+t[15&e]})),BigInt("0x0"+r)}function hr(e,t){const r=e%t;return r<or?r+t:r}function lr(e,t,r){if(r===or)throw Error("Modulo cannot be zero");if(r===cr)return BigInt(0);if(t<or)throw Error("Unsopported negative exponent");let n=t,i=e;i%=r;let s=BigInt(1);for(;n>or;){const e=n&cr;n>>=cr,s=e?s*i%r:s,i=i*i%r}return s}function fr(e){return e>=or?e:-e}function yr(e,t){const{gcd:r,x:n}=function(e,t){let r=BigInt(0),n=BigInt(1),i=BigInt(1),s=BigInt(0),a=fr(e),o=fr(t);const c=e<or,u=t<or;for(;o!==or;){const e=a/o;let t=r;r=i-e*r,i=t,t=n,n=s-e*n,s=t,t=o,o=a%o,a=t}return{x:c?-i:i,y:u?-s:s,gcd:a}}(e,t);if(r!==cr)throw Error("Inverse does not exist");return hr(n+t,t)}function dr(e){const t=Number(e);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}function pr(e,t){return(e>>BigInt(t)&cr)===or?0:1}function gr(e){const t=e<or?BigInt(-1):or;let r=1,n=e;for(;(n>>=cr)!==t;)r++;return r}function Ar(e){const t=e<or?BigInt(-1):or,r=BigInt(8);let n=1,i=e;for(;(i>>=r)!==t;)n++;return n}function wr(e,t="be",r){let n=e.toString(16);n.length%2==1&&(n="0"+n);const i=n.length/2,s=new Uint8Array(r||i),a=r?r-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(n.slice(2*o,2*o+2),16),o++;return"be"!==t&&s.reverse(),s}const mr=N.getNodeCrypto();function br(e){const t="undefined"!=typeof crypto?crypto:mr?.webcrypto;if(t?.getRandomValues){const r=new Uint8Array(e);return t.getRandomValues(r)}throw Error("No secure random number generator available.")}function Er(e,t){if(t<e)throw Error("Illegal parameter value: max <= min");const r=t-e;return hr(ur(br(Ar(r)+8)),r)+e}var kr=Object.freeze({__proto__:null,getRandomBigInteger:Er,getRandomBytes:br});const vr=BigInt(1);function Br(e,t,r){const n=BigInt(30),i=vr<<BigInt(e-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=Er(i,i<<vr),o=dr(hr(a,n));do{a+=BigInt(s[o]),o=(o+s[o])%s.length,gr(a)>e&&(a=hr(a,i<<vr),a+=i,o=dr(hr(a,n)))}while(!Sr(a,t,r));return a}function Sr(e,t,r){return!(t&&function(e,t){let r=e,n=t;for(;n!==or;){const e=n;n=r%n,r=e}return r}(e-vr,t)!==vr||!function(e){const t=BigInt(0);return Ir.every((r=>hr(e,r)!==t))}(e)||!function(e,t=BigInt(2)){return lr(t,e-vr,e)===vr}(e)||!function(e,t){const r=gr(e);t||(t=Math.max(1,r/48|0));const n=e-vr;let i=0;for(;!pr(n,i);)i++;const s=e>>BigInt(i);for(;t>0;t--){let t,r=lr(Er(BigInt(2),n),s,e);if(r!==vr&&r!==n){for(t=1;t<i;t++){if(r=hr(r*r,e),r===vr)return!1;if(r===n)break}if(t===i)return!1}}return!0}(e,r))}const Ir=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map((e=>BigInt(e))),Cr=[];function Kr(e,t){const r=e.length;if(r>t-11)throw Error("Message too long");const n=function(e){const t=new Uint8Array(e);let r=0;for(;r<e;){const n=br(e-r);for(let e=0;e<n.length;e++)0!==n[e]&&(t[r++]=n[e])}return t}(t-r-3),i=new Uint8Array(t);return i[1]=2,i.set(n,2),i.set(e,t-r),i}function Pr(e,t){let r=2,n=1;for(let t=r;t<e.length;t++)n&=0!==e[t],r+=n;const i=r-2,s=e.subarray(r+1),a=0===e[0]&2===e[1]&i>=8&!n;if(t)return N.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function Ur(e,t,r){let n;if(t.length!==ve.getHashByteLength(e))throw Error("Invalid hash length");const i=new Uint8Array(Cr[e].length);for(n=0;n<Cr[e].length;n++)i[n]=Cr[e][n];const s=i.length+t.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(t,r-t.length),o}Cr[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Cr[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Cr[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Cr[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Cr[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Cr[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Cr[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var Dr=Object.freeze({__proto__:null,emeDecode:Pr,emeEncode:Kr,emsaEncode:Ur});const xr=N.getWebCrypto(),Rr=N.getNodeCrypto(),Tr=BigInt(1);async function _r(e,t,r,n,i,s){const a=ur(n),o=ur(i),c=ur(r);let u=hr(c,o-Tr),h=hr(c,a-Tr);return h=wr(h),u=wr(u),{kty:"RSA",n:V(e),e:V(t),d:V(r),p:V(i),q:V(n),dp:V(u),dq:V(h),qi:V(s),ext:!0}}function Lr(e,t){return{kty:"RSA",n:V(e),e:V(t),ext:!0}}function Qr(e,t){return{n:q(e.n),e:wr(t),d:q(e.d),p:q(e.q),q:q(e.p),u:q(e.qi)}}var Or=Object.freeze({__proto__:null,decrypt:async function(e,t,r,n,i,s,a,o){if(N.getNodeCrypto()&&!o)try{return await async function(e,t,r,n,i,s,a){const o={key:await _r(t,r,n,i,s,a),format:"jwk",type:"pkcs1",padding:Rr.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Rr.privateDecrypt(o,e))}catch(e){throw Error("Decryption error")}}(e,t,r,n,i,s,a)}catch(e){N.printDebugError(e)}return async function(e,t,r,n,i,s,a,o){if(e=ur(e),t=ur(t),r=ur(r),n=ur(n),i=ur(i),s=ur(s),a=ur(a),e>=t)throw Error("Data too large.");const c=hr(n,s-Tr),u=hr(n,i-Tr),h=Er(BigInt(2),t),l=lr(yr(h,t),r,t),f=lr(e=hr(e*l,t),u,i);let y=hr(a*(lr(e,c,s)-f),s)*i+f;return y=hr(y*h,t),Pr(wr(y,"be",Ar(t)),o)}(e,t,r,n,i,s,a,o)},encrypt:async function(e,t,r){return N.getNodeCrypto()?async function(e,t,r){const n={key:Lr(t,r),format:"jwk",type:"pkcs1",padding:Rr.constants.RSA_PKCS1_PADDING};return new Uint8Array(Rr.publicEncrypt(n,e))}(e,t,r):async function(e,t,r){if(t=ur(t),e=ur(Kr(e,Ar(t))),r=ur(r),e>=t)throw Error("Message size cannot exceed modulus size");return wr(lr(e,r,t),"be",Ar(t))}(e,t,r)},generate:async function(e,t){if(t=BigInt(t),N.getWebCrypto()){const r={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:wr(t),hash:{name:"SHA-1"}},n=await xr.generateKey(r,!0,["sign","verify"]);return Qr(await xr.exportKey("jwk",n.privateKey),t)}if(N.getNodeCrypto()){const r={modulusLength:e,publicExponent:dr(t),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},n=await new Promise(((e,t)=>{Rr.generateKeyPair("rsa",r,((r,n,i)=>{r?t(r):e(i)}))}));return Qr(n,t)}let r,n,i;do{n=Br(e-(e>>1),t,40),r=Br(e>>1,t,40),i=r*n}while(gr(i)!==e);const s=(r-Tr)*(n-Tr);return n<r&&([r,n]=[n,r]),{n:wr(i),e:wr(t),d:wr(yr(t,s)),p:wr(r),q:wr(n),u:wr(yr(r,n))}},sign:async function(e,t,r,n,i,s,a,o,c){if(ve.getHashByteLength(e)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!N.isStream(t))if(N.getWebCrypto())try{return await async function(e,t,r,n,i,s,a,o){const c=await _r(r,n,i,s,a,o),u={name:"RSASSA-PKCS1-v1_5",hash:{name:e}},h=await xr.importKey("jwk",c,u,!1,["sign"]);return new Uint8Array(await xr.sign("RSASSA-PKCS1-v1_5",h,t))}(Q.read(Q.webHash,e),t,r,n,i,s,a,o)}catch(e){N.printDebugError(e)}else if(N.getNodeCrypto())return async function(e,t,r,n,i,s,a,o){const c=Rr.createSign(Q.read(Q.hash,e));c.write(t),c.end();const u=await _r(r,n,i,s,a,o);return new Uint8Array(c.sign({key:u,format:"jwk",type:"pkcs1"}))}(e,t,r,n,i,s,a,o);return async function(e,t,r,n){return t=ur(t),wr(lr(ur(Ur(e,n,Ar(t))),r=ur(r),t),"be",Ar(t))}(e,r,i,c)},validateParams:async function(e,t,r,n,i,s){if(e=ur(e),(n=ur(n))*(i=ur(i))!==e)return!1;const a=BigInt(2);if(hr(n*(s=ur(s)),i)!==BigInt(1))return!1;t=ur(t),r=ur(r);const o=Er(a,a<<BigInt(Math.floor(gr(e)/3))),c=o*r*t;return!(hr(c,n-Tr)!==o||hr(c,i-Tr)!==o)},verify:async function(e,t,r,n,i,s){if(t&&!N.isStream(t))if(N.getWebCrypto())try{return await async function(e,t,r,n,i){const s=Lr(n,i),a=await xr.importKey("jwk",s,{name:"RSASSA-PKCS1-v1_5",hash:{name:e}},!1,["verify"]);return xr.verify("RSASSA-PKCS1-v1_5",a,r,t)}(Q.read(Q.webHash,e),t,r,n,i)}catch(e){N.printDebugError(e)}else if(N.getNodeCrypto())return async function(e,t,r,n,i){const s={key:Lr(n,i),format:"jwk",type:"pkcs1"},a=Rr.createVerify(Q.read(Q.hash,e));a.write(t),a.end();try{return a.verify(s,r)}catch(e){return!1}}(e,t,r,n,i);return async function(e,t,r,n,i){if(r=ur(r),t=ur(t),n=ur(n),t>=r)throw Error("Signature size cannot exceed modulus size");const s=wr(lr(t,n,r),"be",Ar(r)),a=Ur(e,i,Ar(r));return N.equalsUint8Array(s,a)}(e,r,n,i,s)}});const Mr=BigInt(1);var Nr=Object.freeze({__proto__:null,decrypt:async function(e,t,r,n,i){return e=ur(e),t=ur(t),r=ur(r),Pr(wr(hr(yr(lr(e,n=ur(n),r),r)*t,r),"be",Ar(r)),i)},encrypt:async function(e,t,r,n){t=ur(t),r=ur(r),n=ur(n);const i=ur(Kr(e,Ar(t))),s=Er(Mr,t-Mr);return{c1:wr(lr(r,s,t)),c2:wr(hr(lr(n,s,t)*i,t))}},validateParams:async function(e,t,r,n){if(e=ur(e),t=ur(t),r=ur(r),t<=Mr||t>=e)return!1;const i=BigInt(gr(e));if(i<BigInt(1023))return!1;if(lr(t,e-Mr,e)!==Mr)return!1;let s=t,a=BigInt(1);const o=BigInt(2),c=o<<BigInt(17);for(;a<c;){if(s=hr(s*t,e),s===Mr)return!1;a++}n=ur(n);const u=Er(o<<i-Mr,o<<i);return r===lr(t,(e-Mr)*u+n,e)}});const Fr="object"==typeof n&&"crypto"in n?n.crypto:void 0,Hr={};var zr=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},jr=function(){throw Error("no PRNG")},Gr=new Uint8Array(32);Gr[0]=9;var qr=zr(),Vr=zr([1]),Jr=zr([56129,1]),Wr=zr([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),$r=zr([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Yr=zr([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Zr=zr([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Xr=zr([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function en(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function tn(e,t,r,n){return function(e,t,r,n){var i,s=0;for(i=0;i<32;i++)s|=e[t+i]^r[n+i];return(1&s-1>>>8)-1}(e,t,r,n)}function rn(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function nn(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function sn(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function an(e,t){var r,n,i,s=zr(),a=zr();for(r=0;r<16;r++)a[r]=t[r];for(nn(a),nn(a),nn(a),n=0;n<2;n++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,sn(a,s,1-i)}for(r=0;r<16;r++)e[2*r]=255&a[r],e[2*r+1]=a[r]>>8}function on(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return an(r,e),an(n,t),tn(r,0,n,0)}function cn(e){var t=new Uint8Array(32);return an(t,e),1&t[0]}function un(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function hn(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function ln(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function fn(e,t,r){var n,i,s=0,a=0,o=0,c=0,u=0,h=0,l=0,f=0,y=0,d=0,p=0,g=0,A=0,w=0,m=0,b=0,E=0,k=0,v=0,B=0,S=0,I=0,C=0,K=0,P=0,U=0,D=0,x=0,R=0,T=0,_=0,L=r[0],Q=r[1],O=r[2],M=r[3],N=r[4],F=r[5],H=r[6],z=r[7],j=r[8],G=r[9],q=r[10],V=r[11],J=r[12],W=r[13],$=r[14],Y=r[15];s+=(n=t[0])*L,a+=n*Q,o+=n*O,c+=n*M,u+=n*N,h+=n*F,l+=n*H,f+=n*z,y+=n*j,d+=n*G,p+=n*q,g+=n*V,A+=n*J,w+=n*W,m+=n*$,b+=n*Y,a+=(n=t[1])*L,o+=n*Q,c+=n*O,u+=n*M,h+=n*N,l+=n*F,f+=n*H,y+=n*z,d+=n*j,p+=n*G,g+=n*q,A+=n*V,w+=n*J,m+=n*W,b+=n*$,E+=n*Y,o+=(n=t[2])*L,c+=n*Q,u+=n*O,h+=n*M,l+=n*N,f+=n*F,y+=n*H,d+=n*z,p+=n*j,g+=n*G,A+=n*q,w+=n*V,m+=n*J,b+=n*W,E+=n*$,k+=n*Y,c+=(n=t[3])*L,u+=n*Q,h+=n*O,l+=n*M,f+=n*N,y+=n*F,d+=n*H,p+=n*z,g+=n*j,A+=n*G,w+=n*q,m+=n*V,b+=n*J,E+=n*W,k+=n*$,v+=n*Y,u+=(n=t[4])*L,h+=n*Q,l+=n*O,f+=n*M,y+=n*N,d+=n*F,p+=n*H,g+=n*z,A+=n*j,w+=n*G,m+=n*q,b+=n*V,E+=n*J,k+=n*W,v+=n*$,B+=n*Y,h+=(n=t[5])*L,l+=n*Q,f+=n*O,y+=n*M,d+=n*N,p+=n*F,g+=n*H,A+=n*z,w+=n*j,m+=n*G,b+=n*q,E+=n*V,k+=n*J,v+=n*W,B+=n*$,S+=n*Y,l+=(n=t[6])*L,f+=n*Q,y+=n*O,d+=n*M,p+=n*N,g+=n*F,A+=n*H,w+=n*z,m+=n*j,b+=n*G,E+=n*q,k+=n*V,v+=n*J,B+=n*W,S+=n*$,I+=n*Y,f+=(n=t[7])*L,y+=n*Q,d+=n*O,p+=n*M,g+=n*N,A+=n*F,w+=n*H,m+=n*z,b+=n*j,E+=n*G,k+=n*q,v+=n*V,B+=n*J,S+=n*W,I+=n*$,C+=n*Y,y+=(n=t[8])*L,d+=n*Q,p+=n*O,g+=n*M,A+=n*N,w+=n*F,m+=n*H,b+=n*z,E+=n*j,k+=n*G,v+=n*q,B+=n*V,S+=n*J,I+=n*W,C+=n*$,K+=n*Y,d+=(n=t[9])*L,p+=n*Q,g+=n*O,A+=n*M,w+=n*N,m+=n*F,b+=n*H,E+=n*z,k+=n*j,v+=n*G,B+=n*q,S+=n*V,I+=n*J,C+=n*W,K+=n*$,P+=n*Y,p+=(n=t[10])*L,g+=n*Q,A+=n*O,w+=n*M,m+=n*N,b+=n*F,E+=n*H,k+=n*z,v+=n*j,B+=n*G,S+=n*q,I+=n*V,C+=n*J,K+=n*W,P+=n*$,U+=n*Y,g+=(n=t[11])*L,A+=n*Q,w+=n*O,m+=n*M,b+=n*N,E+=n*F,k+=n*H,v+=n*z,B+=n*j,S+=n*G,I+=n*q,C+=n*V,K+=n*J,P+=n*W,U+=n*$,D+=n*Y,A+=(n=t[12])*L,w+=n*Q,m+=n*O,b+=n*M,E+=n*N,k+=n*F,v+=n*H,B+=n*z,S+=n*j,I+=n*G,C+=n*q,K+=n*V,P+=n*J,U+=n*W,D+=n*$,x+=n*Y,w+=(n=t[13])*L,m+=n*Q,b+=n*O,E+=n*M,k+=n*N,v+=n*F,B+=n*H,S+=n*z,I+=n*j,C+=n*G,K+=n*q,P+=n*V,U+=n*J,D+=n*W,x+=n*$,R+=n*Y,m+=(n=t[14])*L,b+=n*Q,E+=n*O,k+=n*M,v+=n*N,B+=n*F,S+=n*H,I+=n*z,C+=n*j,K+=n*G,P+=n*q,U+=n*V,D+=n*J,x+=n*W,R+=n*$,T+=n*Y,b+=(n=t[15])*L,a+=38*(k+=n*O),o+=38*(v+=n*M),c+=38*(B+=n*N),u+=38*(S+=n*F),h+=38*(I+=n*H),l+=38*(C+=n*z),f+=38*(K+=n*j),y+=38*(P+=n*G),d+=38*(U+=n*q),p+=38*(D+=n*V),g+=38*(x+=n*J),A+=38*(R+=n*W),w+=38*(T+=n*$),m+=38*(_+=n*Y),s=(n=(s+=38*(E+=n*Q))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=a,e[2]=o,e[3]=c,e[4]=u,e[5]=h,e[6]=l,e[7]=f,e[8]=y,e[9]=d,e[10]=p,e[11]=g,e[12]=A,e[13]=w,e[14]=m,e[15]=b}function yn(e,t){fn(e,t,t)}function dn(e,t){var r,n=zr();for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--)yn(n,n),2!==r&&4!==r&&fn(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}function pn(e,t,r){var n,i,s=new Uint8Array(32),a=new Float64Array(80),o=zr(),c=zr(),u=zr(),h=zr(),l=zr(),f=zr();for(i=0;i<31;i++)s[i]=t[i];for(s[31]=127&t[31]|64,s[0]&=248,un(a,r),i=0;i<16;i++)c[i]=a[i],h[i]=o[i]=u[i]=0;for(o[0]=h[0]=1,i=254;i>=0;--i)sn(o,c,n=s[i>>>3]>>>(7&i)&1),sn(u,h,n),hn(l,o,u),ln(o,o,u),hn(u,c,h),ln(c,c,h),yn(h,l),yn(f,o),fn(o,u,o),fn(u,c,l),hn(l,o,u),ln(o,o,u),yn(c,o),ln(u,h,f),fn(o,u,Jr),hn(o,o,h),fn(u,u,o),fn(o,h,f),fn(h,c,a),yn(c,l),sn(o,c,n),sn(u,h,n);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=u[i],a[i+48]=c[i],a[i+64]=h[i];var y=a.subarray(32),d=a.subarray(16);return dn(y,y),fn(d,d,y),an(e,d),0}function gn(e,t){return pn(e,t,Gr)}var An=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function wn(e,t,r,n){for(var i,s,a,o,c,u,h,l,f,y,d,p,g,A,w,m,b,E,k,v,B,S,I,C,K,P,U=new Int32Array(16),D=new Int32Array(16),x=e[0],R=e[1],T=e[2],_=e[3],L=e[4],Q=e[5],O=e[6],M=e[7],N=t[0],F=t[1],H=t[2],z=t[3],j=t[4],G=t[5],q=t[6],V=t[7],J=0;n>=128;){for(k=0;k<16;k++)v=8*k+J,U[k]=r[v+0]<<24|r[v+1]<<16|r[v+2]<<8|r[v+3],D[k]=r[v+4]<<24|r[v+5]<<16|r[v+6]<<8|r[v+7];for(k=0;k<80;k++)if(i=x,s=R,a=T,o=_,c=L,u=Q,h=O,f=N,y=F,d=H,p=z,g=j,A=G,w=q,I=65535&(S=V),C=S>>>16,K=65535&(B=M),P=B>>>16,I+=65535&(S=(j>>>14|L<<18)^(j>>>18|L<<14)^(L>>>9|j<<23)),C+=S>>>16,K+=65535&(B=(L>>>14|j<<18)^(L>>>18|j<<14)^(j>>>9|L<<23)),P+=B>>>16,I+=65535&(S=j&G^~j&q),C+=S>>>16,K+=65535&(B=L&Q^~L&O),P+=B>>>16,I+=65535&(S=An[2*k+1]),C+=S>>>16,K+=65535&(B=An[2*k]),P+=B>>>16,B=U[k%16],C+=(S=D[k%16])>>>16,K+=65535&B,P+=B>>>16,K+=(C+=(I+=65535&S)>>>16)>>>16,I=65535&(S=E=65535&I|C<<16),C=S>>>16,K=65535&(B=b=65535&K|(P+=K>>>16)<<16),P=B>>>16,I+=65535&(S=(N>>>28|x<<4)^(x>>>2|N<<30)^(x>>>7|N<<25)),C+=S>>>16,K+=65535&(B=(x>>>28|N<<4)^(N>>>2|x<<30)^(N>>>7|x<<25)),P+=B>>>16,C+=(S=N&F^N&H^F&H)>>>16,K+=65535&(B=x&R^x&T^R&T),P+=B>>>16,l=65535&(K+=(C+=(I+=65535&S)>>>16)>>>16)|(P+=K>>>16)<<16,m=65535&I|C<<16,I=65535&(S=p),C=S>>>16,K=65535&(B=o),P=B>>>16,C+=(S=E)>>>16,K+=65535&(B=b),P+=B>>>16,R=i,T=s,_=a,L=o=65535&(K+=(C+=(I+=65535&S)>>>16)>>>16)|(P+=K>>>16)<<16,Q=c,O=u,M=h,x=l,F=f,H=y,z=d,j=p=65535&I|C<<16,G=g,q=A,V=w,N=m,k%16==15)for(v=0;v<16;v++)B=U[v],I=65535&(S=D[v]),C=S>>>16,K=65535&B,P=B>>>16,B=U[(v+9)%16],I+=65535&(S=D[(v+9)%16]),C+=S>>>16,K+=65535&B,P+=B>>>16,b=U[(v+1)%16],I+=65535&(S=((E=D[(v+1)%16])>>>1|b<<31)^(E>>>8|b<<24)^(E>>>7|b<<25)),C+=S>>>16,K+=65535&(B=(b>>>1|E<<31)^(b>>>8|E<<24)^b>>>7),P+=B>>>16,b=U[(v+14)%16],C+=(S=((E=D[(v+14)%16])>>>19|b<<13)^(b>>>29|E<<3)^(E>>>6|b<<26))>>>16,K+=65535&(B=(b>>>19|E<<13)^(E>>>29|b<<3)^b>>>6),P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,U[v]=65535&K|P<<16,D[v]=65535&I|C<<16;I=65535&(S=N),C=S>>>16,K=65535&(B=x),P=B>>>16,B=e[0],C+=(S=t[0])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[0]=x=65535&K|P<<16,t[0]=N=65535&I|C<<16,I=65535&(S=F),C=S>>>16,K=65535&(B=R),P=B>>>16,B=e[1],C+=(S=t[1])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[1]=R=65535&K|P<<16,t[1]=F=65535&I|C<<16,I=65535&(S=H),C=S>>>16,K=65535&(B=T),P=B>>>16,B=e[2],C+=(S=t[2])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[2]=T=65535&K|P<<16,t[2]=H=65535&I|C<<16,I=65535&(S=z),C=S>>>16,K=65535&(B=_),P=B>>>16,B=e[3],C+=(S=t[3])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[3]=_=65535&K|P<<16,t[3]=z=65535&I|C<<16,I=65535&(S=j),C=S>>>16,K=65535&(B=L),P=B>>>16,B=e[4],C+=(S=t[4])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[4]=L=65535&K|P<<16,t[4]=j=65535&I|C<<16,I=65535&(S=G),C=S>>>16,K=65535&(B=Q),P=B>>>16,B=e[5],C+=(S=t[5])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[5]=Q=65535&K|P<<16,t[5]=G=65535&I|C<<16,I=65535&(S=q),C=S>>>16,K=65535&(B=O),P=B>>>16,B=e[6],C+=(S=t[6])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[6]=O=65535&K|P<<16,t[6]=q=65535&I|C<<16,I=65535&(S=V),C=S>>>16,K=65535&(B=M),P=B>>>16,B=e[7],C+=(S=t[7])>>>16,K+=65535&B,P+=B>>>16,P+=(K+=(C+=(I+=65535&S)>>>16)>>>16)>>>16,e[7]=M=65535&K|P<<16,t[7]=V=65535&I|C<<16,J+=128,n-=128}return n}function mn(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,wn(i,s,t,r),r%=128,n=0;n<r;n++)a[n]=t[o-r+n];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,en(a,r-8,o/536870912|0,o<<3),wn(i,s,a,r),n=0;n<8;n++)en(e,8*n,i[n],s[n]);return 0}function bn(e,t){var r=zr(),n=zr(),i=zr(),s=zr(),a=zr(),o=zr(),c=zr(),u=zr(),h=zr();ln(r,e[1],e[0]),ln(h,t[1],t[0]),fn(r,r,h),hn(n,e[0],e[1]),hn(h,t[0],t[1]),fn(n,n,h),fn(i,e[3],t[3]),fn(i,i,$r),fn(s,e[2],t[2]),hn(s,s,s),ln(a,n,r),ln(o,s,i),hn(c,s,i),hn(u,n,r),fn(e[0],a,o),fn(e[1],u,c),fn(e[2],c,o),fn(e[3],a,u)}function En(e,t,r){var n;for(n=0;n<4;n++)sn(e[n],t[n],r)}function kn(e,t){var r=zr(),n=zr(),i=zr();dn(i,t[2]),fn(r,t[0],i),fn(n,t[1],i),an(e,n),e[31]^=cn(r)<<7}function vn(e,t,r){var n,i;for(rn(e[0],qr),rn(e[1],Vr),rn(e[2],Vr),rn(e[3],qr),i=255;i>=0;--i)En(e,t,n=r[i/8|0]>>(7&i)&1),bn(t,e),bn(e,e),En(e,t,n)}function Bn(e,t){var r=[zr(),zr(),zr(),zr()];rn(r[0],Yr),rn(r[1],Zr),rn(r[2],Vr),fn(r[3],Yr,Zr),vn(e,r,t)}function Sn(e,t,r){var n,i=new Uint8Array(64),s=[zr(),zr(),zr(),zr()];for(r||jr(t,32),mn(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,Bn(s,i),kn(e,s),n=0;n<32;n++)t[n+32]=e[n];return 0}var In=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Cn(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*In[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*In[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*In[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function Kn(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;Cn(e,r)}var Pn=64;function Un(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}Hr.scalarMult=function(e,t){if(Un(e,t),32!==e.length)throw Error("bad n size");if(32!==t.length)throw Error("bad p size");var r=new Uint8Array(32);return pn(r,e,t),r},Hr.box={},Hr.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return function(e,t){jr(t,32),gn(e,t)}(e,t),{publicKey:e,secretKey:t}},Hr.box.keyPair.fromSecretKey=function(e){if(Un(e),32!==e.length)throw Error("bad secret key size");var t=new Uint8Array(32);return gn(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},Hr.sign=function(e,t){if(Un(e,t),64!==t.length)throw Error("bad secret key size");var r=new Uint8Array(Pn+e.length);return function(e,t,r,n){var i,s,a=new Uint8Array(64),o=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),h=[zr(),zr(),zr(),zr()];for(mn(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64,i=0;i<r;i++)e[64+i]=t[i];for(i=0;i<32;i++)e[32+i]=a[32+i];for(mn(c,e.subarray(32),r+32),Kn(c),Bn(h,c),kn(e,h),i=32;i<64;i++)e[i]=n[i];for(mn(o,e,r+64),Kn(o),i=0;i<64;i++)u[i]=0;for(i=0;i<32;i++)u[i]=c[i];for(i=0;i<32;i++)for(s=0;s<32;s++)u[i+s]+=o[i]*a[s];Cn(e.subarray(32),u)}(r,e,e.length,t),r},Hr.sign.detached=function(e,t){for(var r=Hr.sign(e,t),n=new Uint8Array(Pn),i=0;i<n.length;i++)n[i]=r[i];return n},Hr.sign.detached.verify=function(e,t,r){if(Un(e,t,r),t.length!==Pn)throw Error("bad signature size");if(32!==r.length)throw Error("bad public key size");var n,i=new Uint8Array(Pn+e.length),s=new Uint8Array(Pn+e.length);for(n=0;n<Pn;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+Pn]=e[n];return function(e,t,r,n){var i,s=new Uint8Array(32),a=new Uint8Array(64),o=[zr(),zr(),zr(),zr()],c=[zr(),zr(),zr(),zr()];if(r<64)return-1;if(function(e,t){var r=zr(),n=zr(),i=zr(),s=zr(),a=zr(),o=zr(),c=zr();return rn(e[2],Vr),un(e[1],t),yn(i,e[1]),fn(s,i,Wr),ln(i,i,e[2]),hn(s,e[2],s),yn(a,s),yn(o,a),fn(c,o,a),fn(r,c,i),fn(r,r,s),function(e,t){var r,n=zr();for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--)yn(n,n),1!==r&&fn(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}(r,r),fn(r,r,i),fn(r,r,s),fn(r,r,s),fn(e[0],r,s),yn(n,e[0]),fn(n,n,s),on(n,i)&&fn(e[0],e[0],Xr),yn(n,e[0]),fn(n,n,s),on(n,i)?-1:(cn(e[0])===t[31]>>7&&ln(e[0],qr,e[0]),fn(e[3],e[0],e[1]),0)}(c,n))return-1;for(i=0;i<r;i++)e[i]=t[i];for(i=0;i<32;i++)e[i+32]=n[i];if(mn(a,e,r),Kn(a),vn(o,c,a),Bn(c,t.subarray(32)),bn(o,c),kn(s,o),r-=64,tn(t,0,s,0)){for(i=0;i<r;i++)e[i]=0;return-1}for(i=0;i<r;i++)e[i]=t[i+64];return r}(s,i,i.length,r)>=0},Hr.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return Sn(e,t),{publicKey:e,secretKey:t}},Hr.sign.keyPair.fromSecretKey=function(e){if(Un(e),64!==e.length)throw Error("bad secret key size");for(var t=new Uint8Array(32),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},Hr.sign.keyPair.fromSeed=function(e){if(Un(e),32!==e.length)throw Error("bad seed size");for(var t=new Uint8Array(32),r=new Uint8Array(64),n=0;n<32;n++)r[n]=e[n];return Sn(t,r,!0),{publicKey:t,secretKey:r}},Hr.setPRNG=function(e){jr=e},Fr&&Fr.getRandomValues&&Hr.setPRNG((function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)Fr.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];!function(e){for(var t=0;t<e.length;t++)e[t]=0}(n)}));const Dn={"2a8648ce3d030107":Q.curve.nistP256,"2b81040022":Q.curve.nistP384,"2b81040023":Q.curve.nistP521,"2b8104000a":Q.curve.secp256k1,"2b06010401da470f01":Q.curve.ed25519Legacy,"2b060104019755010501":Q.curve.curve25519Legacy,"2b2403030208010107":Q.curve.brainpoolP256r1,"2b240303020801010b":Q.curve.brainpoolP384r1,"2b240303020801010d":Q.curve.brainpoolP512r1};class xn{constructor(e){if(e instanceof xn)this.oid=e.oid;else if(N.isArray(e)||N.isUint8Array(e)){if(6===(e=new Uint8Array(e))[0]){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.oid=e.subarray(1,1+t),1+this.oid.length}throw Error("Invalid oid")}write(){return N.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return N.uint8ArrayToHex(this.oid)}getName(){const e=Dn[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function Rn(e){let t,r=0;const n=e[0];return n<192?([r]=e,t=1):n<255?(r=(e[0]-192<<8)+e[1]+192,t=2):255===n&&(r=N.readNumber(e.subarray(1,5)),t=5),{len:r,offset:t}}function Tn(e){return e<192?new Uint8Array([e]):e>191&&e<8384?new Uint8Array([192+(e-192>>8),e-192&255]):N.concatUint8Array([new Uint8Array([255]),N.writeNumber(e,4)])}function _n(e){if(e<0||e>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+e])}function Ln(e){return new Uint8Array([192|e])}function Qn(e,t){return N.concatUint8Array([Ln(e),Tn(t)])}function On(e){return[Q.packet.literalData,Q.packet.compressedData,Q.packet.symmetricallyEncryptedData,Q.packet.symEncryptedIntegrityProtectedData,Q.packet.aeadEncryptedData].includes(e)}async function Mn(e,t){const r=T(e);let n,i;try{const s=await r.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await r.readByte();let o,c,h=-1,l=-1;l=0,64&a&&(l=1),l?h=63&a:(h=(63&a)>>2,c=3&a);const f=On(h);let y,d=null;if(f){if("array"===N.isStream(e)){const e=new u;n=_(e),d=e}else{const e=new TransformStream;n=_(e.writable),d=e.readable}i=t({tag:h,packet:d})}else d=[];do{if(l){const e=await r.readByte();if(y=!1,e<192)o=e;else if(e>=192&&e<224)o=(e-192<<8)+await r.readByte()+192;else if(e>223&&e<255){if(o=1<<(31&e),y=!0,!f)throw new TypeError("This packet type does not support partial lengths.")}else o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte()}else switch(c){case 0:o=await r.readByte();break;case 1:o=await r.readByte()<<8|await r.readByte();break;case 2:o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte();break;default:o=1/0}if(o>0){let e=0;for(;;){n&&await n.ready;const{done:t,value:i}=await r.read();if(t){if(o===1/0)break;throw Error("Unexpected end of packet")}const s=o===1/0?i:i.subarray(0,o-e);if(n?await n.write(s):d.push(s),e+=i.length,e>=o){r.unshift(i.subarray(o-e+i.length));break}}}}while(y);const p=await r.peekBytes(f?1/0:2);return n?(await n.ready,await n.close()):(d=N.concatUint8Array(d),await t({tag:h,packet:d})),!p||!p.length}catch(e){if(n)return await n.abort(e),!0;throw e}finally{n&&await i,r.releaseLock()}}class Nn extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Nn),this.name="UnsupportedError"}}class Fn extends Nn{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Nn),this.name="UnknownPacketError"}}class Hn{constructor(e,t){this.tag=e,this.rawContent=t}write(){return this.rawContent}}async function zn(e){switch(e){case Q.publicKey.ed25519:try{const e=N.getWebCrypto(),t=await e.generateKey("Ed25519",!0,["sign","verify"]),r=await e.exportKey("jwk",t.privateKey),n=await e.exportKey("jwk",t.publicKey);return{A:new Uint8Array(q(n.x)),seed:q(r.d)}}catch(t){if("NotSupportedError"!==t.name&&"OperationError"!==t.name)throw t;const r=br(qn(e)),{publicKey:n}=Hr.sign.keyPair.fromSeed(r);return{A:n,seed:r}}case Q.publicKey.ed448:{const e=await N.getNobleCurve(Q.publicKey.ed448),t=e.utils.randomPrivateKey();return{A:e.getPublicKey(t),seed:t}}default:throw Error("Unsupported EdDSA algorithm")}}async function jn(e,t,r,n,i,s){if(ve.getHashByteLength(t)<ve.getHashByteLength(Vn(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case Q.publicKey.ed25519:try{const t=N.getWebCrypto(),r=Wn(e,n,i),a=await t.importKey("jwk",r,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await t.sign("Ed25519",a,s))}}catch(e){if("NotSupportedError"!==e.name)throw e;const t=N.concatUint8Array([i,n]);return{RS:Hr.sign.detached(s,t)}}case Q.publicKey.ed448:return{RS:(await N.getNobleCurve(Q.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function Gn(e,t,{RS:r},n,i,s){if(ve.getHashByteLength(t)<ve.getHashByteLength(Vn(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case Q.publicKey.ed25519:try{const t=N.getWebCrypto(),n=Jn(e,i),a=await t.importKey("jwk",n,"Ed25519",!1,["verify"]);return await t.verify("Ed25519",a,r,s)}catch(e){if("NotSupportedError"!==e.name)throw e;return Hr.sign.detached.verify(s,r,i)}case Q.publicKey.ed448:return(await N.getNobleCurve(Q.publicKey.ed448)).verify(r,s,i);default:throw Error("Unsupported EdDSA algorithm")}}function qn(e){switch(e){case Q.publicKey.ed25519:return 32;case Q.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function Vn(e){switch(e){case Q.publicKey.ed25519:return Q.hash.sha256;case Q.publicKey.ed448:return Q.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const Jn=(e,t)=>{if(e===Q.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:V(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},Wn=(e,t,r)=>{if(e===Q.publicKey.ed25519){const n=Jn(e,t);return n.d=V(r),n}throw Error("Unsupported EdDSA algorithm")};var $n=Object.freeze({__proto__:null,generate:zn,getPayloadSize:qn,getPreferredHashAlgo:Vn,sign:jn,validateParams:async function(e,t,r){switch(e){case Q.publicKey.ed25519:{const{publicKey:e}=Hr.sign.keyPair.fromSeed(r);return N.equalsUint8Array(t,e)}case Q.publicKey.ed448:{const e=(await N.getNobleCurve(Q.publicKey.ed448)).getPublicKey(r);return N.equalsUint8Array(t,e)}default:return!1}},verify:Gn});const Yn=N.getWebCrypto();async function Zn(e,t,r){const{keySize:n}=ae(e);if(!N.isAES(e)||t.length!==n)throw Error("Unexpected algorithm or key size");try{const e=await Yn.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),n=await Yn.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),i=await Yn.wrapKey("raw",n,e,{name:"AES-KW"});return new Uint8Array(i)}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;N.printDebugError("Browser did not support operation: "+e.message)}return vt(t).encrypt(r)}async function Xn(e,t,r){const{keySize:n}=ae(e);if(!N.isAES(e)||t.length!==n)throw Error("Unexpected algorithm or key size");let i;try{i=await Yn.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;return N.printDebugError("Browser did not support operation: "+e.message),vt(t).decrypt(r)}try{const e=await Yn.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await Yn.exportKey("raw",e))}catch(e){if("OperationError"===e.name)throw Error("Key Data Integrity failed");throw e}}var ei=Object.freeze({__proto__:null,unwrap:Xn,wrap:Zn});const ti=N.getWebCrypto();async function ri(e,t,r,n,i){const s=Q.read(Q.webHash,e);if(!s)throw Error("Hash algo not supported with HKDF");const a=await ti.importKey("raw",t,"HKDF",!1,["deriveBits"]),o=await ti.deriveBits({name:"HKDF",hash:s,salt:r,info:n},a,8*i);return new Uint8Array(o)}const ni={x25519:N.encodeUTF8("OpenPGP X25519"),x448:N.encodeUTF8("OpenPGP X448")};async function ii(e){switch(e){case Q.publicKey.x25519:{const e=br(32),{publicKey:t}=Hr.box.keyPair.fromSecretKey(e);return{A:t,k:e}}case Q.publicKey.x448:{const e=await N.getNobleCurve(Q.publicKey.x448),t=e.utils.randomPrivateKey();return{A:e.getPublicKey(t),k:t}}default:throw Error("Unsupported ECDH algorithm")}}function si(e){switch(e){case Q.publicKey.x25519:return 32;case Q.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function ai(e,t){switch(e){case Q.publicKey.x25519:{const r=br(si(e)),n=Hr.scalarMult(r,t);ci(n);const{publicKey:i}=Hr.box.keyPair.fromSecretKey(r);return{ephemeralPublicKey:i,sharedSecret:n}}case Q.publicKey.x448:{const e=await N.getNobleCurve(Q.publicKey.x448),r=e.utils.randomPrivateKey(),n=e.getSharedSecret(r,t);return ci(n),{ephemeralPublicKey:e.getPublicKey(r),sharedSecret:n}}default:throw Error("Unsupported ECDH algorithm")}}async function oi(e,t,r,n){switch(e){case Q.publicKey.x25519:{const e=Hr.scalarMult(n,t);return ci(e),e}case Q.publicKey.x448:{const e=(await N.getNobleCurve(Q.publicKey.x448)).getSharedSecret(n,t);return ci(e),e}default:throw Error("Unsupported ECDH algorithm")}}function ci(e){let t=0;for(let r=0;r<e.length;r++)t|=e[r];if(0===t)throw Error("Unexpected low order point")}var ui=Object.freeze({__proto__:null,decrypt:async function(e,t,r,n,i){const s=await oi(e,t,0,i),a=N.concatUint8Array([t,n,s]);switch(e){case Q.publicKey.x25519:{const e=Q.symmetric.aes128,{keySize:t}=ae(e);return Xn(e,await ri(Q.hash.sha256,a,new Uint8Array,ni.x25519,t),r)}case Q.publicKey.x448:{const e=Q.symmetric.aes256,{keySize:t}=ae(Q.symmetric.aes256);return Xn(e,await ri(Q.hash.sha512,a,new Uint8Array,ni.x448,t),r)}default:throw Error("Unsupported ECDH algorithm")}},encrypt:async function(e,t,r){const{ephemeralPublicKey:n,sharedSecret:i}=await ai(e,r),s=N.concatUint8Array([n,r,i]);switch(e){case Q.publicKey.x25519:{const e=Q.symmetric.aes128,{keySize:r}=ae(e),i=await ri(Q.hash.sha256,s,new Uint8Array,ni.x25519,r);return{ephemeralPublicKey:n,wrappedKey:await Zn(e,i,t)}}case Q.publicKey.x448:{const e=Q.symmetric.aes256,{keySize:r}=ae(Q.symmetric.aes256),i=await ri(Q.hash.sha512,s,new Uint8Array,ni.x448,r);return{ephemeralPublicKey:n,wrappedKey:await Zn(e,i,t)}}default:throw Error("Unsupported ECDH algorithm")}},generate:ii,generateEphemeralEncryptionMaterial:ai,getPayloadSize:si,recomputeSharedSecret:oi,validateParams:async function(e,t,r){switch(e){case Q.publicKey.x25519:{const{publicKey:e}=Hr.box.keyPair.fromSecretKey(r);return N.equalsUint8Array(t,e)}case Q.publicKey.x448:{const e=(await N.getNobleCurve(Q.publicKey.x448)).getPublicKey(r);return N.equalsUint8Array(t,e)}default:return!1}}});const hi=N.getWebCrypto(),li=N.getNodeCrypto(),fi={[Q.curve.nistP256]:"P-256",[Q.curve.nistP384]:"P-384",[Q.curve.nistP521]:"P-521"},yi=li?li.getCurves():[],di=li?{[Q.curve.secp256k1]:yi.includes("secp256k1")?"secp256k1":void 0,[Q.curve.nistP256]:yi.includes("prime256v1")?"prime256v1":void 0,[Q.curve.nistP384]:yi.includes("secp384r1")?"secp384r1":void 0,[Q.curve.nistP521]:yi.includes("secp521r1")?"secp521r1":void 0,[Q.curve.ed25519Legacy]:yi.includes("ED25519")?"ED25519":void 0,[Q.curve.curve25519Legacy]:yi.includes("X25519")?"X25519":void 0,[Q.curve.brainpoolP256r1]:yi.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[Q.curve.brainpoolP384r1]:yi.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[Q.curve.brainpoolP512r1]:yi.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},pi={[Q.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha256,cipher:Q.symmetric.aes128,node:di[Q.curve.nistP256],web:fi[Q.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[Q.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha384,cipher:Q.symmetric.aes192,node:di[Q.curve.nistP384],web:fi[Q.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[Q.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha512,cipher:Q.symmetric.aes256,node:di[Q.curve.nistP521],web:fi[Q.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[Q.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha256,cipher:Q.symmetric.aes128,node:di[Q.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[Q.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:Q.publicKey.eddsaLegacy,hash:Q.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[Q.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:Q.publicKey.ecdh,hash:Q.hash.sha256,cipher:Q.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[Q.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha256,cipher:Q.symmetric.aes128,node:di[Q.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[Q.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha384,cipher:Q.symmetric.aes192,node:di[Q.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[Q.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:Q.publicKey.ecdsa,hash:Q.hash.sha512,cipher:Q.symmetric.aes256,node:di[Q.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class gi{constructor(e){try{this.name=e instanceof xn?e.getName():Q.write(Q.curve,e)}catch(e){throw new Nn("Unknown curve")}const t=pi[this.name];this.keyType=t.keyType,this.oid=t.oid,this.hash=t.hash,this.cipher=t.cipher,this.node=t.node,this.web=t.web,this.payloadSize=t.payloadSize,this.sharedSize=t.sharedSize,this.wireFormatLeadingByte=t.wireFormatLeadingByte,this.web&&N.getWebCrypto()?this.type="web":this.node&&N.getNodeCrypto()?this.type="node":this.name===Q.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===Q.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(e,t){const r=await hi.generateKey({name:"ECDSA",namedCurve:fi[e]},!0,["sign","verify"]),n=await hi.exportKey("jwk",r.privateKey);return{publicKey:bi(await hi.exportKey("jwk",r.publicKey),t),privateKey:q(n.d)}}(this.name,this.wireFormatLeadingByte)}catch(e){return N.printDebugError("Browser did not support generating ec key "+e.message),mi(this.name)}case"node":return async function(e){const t=li.createECDH(di[e]);return await t.generateKeys(),{publicKey:new Uint8Array(t.getPublicKey()),privateKey:new Uint8Array(t.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:e,A:t}=await ii(Q.publicKey.x25519),r=e.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:N.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:r}}case"ed25519Legacy":{const{seed:e,A:t}=await zn(Q.publicKey.ed25519);return{publicKey:N.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:e}}default:return mi(this.name)}}}async function Ai(e,t,r,n){const i={[Q.curve.nistP256]:!0,[Q.curve.nistP384]:!0,[Q.curve.nistP521]:!0,[Q.curve.secp256k1]:!0,[Q.curve.curve25519Legacy]:e===Q.publicKey.ecdh,[Q.curve.brainpoolP256r1]:!0,[Q.curve.brainpoolP384r1]:!0,[Q.curve.brainpoolP512r1]:!0},s=t.getName();if(!i[s])return!1;if(s===Q.curve.curve25519Legacy){n=n.slice().reverse();const{publicKey:e}=Hr.box.keyPair.fromSecretKey(n);r=new Uint8Array(r);const t=new Uint8Array([64,...e]);return!!N.equalsUint8Array(t,r)}const a=(await N.getNobleCurve(Q.publicKey.ecdsa,s)).getPublicKey(n,!1);return!!N.equalsUint8Array(a,r)}function wi(e,t){const{payloadSize:r,wireFormatLeadingByte:n,name:i}=e,s=i===Q.curve.curve25519Legacy||i===Q.curve.ed25519Legacy?r:2*r;if(t[0]!==n||t.length!==s+1)throw Error("Invalid point encoding")}async function mi(e){const t=await N.getNobleCurve(Q.publicKey.ecdsa,e),r=t.utils.randomPrivateKey();return{publicKey:t.getPublicKey(r,!1),privateKey:r}}function bi(e,t){const r=q(e.x),n=q(e.y),i=new Uint8Array(r.length+n.length+1);return i[0]=t,i.set(r,1),i.set(n,r.length+1),i}function Ei(e,t,r){const n=e,i=r.slice(1,n+1),s=r.slice(n+1,2*n+1);return{kty:"EC",crv:t,x:V(i),y:V(s),ext:!0}}function ki(e,t,r,n){const i=Ei(e,t,r);return i.d=V(n),i}const vi=N.getWebCrypto(),Bi=N.getNodeCrypto();async function Si(e,t,r,n,i,s){const a=new gi(e);if(wi(a,n),r&&!N.isStream(r)){const s={publicKey:n,privateKey:i};switch(a.type){case"web":try{return await async function(e,t,r,n){const i=e.payloadSize,s=ki(e.payloadSize,fi[e.name],n.publicKey,n.privateKey),a=await vi.importKey("jwk",s,{name:"ECDSA",namedCurve:fi[e.name],hash:{name:Q.read(Q.webHash,e.hash)}},!1,["sign"]),o=new Uint8Array(await vi.sign({name:"ECDSA",namedCurve:fi[e.name],hash:{name:Q.read(Q.webHash,t)}},a,r));return{r:o.slice(0,i),s:o.slice(i,i<<1)}}(a,t,r,s)}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;N.printDebugError("Browser did not support signing: "+e.message)}break;case"node":return async function(e,t,r,n){const i=N.nodeRequire("eckey-utils"),s=N.getNodeBuffer(),{privateKey:a}=i.generateDer({curveName:di[e.name],privateKey:s.from(n)}),o=Bi.createSign(Q.read(Q.hash,t));o.write(r),o.end();const c=new Uint8Array(o.sign({key:a,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),u=e.payloadSize;return{r:c.subarray(0,u),s:c.subarray(u,u<<1)}}(a,t,r,i)}}const o=(await N.getNobleCurve(Q.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:wr(o.r,"be",a.payloadSize),s:wr(o.s,"be",a.payloadSize)}}async function Ii(e,t,r,n,i,s){const a=new gi(e);wi(a,i);const o=async()=>0===s[0]&&Ci(a,r,s.subarray(1),i);if(n&&!N.isStream(n))switch(a.type){case"web":try{const e=await async function(e,t,{r,s:n},i,s){const a=Ei(e.payloadSize,fi[e.name],s),o=await vi.importKey("jwk",a,{name:"ECDSA",namedCurve:fi[e.name],hash:{name:Q.read(Q.webHash,e.hash)}},!1,["verify"]),c=N.concatUint8Array([r,n]).buffer;return vi.verify({name:"ECDSA",namedCurve:fi[e.name],hash:{name:Q.read(Q.webHash,t)}},o,c,i)}(a,t,r,n,i);return e||o()}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;N.printDebugError("Browser did not support verifying: "+e.message)}break;case"node":{const e=await async function(e,t,{r,s:n},i,s){const a=N.nodeRequire("eckey-utils"),o=N.getNodeBuffer(),{publicKey:c}=a.generateDer({curveName:di[e.name],publicKey:o.from(s)}),u=Bi.createVerify(Q.read(Q.hash,t));u.write(i),u.end();const h=N.concatUint8Array([r,n]);try{return u.verify({key:c,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},h)}catch(e){return!1}}(a,t,r,n,i);return e||o()}}return await Ci(a,r,s,i)||o()}async function Ci(e,t,r,n){return(await N.getNobleCurve(Q.publicKey.ecdsa,e.name)).verify(N.concatUint8Array([t.r,t.s]),r,n,{lowS:!1})}var Ki=Object.freeze({__proto__:null,sign:Si,validateParams:async function(e,t,r){const n=new gi(e);if(n.keyType!==Q.publicKey.ecdsa)return!1;switch(n.type){case"web":case"node":{const n=br(8),i=Q.hash.sha256,s=await ve.digest(i,n);try{const a=await Si(e,i,n,t,r,s);return await Ii(e,i,a,n,t,s)}catch(e){return!1}}default:return Ai(Q.publicKey.ecdsa,e,t,r)}},verify:Ii}),Pi=Object.freeze({__proto__:null,sign:async function(e,t,r,n,i,s){if(wi(new gi(e),n),ve.getHashByteLength(t)<ve.getHashByteLength(Q.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await jn(Q.publicKey.ed25519,t,0,n.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}},validateParams:async function(e,t,r){if(e.getName()!==Q.curve.ed25519Legacy)return!1;const{publicKey:n}=Hr.sign.keyPair.fromSeed(r),i=new Uint8Array([64,...n]);return N.equalsUint8Array(t,i)},verify:async function(e,t,{r,s:n},i,s,a){if(wi(new gi(e),s),ve.getHashByteLength(t)<ve.getHashByteLength(Q.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=N.concatUint8Array([r,n]);return Gn(Q.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}});function Ui(e){const t=8-e.length%8,r=new Uint8Array(e.length+t).fill(t);return r.set(e),r}function Di(e){const t=e.length;if(t>0){const r=e[t-1];if(r>=1){const n=e.subarray(t-r),i=new Uint8Array(r).fill(r);if(N.equalsUint8Array(n,i))return e.subarray(0,t-r)}}throw Error("Invalid padding")}var xi=Object.freeze({__proto__:null,decode:Di,encode:Ui});const Ri=N.getWebCrypto(),Ti=N.getNodeCrypto();function _i(e,t,r,n){return N.concatUint8Array([t.write(),new Uint8Array([e]),r.write(),N.stringToUint8Array("Anonymous Sender    "),n])}async function Li(e,t,r,n,i=!1,s=!1){let a;if(i){for(a=0;a<t.length&&0===t[a];a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&0===t[a];a--);t=t.subarray(0,a+1)}return(await ve.digest(e,N.concatUint8Array([new Uint8Array([0,0,0,1]),t,n]))).subarray(0,r)}async function Qi(e,t,r){return{secretKey:r,sharedKey:(await N.getNobleCurve(Q.publicKey.ecdh,e.name)).getSharedSecret(r,t).subarray(1)}}async function Oi(e,t){const r=await N.getNobleCurve(Q.publicKey.ecdh,e.name),{publicKey:n,privateKey:i}=await e.genKeyPair();return{publicKey:n,sharedKey:r.getSharedSecret(i,t).subarray(1)}}var Mi=Object.freeze({__proto__:null,decrypt:async function(e,t,r,n,i,s,a){const o=new gi(e);wi(o,i),wi(o,r);const{sharedKey:c}=await async function(e,t,r,n){if(n.length!==e.payloadSize){const t=new Uint8Array(e.payloadSize);t.set(n,e.payloadSize-n.length),n=t}switch(e.type){case"curve25519Legacy":{const e=n.slice().reverse();return{secretKey:e,sharedKey:await oi(Q.publicKey.x25519,t.subarray(1),r.subarray(1),e)}}case"web":if(e.web&&N.getWebCrypto())try{return await async function(e,t,r,n){const i=ki(e.payloadSize,e.web,r,n);let s=Ri.importKey("jwk",i,{name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]);const a=Ei(e.payloadSize,e.web,t);let o=Ri.importKey("jwk",a,{name:"ECDH",namedCurve:e.web},!0,[]);[s,o]=await Promise.all([s,o]);let c=Ri.deriveBits({name:"ECDH",namedCurve:e.web,public:o},s,e.sharedSize),u=Ri.exportKey("jwk",s);[c,u]=await Promise.all([c,u]);const h=new Uint8Array(c);return{secretKey:q(u.d),sharedKey:h}}(e,t,r,n)}catch(r){return N.printDebugError(r),Qi(e,t,n)}break;case"node":return async function(e,t,r){const n=Ti.createECDH(e.node);n.setPrivateKey(r);const i=new Uint8Array(n.computeSecret(t));return{secretKey:new Uint8Array(n.getPrivateKey()),sharedKey:i}}(e,t,n);default:return Qi(e,t,n)}}(o,r,i,s),u=_i(Q.publicKey.ecdh,e,t,a),{keySize:h}=ae(t.cipher);let l;for(let r=0;r<3;r++)try{const e=await Li(t.hash,c,h,u,1===r,2===r);return Di(await Xn(t.cipher,e,n))}catch(e){l=e}throw l},encrypt:async function(e,t,r,n,i){const s=Ui(r),a=new gi(e);wi(a,n);const{publicKey:o,sharedKey:c}=await async function(e,t){switch(e.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:n}=await ai(Q.publicKey.x25519,t.subarray(1));return{publicKey:N.concatUint8Array([new Uint8Array([e.wireFormatLeadingByte]),n]),sharedKey:r}}case"web":if(e.web&&N.getWebCrypto())try{return await async function(e,t){const r=Ei(e.payloadSize,e.web,t);let n=Ri.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),i=Ri.importKey("jwk",r,{name:"ECDH",namedCurve:e.web},!1,[]);[n,i]=await Promise.all([n,i]);let s=Ri.deriveBits({name:"ECDH",namedCurve:e.web,public:i},n.privateKey,e.sharedSize),a=Ri.exportKey("jwk",n.publicKey);[s,a]=await Promise.all([s,a]);const o=new Uint8Array(s);return{publicKey:new Uint8Array(bi(a,e.wireFormatLeadingByte)),sharedKey:o}}(e,t)}catch(r){return N.printDebugError(r),Oi(e,t)}break;case"node":return async function(e,t){const r=Ti.createECDH(e.node);r.generateKeys();const n=new Uint8Array(r.computeSecret(t));return{publicKey:new Uint8Array(r.getPublicKey()),sharedKey:n}}(e,t);default:return Oi(e,t)}}(a,n),u=_i(Q.publicKey.ecdh,e,t,i),{keySize:h}=ae(t.cipher),l=await Li(t.hash,c,h,u);return{publicKey:o,wrappedKey:await Zn(t.cipher,l,s)}},validateParams:async function(e,t,r){return Ai(Q.publicKey.ecdh,e,t,r)}}),Ni=Object.freeze({__proto__:null,CurveWithOID:gi,ecdh:Mi,ecdhX:ui,ecdsa:Ki,eddsa:$n,eddsaLegacy:Pi,generate:async function(e){const t=new gi(e),{oid:r,hash:n,cipher:i}=t,s=await t.genKeyPair();return{oid:r,Q:s.publicKey,secret:N.leftPad(s.privateKey,t.payloadSize),hash:n,cipher:i}},getPreferredHashAlgo:function(e){return pi[e.getName()].hash}});const Fi=BigInt(0),Hi=BigInt(1);var zi=Object.freeze({__proto__:null,sign:async function(e,t,r,n,i,s){const a=BigInt(0);let o,c,u,h;n=ur(n),i=ur(i),r=ur(r),s=ur(s),r=hr(r,n),s=hr(s,i);const l=hr(ur(t.subarray(0,Ar(i))),i);for(;;){if(o=Er(Hi,i),c=hr(lr(r,o,n),i),c===a)continue;const e=hr(s*c,i);if(h=hr(l+e,i),u=hr(yr(o,i)*h,i),u!==a)break}return{r:wr(c,"be",Ar(n)),s:wr(u,"be",Ar(n))}},validateParams:async function(e,t,r,n,i){if(e=ur(e),t=ur(t),r=ur(r),n=ur(n),r<=Hi||r>=e)return!1;if(hr(e-Hi,t)!==Fi)return!1;if(lr(r,t,e)!==Hi)return!1;const s=BigInt(gr(t));if(s<BigInt(150)||!Sr(t,null,32))return!1;i=ur(i);const a=BigInt(2);return n===lr(r,t*Er(a<<s-Hi,a<<s)+i,e)},verify:async function(e,t,r,n,i,s,a,o){if(t=ur(t),r=ur(r),s=ur(s),a=ur(a),i=ur(i),o=ur(o),t<=Fi||t>=a||r<=Fi||r>=a)return N.printDebug("invalid DSA Signature"),!1;const c=hr(ur(n.subarray(0,Ar(a))),a),u=yr(r,a);if(u===Fi)return N.printDebug("invalid DSA Signature"),!1;i=hr(i,s),o=hr(o,s);const h=hr(c*u,a),l=hr(t*u,a);return hr(hr(lr(i,h,s)*lr(o,l,s),s),a)===t}}),ji={rsa:Or,elgamal:Nr,elliptic:Ni,dsa:zi},Gi=Object.freeze({__proto__:null,parseSignatureParams:function(e,t){let r=0;switch(e){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaSign:{const e=N.readMPI(t.subarray(r));return r+=e.length+2,{read:r,signatureParams:{s:e}}}case Q.publicKey.dsa:case Q.publicKey.ecdsa:{const e=N.readMPI(t.subarray(r));r+=e.length+2;const n=N.readMPI(t.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:e,s:n}}}case Q.publicKey.eddsaLegacy:{const e=N.readMPI(t.subarray(r));r+=e.length+2;const n=N.readMPI(t.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:e,s:n}}}case Q.publicKey.ed25519:case Q.publicKey.ed448:{const n=2*ji.elliptic.eddsa.getPayloadSize(e),i=N.readExactSubarray(t,r,r+n);return r+=i.length,{read:r,signatureParams:{RS:i}}}default:throw new Nn("Unknown signature algorithm.")}},sign:async function(e,t,r,n,i,s){if(!r||!n)throw Error("Missing key parameters");switch(e){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaSign:{const{n:e,e:a}=r,{d:o,p:c,q:u,u:h}=n;return{s:await ji.rsa.sign(t,i,e,a,o,c,u,h,s)}}case Q.publicKey.dsa:{const{g:e,p:i,q:a}=r,{x:o}=n;return ji.dsa.sign(t,s,e,i,a,o)}case Q.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case Q.publicKey.ecdsa:{const{oid:e,Q:a}=r,{d:o}=n;return ji.elliptic.ecdsa.sign(e,t,i,a,o,s)}case Q.publicKey.eddsaLegacy:{const{oid:e,Q:a}=r,{seed:o}=n;return ji.elliptic.eddsaLegacy.sign(e,t,i,a,o,s)}case Q.publicKey.ed25519:case Q.publicKey.ed448:{const{A:a}=r,{seed:o}=n;return ji.elliptic.eddsa.sign(e,t,i,a,o,s)}default:throw Error("Unknown signature algorithm.")}},verify:async function(e,t,r,n,i,s){switch(e){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaSign:{const{n:e,e:a}=n,o=N.leftPad(r.s,e.length);return ji.rsa.verify(t,i,o,e,a,s)}case Q.publicKey.dsa:{const{g:e,p:i,q:a,y:o}=n,{r:c,s:u}=r;return ji.dsa.verify(t,c,u,s,e,i,a,o)}case Q.publicKey.ecdsa:{const{oid:e,Q:a}=n,o=new ji.elliptic.CurveWithOID(e).payloadSize,c=N.leftPad(r.r,o),u=N.leftPad(r.s,o);return ji.elliptic.ecdsa.verify(e,t,{r:c,s:u},i,a,s)}case Q.publicKey.eddsaLegacy:{const{oid:e,Q:a}=n,o=new ji.elliptic.CurveWithOID(e).payloadSize,c=N.leftPad(r.r,o),u=N.leftPad(r.s,o);return ji.elliptic.eddsaLegacy.verify(e,t,{r:c,s:u},i,a,s)}case Q.publicKey.ed25519:case Q.publicKey.ed448:{const{A:a}=n;return ji.elliptic.eddsa.verify(e,t,r,i,a,s)}default:throw Error("Unknown signature algorithm.")}}});class qi{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.data=e.subarray(1,1+t),1+this.data.length}throw Error("Invalid symmetric key")}write(){return N.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class Vi{constructor(e){if(e){const{hash:t,cipher:r}=e;this.hash=t,this.cipher=r}else this.hash=null,this.cipher=null}read(e){if(e.length<4||3!==e[0]||1!==e[1])throw new Nn("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class Ji{static fromObject({wrappedKey:e,algorithm:t}){const r=new Ji;return r.wrappedKey=e,r.algorithm=t,r}read(e){let t=0,r=e[t++];this.algorithm=r%2?e[t++]:null,r-=r%2,this.wrappedKey=N.readExactSubarray(e,t,t+r),t+=r}write(){return N.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}function Wi(e){try{e.getName()}catch(e){throw new Nn("Unknown curve OID")}}function $i(e,t){switch(e){case Q.publicKey.ecdsa:case Q.publicKey.ecdh:case Q.publicKey.eddsaLegacy:return new ji.elliptic.CurveWithOID(t).payloadSize;case Q.publicKey.ed25519:case Q.publicKey.ed448:return ji.elliptic.eddsa.getPayloadSize(e);case Q.publicKey.x25519:case Q.publicKey.x448:return ji.elliptic.ecdhX.getPayloadSize(e);default:throw Error("Unknown elliptic algo")}}var Yi=Object.freeze({__proto__:null,generateParams:function(e,t,r){switch(e){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:return ji.rsa.generate(t,65537).then((({n:e,e:t,d:r,p:n,q:i,u:s})=>({privateParams:{d:r,p:n,q:i,u:s},publicParams:{n:e,e:t}})));case Q.publicKey.ecdsa:return ji.elliptic.generate(r).then((({oid:e,Q:t,secret:r})=>({privateParams:{d:r},publicParams:{oid:new xn(e),Q:t}})));case Q.publicKey.eddsaLegacy:return ji.elliptic.generate(r).then((({oid:e,Q:t,secret:r})=>({privateParams:{seed:r},publicParams:{oid:new xn(e),Q:t}})));case Q.publicKey.ecdh:return ji.elliptic.generate(r).then((({oid:e,Q:t,secret:r,hash:n,cipher:i})=>({privateParams:{d:r},publicParams:{oid:new xn(e),Q:t,kdfParams:new Vi({hash:n,cipher:i})}})));case Q.publicKey.ed25519:case Q.publicKey.ed448:return ji.elliptic.eddsa.generate(e).then((({A:e,seed:t})=>({privateParams:{seed:t},publicParams:{A:e}})));case Q.publicKey.x25519:case Q.publicKey.x448:return ji.elliptic.ecdhX.generate(e).then((({A:e,k:t})=>({privateParams:{k:t},publicParams:{A:e}})));case Q.publicKey.dsa:case Q.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},generateSessionKey:function(e){const{keySize:t}=ae(e);return br(t)},getAEADMode:function(e){const t=Q.read(Q.aead,e);return ar[t]},getCipherParams:ae,getCurvePayloadSize:$i,getPreferredCurveHashAlgo:function(e,t){switch(e){case Q.publicKey.ecdsa:case Q.publicKey.eddsaLegacy:return ji.elliptic.getPreferredHashAlgo(t);case Q.publicKey.ed25519:case Q.publicKey.ed448:return ji.elliptic.eddsa.getPreferredHashAlgo(e);default:throw Error("Unknown elliptic signing algo")}},getPrefixRandom:async function(e){const{blockSize:t}=ae(e),r=await br(t),n=new Uint8Array([r[r.length-2],r[r.length-1]]);return N.concat([r,n])},parseEncSessionKeyParams:function(e,t){let r=0;switch(e){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:return{c:N.readMPI(t.subarray(r))};case Q.publicKey.elgamal:{const e=N.readMPI(t.subarray(r));return r+=e.length+2,{c1:e,c2:N.readMPI(t.subarray(r))}}case Q.publicKey.ecdh:{const e=N.readMPI(t.subarray(r));r+=e.length+2;const n=new qi;return n.read(t.subarray(r)),{V:e,C:n}}case Q.publicKey.x25519:case Q.publicKey.x448:{const n=$i(e),i=N.readExactSubarray(t,r,r+n);r+=i.length;const s=new Ji;return s.read(t.subarray(r)),{ephemeralPublicKey:i,C:s}}default:throw new Nn("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(e,t,r){let n=0;switch(e){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:{const e=N.readMPI(t.subarray(n));n+=e.length+2;const r=N.readMPI(t.subarray(n));n+=r.length+2;const i=N.readMPI(t.subarray(n));n+=i.length+2;const s=N.readMPI(t.subarray(n));return n+=s.length+2,{read:n,privateParams:{d:e,p:r,q:i,u:s}}}case Q.publicKey.dsa:case Q.publicKey.elgamal:{const e=N.readMPI(t.subarray(n));return n+=e.length+2,{read:n,privateParams:{x:e}}}case Q.publicKey.ecdsa:case Q.publicKey.ecdh:{const i=$i(e,r.oid);let s=N.readMPI(t.subarray(n));return n+=s.length+2,s=N.leftPad(s,i),{read:n,privateParams:{d:s}}}case Q.publicKey.eddsaLegacy:{const i=$i(e,r.oid);if(r.oid.getName()!==Q.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=N.readMPI(t.subarray(n));return n+=s.length+2,s=N.leftPad(s,i),{read:n,privateParams:{seed:s}}}case Q.publicKey.ed25519:case Q.publicKey.ed448:{const r=$i(e),i=N.readExactSubarray(t,n,n+r);return n+=i.length,{read:n,privateParams:{seed:i}}}case Q.publicKey.x25519:case Q.publicKey.x448:{const r=$i(e),i=N.readExactSubarray(t,n,n+r);return n+=i.length,{read:n,privateParams:{k:i}}}default:throw new Nn("Unknown public key encryption algorithm.")}},parsePublicKeyParams:function(e,t){let r=0;switch(e){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:{const e=N.readMPI(t.subarray(r));r+=e.length+2;const n=N.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{n:e,e:n}}}case Q.publicKey.dsa:{const e=N.readMPI(t.subarray(r));r+=e.length+2;const n=N.readMPI(t.subarray(r));r+=n.length+2;const i=N.readMPI(t.subarray(r));r+=i.length+2;const s=N.readMPI(t.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:e,q:n,g:i,y:s}}}case Q.publicKey.elgamal:{const e=N.readMPI(t.subarray(r));r+=e.length+2;const n=N.readMPI(t.subarray(r));r+=n.length+2;const i=N.readMPI(t.subarray(r));return r+=i.length+2,{read:r,publicParams:{p:e,g:n,y:i}}}case Q.publicKey.ecdsa:{const e=new xn;r+=e.read(t),Wi(e);const n=N.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{oid:e,Q:n}}}case Q.publicKey.eddsaLegacy:{const e=new xn;if(r+=e.read(t),Wi(e),e.getName()!==Q.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let n=N.readMPI(t.subarray(r));return r+=n.length+2,n=N.leftPad(n,33),{read:r,publicParams:{oid:e,Q:n}}}case Q.publicKey.ecdh:{const e=new xn;r+=e.read(t),Wi(e);const n=N.readMPI(t.subarray(r));r+=n.length+2;const i=new Vi;return r+=i.read(t.subarray(r)),{read:r,publicParams:{oid:e,Q:n,kdfParams:i}}}case Q.publicKey.ed25519:case Q.publicKey.ed448:case Q.publicKey.x25519:case Q.publicKey.x448:{const n=N.readExactSubarray(t,r,r+$i(e));return r+=n.length,{read:r,publicParams:{A:n}}}default:throw new Nn("Unknown public key encryption algorithm.")}},publicKeyDecrypt:async function(e,t,r,n,i,s){switch(e){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaEncrypt:{const{c:e}=n,{n:i,e:a}=t,{d:o,p:c,q:u,u:h}=r;return ji.rsa.decrypt(e,i,a,o,c,u,h,s)}case Q.publicKey.elgamal:{const{c1:e,c2:i}=n,a=t.p,o=r.x;return ji.elgamal.decrypt(e,i,a,o,s)}case Q.publicKey.ecdh:{const{oid:e,Q:s,kdfParams:a}=t,{d:o}=r,{V:c,C:u}=n;return ji.elliptic.ecdh.decrypt(e,a,c,u.data,s,o,i)}case Q.publicKey.x25519:case Q.publicKey.x448:{const{A:i}=t,{k:s}=r,{ephemeralPublicKey:a,C:o}=n;if(null!==o.algorithm&&!N.isAES(o.algorithm))throw Error("AES session key expected");return ji.elliptic.ecdhX.decrypt(e,a,o.wrappedKey,i,s)}default:throw Error("Unknown public key encryption algorithm.")}},publicKeyEncrypt:async function(e,t,r,n,i){switch(e){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:{const{n:e,e:t}=r;return{c:await ji.rsa.encrypt(n,e,t)}}case Q.publicKey.elgamal:{const{p:e,g:t,y:i}=r;return ji.elgamal.encrypt(n,e,t,i)}case Q.publicKey.ecdh:{const{oid:e,Q:t,kdfParams:s}=r,{publicKey:a,wrappedKey:o}=await ji.elliptic.ecdh.encrypt(e,s,n,t,i);return{V:a,C:new qi(o)}}case Q.publicKey.x25519:case Q.publicKey.x448:{if(t&&!N.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:i}=r,{ephemeralPublicKey:s,wrappedKey:a}=await ji.elliptic.ecdhX.encrypt(e,n,i);return{ephemeralPublicKey:s,C:Ji.fromObject({algorithm:t,wrappedKey:a})}}default:return[]}},serializeParams:function(e,t){const r=new Set([Q.publicKey.ed25519,Q.publicKey.x25519,Q.publicKey.ed448,Q.publicKey.x448]),n=Object.keys(t).map((n=>{const i=t[n];return N.isUint8Array(i)?r.has(e)?i:N.uint8ArrayToMPI(i):i.write()}));return N.concatUint8Array(n)},validateParams:async function(e,t,r){if(!t||!r)throw Error("Missing key parameters");switch(e){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:{const{n:e,e:n}=t,{d:i,p:s,q:a,u:o}=r;return ji.rsa.validateParams(e,n,i,s,a,o)}case Q.publicKey.dsa:{const{p:e,q:n,g:i,y:s}=t,{x:a}=r;return ji.dsa.validateParams(e,n,i,s,a)}case Q.publicKey.elgamal:{const{p:e,g:n,y:i}=t,{x:s}=r;return ji.elgamal.validateParams(e,n,i,s)}case Q.publicKey.ecdsa:case Q.publicKey.ecdh:{const n=ji.elliptic[Q.read(Q.publicKey,e)],{oid:i,Q:s}=t,{d:a}=r;return n.validateParams(i,s,a)}case Q.publicKey.eddsaLegacy:{const{Q:e,oid:n}=t,{seed:i}=r;return ji.elliptic.eddsaLegacy.validateParams(n,e,i)}case Q.publicKey.ed25519:case Q.publicKey.ed448:{const{A:n}=t,{seed:i}=r;return ji.elliptic.eddsa.validateParams(e,n,i)}case Q.publicKey.x25519:case Q.publicKey.x448:{const{A:n}=t,{k:i}=r;return ji.elliptic.ecdhX.validateParams(e,n,i)}default:throw Error("Unknown public key algorithm.")}}});const Zi={cipher:oe,hash:ve,mode:ar,publicKey:ji,signature:Gi,random:kr,pkcs1:Dr,pkcs5:xi,aesKW:ei};Object.assign(Zi,Yi);class Xi extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Xi),this.name="Argon2OutOfMemoryError"}}let es,ts;class rs{constructor(e=O){const{passes:t,parallelism:r,memoryExponent:n}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=t,this.p=r,this.encodedM=n}generateSalt(){this.salt=Zi.random.getRandomBytes(16)}read(e){let t=0;return this.salt=e.subarray(t,t+16),t+=16,this.t=e[t++],this.p=e[t++],this.encodedM=e[t++],t}write(){const e=[new Uint8Array([Q.write(Q.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return N.concatUint8Array(e)}async produceKey(e,t){const r=2<<this.encodedM-1;try{es=es||(await Promise.resolve().then((function(){return af}))).default,ts=ts||es();const n=(await ts)({version:19,type:2,password:N.encodeUTF8(e),salt:this.salt,tagLength:t,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(ts=es(),ts.catch((()=>{}))),n}catch(e){throw e.message&&(e.message.includes("Unable to grow instance memory")||e.message.includes("failed to grow memory")||e.message.includes("WebAssembly.Memory.grow")||e.message.includes("Out of memory"))?new Xi("Could not allocate required memory for Argon2"):e}}}class ns{constructor(e,t=O){this.algorithm=Q.hash.sha256,this.type=Q.read(Q.s2k,e),this.c=t.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=Zi.random.getRandomBytes(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let t=0;switch(this.algorithm=e[t++],this.type){case"simple":break;case"salted":this.salt=e.subarray(t,t+8),t+=8;break;case"iterated":this.salt=e.subarray(t,t+8),t+=8,this.c=e[t++];break;case"gnu":if("GNU"!==N.uint8ArrayToString(e.subarray(t,t+3)))throw new Nn("Unknown s2k type.");if(t+=3,1001!==1e3+e[t++])throw new Nn("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new Nn("Unknown s2k type.")}return t}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...N.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([Q.write(Q.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return N.concatUint8Array(e)}async produceKey(e,t){e=N.encodeUTF8(e);const r=[];let n=0,i=0;for(;n<t;){let t;switch(this.type){case"simple":t=N.concatUint8Array([new Uint8Array(i),e]);break;case"salted":t=N.concatUint8Array([new Uint8Array(i),this.salt,e]);break;case"iterated":{const r=N.concatUint8Array([this.salt,e]);let n=r.length;const s=Math.max(this.getCount(),n);t=new Uint8Array(i+s),t.set(r,i);for(let e=i+n;e<s;e+=n,n*=2)t.copyWithin(e,i,e);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const s=await Zi.hash.digest(this.algorithm,t);r.push(s),n+=s.length,i++}return N.concatUint8Array(r).subarray(0,t)}}const is=new Set([Q.s2k.argon2,Q.s2k.iterated]);function ss(e,t=O){switch(e){case Q.s2k.argon2:return new rs(t);case Q.s2k.iterated:case Q.s2k.gnu:case Q.s2k.salted:case Q.s2k.simple:return new ns(e,t);default:throw new Nn("Unsupported S2K type")}}function as(e){const{s2kType:t}=e;if(!is.has(t))throw Error("The provided `config.s2kType` value is not allowed");return ss(t,e)}var os=Uint8Array,cs=Uint16Array,us=Uint32Array,hs=new os([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ls=new os([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fs=new os([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ys=function(e,t){for(var r=new cs(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new us(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},ds=ys(hs,2),ps=ds[0],gs=ds[1];ps[28]=258,gs[258]=28;for(var As=ys(ls,0),ws=As[0],ms=As[1],bs=new cs(32768),Es=0;Es<32768;++Es){var ks=(43690&Es)>>>1|(21845&Es)<<1;ks=(61680&(ks=(52428&ks)>>>2|(13107&ks)<<2))>>>4|(3855&ks)<<4,bs[Es]=((65280&ks)>>>8|(255&ks)<<8)>>>1}var vs=function(e,t,r){for(var n=e.length,i=0,s=new cs(t);i<n;++i)e[i]&&++s[e[i]-1];var a,o=new cs(t);for(i=0;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(r){a=new cs(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],h=t-e[i],l=o[e[i]-1]++<<h,f=l|(1<<h)-1;l<=f;++l)a[bs[l]>>>c]=u}else for(a=new cs(n),i=0;i<n;++i)e[i]&&(a[i]=bs[o[e[i]-1]++]>>>15-e[i]);return a},Bs=new os(288);for(Es=0;Es<144;++Es)Bs[Es]=8;for(Es=144;Es<256;++Es)Bs[Es]=9;for(Es=256;Es<280;++Es)Bs[Es]=7;for(Es=280;Es<288;++Es)Bs[Es]=8;var Ss=new os(32);for(Es=0;Es<32;++Es)Ss[Es]=5;var Is=vs(Bs,9,0),Cs=vs(Bs,9,1),Ks=vs(Ss,5,0),Ps=vs(Ss,5,1),Us=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Ds=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},xs=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},Rs=function(e){return(e+7)/8|0},Ts=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(2==e.BYTES_PER_ELEMENT?cs:4==e.BYTES_PER_ELEMENT?us:os)(r-t);return n.set(e.subarray(t,r)),n},_s=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ls=function(e,t,r){var n=Error(t||_s[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Ls),!r)throw n;return n},Qs=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},Os=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},Ms=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return[qs,0];if(1==i){var a=new os(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,h=1,l=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=i-1;)o=r[r[u].f<r[l].f?u++:l++],c=r[u!=h&&r[u].f<r[l].f?u++:l++],r[h++]={s:-1,f:o.f+c.f,l:o,r:c};var f=s[0].s;for(n=1;n<i;++n)s[n].s>f&&(f=s[n].s);var y=new cs(f+1),d=Ns(r[h-1],y,0);if(d>t){n=0;var p=0,g=d-t,A=1<<g;for(s.sort((function(e,t){return y[t.s]-y[e.s]||e.f-t.f}));n<i;++n){var w=s[n].s;if(!(y[w]>t))break;p+=A-(1<<d-y[w]),y[w]=t}for(p>>>=g;p>0;){var m=s[n].s;y[m]<t?p-=1<<t-y[m]++-1:++n}for(;n>=0&&p;--n){var b=s[n].s;y[b]==t&&(--y[b],++p)}d=t}return[new os(y),d]},Ns=function(e,t,r){return-1==e.s?Math.max(Ns(e.l,t,r+1),Ns(e.r,t,r+1)):t[e.s]=r},Fs=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new cs(++t),n=0,i=e[0],s=1,a=function(e){r[n++]=e},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return[r.subarray(0,n),t]},Hs=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},zs=function(e,t,r){var n=r.length,i=Rs(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<n;++s)e[i+s+4]=r[s];return 8*(i+4+n)},js=function(e,t,r,n,i,s,a,o,c,u,h){Qs(t,h++,r),++i[256];for(var l=Ms(i,15),f=l[0],y=l[1],d=Ms(s,15),p=d[0],g=d[1],A=Fs(f),w=A[0],m=A[1],b=Fs(p),E=b[0],k=b[1],v=new cs(19),B=0;B<w.length;++B)v[31&w[B]]++;for(B=0;B<E.length;++B)v[31&E[B]]++;for(var S=Ms(v,7),I=S[0],C=S[1],K=19;K>4&&!I[fs[K-1]];--K);var P,U,D,x,R=u+5<<3,T=Hs(i,Bs)+Hs(s,Ss)+a,_=Hs(i,f)+Hs(s,p)+a+14+3*K+Hs(v,I)+(2*v[16]+3*v[17]+7*v[18]);if(R<=T&&R<=_)return zs(t,h,e.subarray(c,c+u));if(Qs(t,h,1+(_<T)),h+=2,_<T){P=vs(f,y,0),U=f,D=vs(p,g,0),x=p;var L=vs(I,C,0);for(Qs(t,h,m-257),Qs(t,h+5,k-1),Qs(t,h+10,K-4),h+=14,B=0;B<K;++B)Qs(t,h+3*B,I[fs[B]]);h+=3*K;for(var Q=[w,E],O=0;O<2;++O){var M=Q[O];for(B=0;B<M.length;++B){var N=31&M[B];Qs(t,h,L[N]),h+=I[N],N>15&&(Qs(t,h,M[B]>>>5&127),h+=M[B]>>>12)}}}else P=Is,U=Bs,D=Ks,x=Ss;for(B=0;B<o;++B)if(n[B]>255){N=n[B]>>>18&31,Os(t,h,P[N+257]),h+=U[N+257],N>7&&(Qs(t,h,n[B]>>>23&31),h+=hs[N]);var F=31&n[B];Os(t,h,D[F]),h+=x[F],F>3&&(Os(t,h,n[B]>>>5&8191),h+=ls[F])}else Os(t,h,P[n[B]]),h+=U[n[B]];return Os(t,h,P[256]),h+U[256]},Gs=new us([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),qs=new os(0),Vs=function(e,t,r,n,i){return function(e,t,r,n,i,s){var a=e.length,o=new os(n+a+5*(1+Math.ceil(a/7e3))+i),c=o.subarray(n,o.length-i),u=0;if(!t||a<8)for(var h=0;h<=a;h+=65535){var l=h+65535;l>=a&&(c[u>>3]=s),u=zs(c,u+1,e.subarray(h,l))}else{for(var f=Gs[t-1],y=f>>>13,d=8191&f,p=(1<<r)-1,g=new cs(32768),A=new cs(p+1),w=Math.ceil(r/3),m=2*w,b=function(t){return(e[t]^e[t+1]<<w^e[t+2]<<m)&p},E=new us(25e3),k=new cs(288),v=new cs(32),B=0,S=0,I=(h=0,0),C=0,K=0;h<a;++h){var P=b(h),U=32767&h,D=A[P];if(g[U]=D,A[P]=U,C<=h){var x=a-h;if((B>7e3||I>24576)&&x>423){u=js(e,c,0,E,k,v,S,I,K,h-K,u),I=B=S=0,K=h;for(var R=0;R<286;++R)k[R]=0;for(R=0;R<30;++R)v[R]=0}var T=2,_=0,L=d,Q=U-D&32767;if(x>2&&P==b(h-Q))for(var O=Math.min(y,x)-1,M=Math.min(32767,h),N=Math.min(258,x);Q<=M&&--L&&U!=D;){if(e[h+T]==e[h+T-Q]){for(var F=0;F<N&&e[h+F]==e[h+F-Q];++F);if(F>T){if(T=F,_=Q,F>O)break;var H=Math.min(Q,F-2),z=0;for(R=0;R<H;++R){var j=h-Q+R+32768&32767,G=j-g[j]+32768&32767;G>z&&(z=G,D=j)}}}Q+=(U=D)-(D=g[U])+32768&32767}if(_){E[I++]=268435456|gs[T]<<18|ms[_];var q=31&gs[T],V=31&ms[_];S+=hs[q]+ls[V],++k[257+q],++v[V],C=h+T,++B}else E[I++]=e[h],++k[e[h]]}}u=js(e,c,s,E,k,v,S,I,K,h-K,u),!s&&7&u&&(u=zs(c,u+1,qs))}return Ts(o,0,n+Rs(u)+i)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,r,n,!i)},Js=function(){function e(e,t){t||"function"!=typeof e||(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(Vs(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){this.ondata||Ls(5),this.d&&Ls(4),this.d=t,this.p(e,t||!1)},e}(),Ws=function(){function e(e){this.s={},this.p=new os(0),this.ondata=e}return e.prototype.e=function(e){this.ondata||Ls(5),this.d&&Ls(4);var t=this.p.length,r=new os(t+e.length);r.set(this.p),r.set(e,t),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=function(e,t,r){var n=e.length;if(!n||r&&r.f&&!r.l)return t||new os(0);var i=!t||r,s=!r||r.i;r||(r={}),t||(t=new os(3*n));var a=function(e){var r=t.length;if(e>r){var n=new os(Math.max(2*r,e));n.set(t),t=n}},o=r.f||0,c=r.p||0,u=r.b||0,h=r.l,l=r.d,f=r.m,y=r.n,d=8*n;do{if(!h){o=Ds(e,c,1);var p=Ds(e,c+1,3);if(c+=3,!p){var g=e[(C=Rs(c)+4)-4]|e[C-3]<<8,A=C+g;if(A>n){s&&Ls(0);break}i&&a(u+g),t.set(e.subarray(C,A),u),r.b=u+=g,r.p=c=8*A,r.f=o;continue}if(1==p)h=Cs,l=Ps,f=9,y=5;else if(2==p){var w=Ds(e,c,31)+257,m=Ds(e,c+10,15)+4,b=w+Ds(e,c+5,31)+1;c+=14;for(var E=new os(b),k=new os(19),v=0;v<m;++v)k[fs[v]]=Ds(e,c+3*v,7);c+=3*m;var B=Us(k),S=(1<<B)-1,I=vs(k,B,1);for(v=0;v<b;){var C,K=I[Ds(e,c,S)];if(c+=15&K,(C=K>>>4)<16)E[v++]=C;else{var P=0,U=0;for(16==C?(U=3+Ds(e,c,3),c+=2,P=E[v-1]):17==C?(U=3+Ds(e,c,7),c+=3):18==C&&(U=11+Ds(e,c,127),c+=7);U--;)E[v++]=P}}var D=E.subarray(0,w),x=E.subarray(w);f=Us(D),y=Us(x),h=vs(D,f,1),l=vs(x,y,1)}else Ls(1);if(c>d){s&&Ls(0);break}}i&&a(u+131072);for(var R=(1<<f)-1,T=(1<<y)-1,_=c;;_=c){var L=(P=h[xs(e,c)&R])>>>4;if((c+=15&P)>d){s&&Ls(0);break}if(P||Ls(2),L<256)t[u++]=L;else{if(256==L){_=c,h=null;break}var Q=L-254;if(L>264){var O=hs[v=L-257];Q=Ds(e,c,(1<<O)-1)+ps[v],c+=O}var M=l[xs(e,c)&T],N=M>>>4;if(M||Ls(3),c+=15&M,x=ws[N],N>3&&(O=ls[N],x+=xs(e,c)&(1<<O)-1,c+=O),c>d){s&&Ls(0);break}i&&a(u+131072);for(var F=u+Q;u<F;u+=4)t[u]=t[u-x],t[u+1]=t[u+1-x],t[u+2]=t[u+2-x],t[u+3]=t[u+3-x];u=F}}r.l=h,r.p=_,r.b=u,r.f=o,h&&(o=1,r.m=f,r.d=l,r.n=y)}while(!o);return u==t.length?t:Ts(t,0,u)}(this.p,this.o,this.s);this.ondata(Ts(r,t,this.s.b),this.d),this.o=Ts(r,this.s.b-32768),this.s.b=this.o.length,this.p=Ts(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),$s=function(){function e(e,t){var r,n;this.c=(r=1,n=0,{p:function(e){for(var t=r,i=n,s=0|e.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=t+=e[a];t=(65535&t)+15*(t>>16),i=(65535&i)+15*(i>>16)}r=t,n=i},d:function(){return(255&(r%=65521))<<24|r>>>8<<16|(255&(n%=65521))<<8|n>>>8}}),this.v=1,Js.call(this,e,t)}return e.prototype.push=function(e,t){Js.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var r=Vs(e,this.o,this.v&&2,t&&4,!t);this.v&&(function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)}(r,this.o),this.v=0),t&&function(e,t,r){for(;r;++t)e[t]=r,r>>>=8}(r,r.length-4,this.c.d()),this.ondata(r,t)},e}(),Ys=function(){function e(e){this.v=1,Ws.call(this,e)}return e.prototype.push=function(e,t){if(Ws.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}t&&(this.p.length<4&&Ls(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Ws.prototype.c.call(this,t)},e}(),Zs="undefined"!=typeof TextDecoder&&new TextDecoder;try{Zs.decode(qs,{stream:!0})}catch(n){}class Xs{static get tag(){return Q.packet.literalData}constructor(e=new Date){this.format=Q.literal.utf8,this.date=N.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,t=Q.literal.utf8){this.format=t,this.text=e,this.data=null}getText(e=!1){return(null===this.text||N.isStream(this.text))&&(this.text=N.decodeUTF8(N.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,t){this.format=t,this.data=e,this.text=null}getBytes(e=!1){return null===this.data&&(this.data=N.canonicalizeEOL(N.encodeUTF8(this.text))),e?K(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}async read(e){await I(e,(async e=>{const t=await e.readByte(),r=await e.readByte();this.filename=N.decodeUTF8(await e.readBytes(r)),this.date=N.readDate(await e.readBytes(4));let n=e.remainder();h(n)&&(n=await D(n)),this.setBytes(n,t)}))}writeHeader(){const e=N.encodeUTF8(this.filename),t=new Uint8Array([e.length]),r=new Uint8Array([this.format]),n=N.writeDate(this.date);return N.concatUint8Array([r,t,e,n])}write(){const e=this.writeHeader(),t=this.getBytes();return N.concat([e,t])}}class ea{constructor(){this.bytes=""}read(e){return this.bytes=N.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return N.stringToUint8Array(this.bytes)}toHex(){return N.uint8ArrayToHex(N.stringToUint8Array(this.bytes))}equals(e,t=!1){return t&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const t=new ea;return t.read(N.hexToUint8Array(e)),t}static wildcard(){const e=new ea;return e.read(new Uint8Array(8)),e}}const ta=Symbol("verified"),ra="salt@notations.openpgpjs.org",na=new Set([Q.signatureSubpacket.issuerKeyID,Q.signatureSubpacket.issuerFingerprint,Q.signatureSubpacket.embeddedSignature]);class ia{static get tag(){return Q.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new ea,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[ta]=null}read(e,t=O){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new Nn("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4!==this.version&&5!==this.version&&6!==this.version)throw new Nn(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[r++],this.publicKeyAlgorithm=e[r++],this.hashAlgorithm=e[r++],r+=this.readSubPackets(e.subarray(r,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,r),r+=this.readSubPackets(e.subarray(r,e.length),!1),this.signedHashValue=e.subarray(r,r+2),r+=2,6===this.version){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t}const n=e.subarray(r,e.length),{read:i,signatureParams:s}=Zi.signature.parseSignatureParams(this.publicKeyAlgorithm,n);if(i<n.length)throw Error("Error reading MPIs");this.params=s}writeParams(){return this.params instanceof Promise?R((async()=>Zi.serializeParams(this.publicKeyAlgorithm,await this.params))):Zi.serializeParams(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),6===this.version&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),N.concat(e)}async sign(e,t,r=new Date,n=!1,i){this.version=e.version,this.created=N.normalizeDate(r),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const s=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(6===this.version){const e=aa(this.hashAlgorithm);if(null===this.salt)this.salt=Zi.random.getRandomBytes(e);else if(e!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(i.nonDeterministicSignaturesViaNotation){if(0!==this.rawNotations.filter((({name:e})=>e===ra)).length)throw Error("Unexpected existing salt notation");{const e=Zi.random.getRandomBytes(aa(this.hashAlgorithm));this.rawNotations.push({name:ra,value:e,humanReadable:!1,critical:!1})}}s.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=N.concat(s);const a=this.toHash(this.signatureType,t,n),o=await this.hash(this.signatureType,t,a,n);this.signedHashValue=U(C(o),0,2);const c=async()=>Zi.signature.sign(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,a,await D(o));N.isStream(o)?this.params=c():(this.params=await c(),this[ta]=!0)}writeHashedSubPackets(){const e=Q.signatureSubpacket,t=[];let r;if(null===this.created)throw Error("Missing signature creation time");t.push(sa(e.signatureCreationTime,!0,N.writeDate(this.created))),null!==this.signatureExpirationTime&&t.push(sa(e.signatureExpirationTime,!0,N.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&t.push(sa(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),null!==this.trustLevel&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),t.push(sa(e.trustSignature,!0,r))),null!==this.regularExpression&&t.push(sa(e.regularExpression,!0,this.regularExpression)),null!==this.revocable&&t.push(sa(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),null!==this.keyExpirationTime&&t.push(sa(e.keyExpirationTime,!0,N.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.preferredSymmetricAlgorithms)),t.push(sa(e.preferredSymmetricAlgorithms,!1,r))),null!==this.revocationKeyClass&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=N.concat([r,this.revocationKeyFingerprint]),t.push(sa(e.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&t.push(sa(e.issuerKeyID,!0,this.issuerKeyID.write())),this.rawNotations.forEach((({name:n,value:i,humanReadable:s,critical:a})=>{r=[new Uint8Array([s?128:0,0,0,0])];const o=N.encodeUTF8(n);r.push(N.writeNumber(o.length,2)),r.push(N.writeNumber(i.length,2)),r.push(o),r.push(i),r=N.concat(r),t.push(sa(e.notationData,a,r))})),null!==this.preferredHashAlgorithms&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.preferredHashAlgorithms)),t.push(sa(e.preferredHashAlgorithms,!1,r))),null!==this.preferredCompressionAlgorithms&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.preferredCompressionAlgorithms)),t.push(sa(e.preferredCompressionAlgorithms,!1,r))),null!==this.keyServerPreferences&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.keyServerPreferences)),t.push(sa(e.keyServerPreferences,!1,r))),null!==this.preferredKeyServer&&t.push(sa(e.preferredKeyServer,!1,N.encodeUTF8(this.preferredKeyServer))),null!==this.isPrimaryUserID&&t.push(sa(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),null!==this.policyURI&&t.push(sa(e.policyURI,!1,N.encodeUTF8(this.policyURI))),null!==this.keyFlags&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.keyFlags)),t.push(sa(e.keyFlags,!0,r))),null!==this.signersUserID&&t.push(sa(e.signersUserID,!1,N.encodeUTF8(this.signersUserID))),null!==this.reasonForRevocationFlag&&(r=N.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),t.push(sa(e.reasonForRevocation,!0,r))),null!==this.features&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.features)),t.push(sa(e.features,!1,r))),null!==this.signatureTargetPublicKeyAlgorithm&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(N.stringToUint8Array(this.signatureTargetHash)),r=N.concat(r),t.push(sa(e.signatureTarget,!0,r))),null!==this.embeddedSignature&&t.push(sa(e.embeddedSignature,!0,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=N.concat(r),t.push(sa(e.issuerFingerprint,this.version>=5,r))),null!==this.preferredAEADAlgorithms&&(r=N.stringToUint8Array(N.uint8ArrayToString(this.preferredAEADAlgorithms)),t.push(sa(e.preferredAEADAlgorithms,!1,r))),null!==this.preferredCipherSuites&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),t.push(sa(e.preferredCipherSuites,!1,r)));const n=N.concat(t),i=N.writeNumber(n.length,6===this.version?4:2);return N.concat([i,n])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map((({type:e,critical:t,body:r})=>sa(e,t,r))),t=N.concat(e),r=N.writeNumber(t.length,6===this.version?4:2);return N.concat([r,t])}readSubPacket(e,t=!0){let r=0;const n=!!(128&e[r]),i=127&e[r];if(r++,t||(this.unhashedSubpackets.push({type:i,critical:n,body:e.subarray(r,e.length)}),na.has(i)))switch(i){case Q.signatureSubpacket.signatureCreationTime:this.created=N.readDate(e.subarray(r,e.length));break;case Q.signatureSubpacket.signatureExpirationTime:{const t=N.readNumber(e.subarray(r,e.length));this.signatureNeverExpires=0===t,this.signatureExpirationTime=t;break}case Q.signatureSubpacket.exportableCertification:this.exportable=1===e[r++];break;case Q.signatureSubpacket.trustSignature:this.trustLevel=e[r++],this.trustAmount=e[r++];break;case Q.signatureSubpacket.regularExpression:this.regularExpression=e[r];break;case Q.signatureSubpacket.revocable:this.revocable=1===e[r++];break;case Q.signatureSubpacket.keyExpirationTime:{const t=N.readNumber(e.subarray(r,e.length));this.keyExpirationTime=t,this.keyNeverExpires=0===t;break}case Q.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.revocationKey:this.revocationKeyClass=e[r++],this.revocationKeyAlgorithm=e[r++],this.revocationKeyFingerprint=e.subarray(r,r+20);break;case Q.signatureSubpacket.issuerKeyID:if(4===this.version)this.issuerKeyID.read(e.subarray(r,e.length));else if(t)throw Error("Unexpected Issuer Key ID subpacket");break;case Q.signatureSubpacket.notationData:{const t=!!(128&e[r]);r+=4;const i=N.readNumber(e.subarray(r,r+2));r+=2;const s=N.readNumber(e.subarray(r,r+2));r+=2;const a=N.decodeUTF8(e.subarray(r,r+i)),o=e.subarray(r+i,r+i+s);this.rawNotations.push({name:a,humanReadable:t,value:o,critical:n}),t&&(this.notations[a]=N.decodeUTF8(o));break}case Q.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=N.decodeUTF8(e.subarray(r,e.length));break;case Q.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==e[r++];break;case Q.signatureSubpacket.policyURI:this.policyURI=N.decodeUTF8(e.subarray(r,e.length));break;case Q.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.signersUserID:this.signersUserID=N.decodeUTF8(e.subarray(r,e.length));break;case Q.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[r++],this.reasonForRevocationString=N.decodeUTF8(e.subarray(r,e.length));break;case Q.signatureSubpacket.features:this.features=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[r++],this.signatureTargetHashAlgorithm=e[r++];const t=Zi.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=N.uint8ArrayToString(e.subarray(r,r+t));break}case Q.signatureSubpacket.embeddedSignature:this.embeddedSignature=new ia,this.embeddedSignature.read(e.subarray(r,e.length));break;case Q.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[r++],this.issuerFingerprint=e.subarray(r,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case Q.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(r,e.length)];break;case Q.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let t=r;t<e.length;t+=2)this.preferredCipherSuites.push([e[t],e[t+1]]);break;default:this.unknownSubpackets.push({type:i,critical:n,body:e.subarray(r,e.length)})}}readSubPackets(e,t=!0,r){const n=6===this.version?4:2,i=N.readNumber(e.subarray(0,n));let s=n;for(;s<2+i;){const n=Rn(e.subarray(s,e.length));s+=n.offset,this.readSubPacket(e.subarray(s,s+n.len),t,r),s+=n.len}return s}toSign(e,t){const r=Q.signature;switch(e){case r.binary:return null!==t.text?N.encodeUTF8(t.getText(!0)):t.getBytes(!0);case r.text:{const e=t.getBytes(!0);return N.canonicalizeEOL(e)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let e,n;if(t.userID)n=180,e=t.userID;else{if(!t.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");n=209,e=t.userAttribute}const i=e.write();return N.concat([this.toSign(r.key,t),new Uint8Array([n]),N.writeNumber(i.length,4),i])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return N.concat([this.toSign(r.key,t),this.toSign(r.key,{key:t.bind})]);case r.key:if(void 0===t.key)throw Error("Key packet is required for this signature.");return t.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,t);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,t){let r=0;return B(C(this.signatureData),(e=>{r+=e.length}),(()=>{const n=[];return 5!==this.version||this.signatureType!==Q.signature.binary&&this.signatureType!==Q.signature.text||(t?n.push(new Uint8Array(6)):n.push(e.writeHeader())),n.push(new Uint8Array([this.version,255])),5===this.version&&n.push(new Uint8Array(4)),n.push(N.writeNumber(r,4)),N.concat(n)}))}toHash(e,t,r=!1){const n=this.toSign(e,t);return N.concat([this.salt||new Uint8Array,n,this.signatureData,this.calculateTrailer(t,r)])}async hash(e,t,r,n=!1){if(6===this.version&&this.salt.length!==aa(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(e,t,n)),Zi.hash.digest(this.hashAlgorithm,r)}async verify(e,t,r,n=new Date,i=!1,s=O){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const a=t===Q.signature.binary||t===Q.signature.text;if(!this[ta]||a){let n,s;if(this.hashed?s=await this.hashed:(n=this.toHash(t,r,i),s=await this.hash(t,r,n)),s=await D(s),this.signedHashValue[0]!==s[0]||this.signedHashValue[1]!==s[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[ta]=await Zi.signature.verify(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,n,s),!this[ta])throw Error("Signature verification failed")}const o=N.normalizeDate(n);if(o&&this.created>o)throw Error("Signature creation time is in the future");if(o&&o>=this.getExpirationTime())throw Error("Signature is expired");if(s.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+Q.read(Q.hash,this.hashAlgorithm).toUpperCase());if(s.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[Q.signature.binary,Q.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+Q.read(Q.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach((({type:e,critical:t})=>{if(t)throw Error("Unknown critical signature subpacket type "+e)})),this.rawNotations.forEach((({name:e,critical:t})=>{if(t&&s.knownNotations.indexOf(e)<0)throw Error("Unknown critical notation: "+e)})),null!==this.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const t=N.normalizeDate(e);return null!==t&&!(this.created<=t&&t<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function sa(e,t,r){const n=[];return n.push(Tn(r.length+1)),n.push(new Uint8Array([(t?128:0)|e])),n.push(r),N.concat(n)}function aa(e){switch(e){case Q.hash.sha256:return 16;case Q.hash.sha384:return 24;case Q.hash.sha512:return 32;case Q.hash.sha224:case Q.hash.sha3_256:return 16;case Q.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class oa{static get tag(){return Q.packet.onePassSignature}static fromSignaturePacket(e,t){const r=new oa;return r.version=6===e.version?6:3,r.signatureType=e.signatureType,r.hashAlgorithm=e.hashAlgorithm,r.publicKeyAlgorithm=e.publicKeyAlgorithm,r.issuerKeyID=e.issuerKeyID,r.salt=e.salt,r.issuerFingerprint=e.issuerFingerprint,r.flags=t?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new Nn(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[t++],this.hashAlgorithm=e[t++],this.publicKeyAlgorithm=e[t++],6===this.version){const r=e[t++];this.salt=e.subarray(t,t+r),t+=r,this.issuerFingerprint=e.subarray(t,t+32),t+=32,this.issuerKeyID=new ea,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new ea,this.issuerKeyID.read(e.subarray(t,t+8)),t+=8;return this.flags=e[t++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return 6===this.version?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),N.concatUint8Array(e)}calculateTrailer(...e){return R((async()=>ia.prototype.calculateTrailer.apply(await this.correspondingSig,e)))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==Q.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||3===this.version&&6===e.version||6===this.version&&6!==e.version||6===this.version&&!N.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||6===this.version&&!N.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function ca(e,t){if(!t[e]){let r;try{r=Q.read(Q.packet,e)}catch(t){throw new Fn("Unknown packet type with tag: "+e)}throw Error("Packet not allowed in this context: "+r)}return new t[e]}oa.prototype.hash=ia.prototype.hash,oa.prototype.toHash=ia.prototype.toHash,oa.prototype.toSign=ia.prototype.toSign;class ua extends Array{static async fromBinary(e,t,r=O){const n=new ua;return await n.read(e,t,r),n}async read(e,t,r=O){r.additionalAllowedPackets.length&&(t={...t,...N.constructAllowedPackets(r.additionalAllowedPackets)}),this.stream=S(e,(async(e,n)=>{const i=_(n);try{for(;;)if(await i.ready,await Mn(e,(async e=>{try{if(e.tag===Q.packet.marker||e.tag===Q.packet.trust||e.tag===Q.packet.padding)return;const n=ca(e.tag,t);n.packets=new ua,n.fromStream=N.isStream(e.packet),await n.read(e.packet,r),await i.write(n)}catch(t){if(t instanceof Fn){if(!(e.tag<=39))return;await i.abort(t)}const n=!r.ignoreUnsupportedPackets&&t instanceof Nn,s=!(r.ignoreMalformedPackets||t instanceof Nn);if(n||s||On(e.tag))await i.abort(t);else{const t=new Hn(e.tag,e.packet);await i.write(t)}N.printDebugError(t)}})))return await i.ready,void await i.close()}catch(e){await i.abort(e)}}));const n=T(this.stream);for(;;){const{done:e,value:t}=await n.read();if(e?this.stream=null:this.push(t),e||On(t.constructor.tag))break}n.releaseLock()}write(){const e=[];for(let t=0;t<this.length;t++){const r=this[t]instanceof Hn?this[t].tag:this[t].constructor.tag,n=this[t].write();if(N.isStream(n)&&On(this[t].constructor.tag)){let t=[],i=0;const s=512;e.push(Ln(r)),e.push(B(n,(e=>{if(t.push(e),i+=e.length,i>=s){const e=Math.min(Math.log(i)/Math.LN2|0,30),r=2**e,n=N.concat([_n(e)].concat(t));return t=[n.subarray(1+r)],i=t[0].length,n.subarray(0,1+r)}}),(()=>N.concat([Tn(i)].concat(t)))))}else{if(N.isStream(n)){let t=0;e.push(B(C(n),(e=>{t+=e.length}),(()=>Qn(r,t))))}else e.push(Qn(r,n.length));e.push(n)}}return N.concat(e)}filterByTag(...e){const t=new ua,r=e=>t=>e===t;for(let n=0;n<this.length;n++)e.some(r(this[n].constructor.tag))&&t.push(this[n]);return t}findPacket(e){return this.find((t=>t.constructor.tag===e))}indexOfTag(...e){const t=[],r=this,n=e=>t=>e===t;for(let i=0;i<this.length;i++)e.some(n(r[i].constructor.tag))&&t.push(i);return t}}const ha=N.constructAllowedPackets([Xs,oa,ia]);class la{static get tag(){return Q.packet.compressedData}constructor(e=O){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}async read(e,t=O){await I(e,(async e=>{this.algorithm=await e.readByte(),this.compressed=e.remainder(),await this.decompress(t)}))}write(){return null===this.compressed&&this.compress(),N.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(e=O){const t=Q.read(Q.compression,this.algorithm),r=ga[t];if(!r)throw Error(t+" decompression not supported");this.packets=await ua.fromBinary(await r(this.compressed),ha,e)}compress(){const e=Q.read(Q.compression,this.algorithm),t=pa[e];if(!t)throw Error(e+" compression not supported");this.compressed=t(this.packets.write())}}function fa(e,t){return r=>{if(!N.isStream(r)||h(r))return R((()=>D(r).then((e=>new Promise(((r,n)=>{const i=new t;i.ondata=e=>{r(e)};try{i.push(e,!0)}catch(e){n(e)}}))))));if(e)try{const t=e();return r.pipeThrough(t)}catch(e){if("TypeError"!==e.name)throw e}const n=r.getReader(),i=new t;return new ReadableStream({async start(e){for(i.ondata=async(t,r)=>{e.enqueue(t),r&&e.close()};;){const{done:e,value:t}=await n.read();if(e)return void i.push(new Uint8Array,!0);t.length&&i.push(t)}}})}}function ya(){return async function(e){const{decode:t}=await Promise.resolve().then((function(){return Sf}));return R((async()=>t(await D(e))))}}const da=e=>({compressor:"undefined"!=typeof CompressionStream&&(()=>new CompressionStream(e)),decompressor:"undefined"!=typeof DecompressionStream&&(()=>new DecompressionStream(e))}),pa={zip:fa(da("deflate-raw").compressor,Js),zlib:fa(da("deflate").compressor,$s)},ga={uncompressed:e=>e,zip:fa(da("deflate-raw").decompressor,Ws),zlib:fa(da("deflate").decompressor,Ys),bzip2:ya()},Aa=N.constructAllowedPackets([Xs,la,oa,ia]);class wa{static get tag(){return Q.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:t}){if(1!==e&&2!==e)throw Error("Unsupported SEIPD version");const r=new wa;return r.version=e,2===e&&(r.aeadAlgorithm=t),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(e){await I(e,(async e=>{if(this.version=await e.readByte(),1!==this.version&&2!==this.version)throw new Nn(`Version ${this.version} of the SEIP packet is unsupported.`);2===this.version&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()}))}write(){return 2===this.version?N.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):N.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(e,t,r=O){const{blockSize:n,keySize:i}=Zi.getCipherParams(e);if(t.length!==i)throw Error("Unexpected session key size");let s=this.packets.write();if(h(s)&&(s=await D(s)),2===this.version)this.cipherAlgorithm=e,this.salt=Zi.random.getRandomBytes(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await ma(this,"encrypt",t,s);else{const i=await Zi.getPrefixRandom(e),a=new Uint8Array([211,20]),o=N.concat([i,s,a]),c=await Zi.hash.sha1(K(o)),u=N.concat([o,c]);this.encrypted=await Zi.mode.cfb.encrypt(e,t,u,new Uint8Array(n),r)}return!0}async decrypt(e,t,r=O){if(t.length!==Zi.getCipherParams(e).keySize)throw Error("Unexpected session key size");let n,i=C(this.encrypted);if(h(i)&&(i=await D(i)),2===this.version){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");n=await ma(this,"decrypt",t,i)}else{const{blockSize:s}=Zi.getCipherParams(e),a=await Zi.mode.cfb.decrypt(e,t,i,new Uint8Array(s)),o=U(K(a),-20),c=U(a,0,-20),u=Promise.all([D(await Zi.hash.sha1(K(c))),D(o)]).then((([e,t])=>{if(!N.equalsUint8Array(e,t))throw Error("Modification detected.");return new Uint8Array})),h=U(c,s+2);n=U(h,0,-2),n=b([n,R((()=>u))]),N.isStream(i)&&r.allowUnauthenticatedStream||(n=await D(n))}return this.packets=await ua.fromBinary(n,Aa,r),!0}}async function ma(e,t,r,n){const i=e instanceof wa&&2===e.version,s=!i&&e.constructor.tag===Q.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=Zi.getAEADMode(e.aeadAlgorithm),o="decrypt"===t?a.tagLength:0,c="encrypt"===t?a.tagLength:0,u=2**(e.chunkSizeByte+6)+o,h=s?8:0,l=new ArrayBuffer(13+h),f=new Uint8Array(l,0,5+h),y=new Uint8Array(l),d=new DataView(l),p=new Uint8Array(l,5,8);f.set([192|e.constructor.tag,e.version,e.cipherAlgorithm,e.aeadAlgorithm,e.chunkSizeByte],0);let g,A,w=0,m=Promise.resolve(),b=0,k=0;if(i){const{keySize:t}=Zi.getCipherParams(e.cipherAlgorithm),{ivLength:n}=a,i=new Uint8Array(l,0,5),s=await ri(Q.hash.sha256,r,e.salt,i,t+n);r=s.subarray(0,t),g=s.subarray(t),g.fill(0,g.length-8),A=new DataView(g.buffer,g.byteOffset,g.byteLength)}else g=e.iv;const v=await a(e.cipherAlgorithm,r);return S(n,(async(r,n)=>{if("array"!==N.isStream(r)){const t=new TransformStream({},{highWaterMark:N.getHardwareConcurrency()*2**(e.chunkSizeByte+6),size:e=>e.length});E(t.readable,n),n=t.writable}const s=T(r),a=_(n);try{for(;;){let e=await s.readBytes(u+o)||new Uint8Array;const r=e.subarray(e.length-o);let n,l,E;if(e=e.subarray(0,e.length-o),i)E=g;else{E=g.slice();for(let e=0;e<8;e++)E[g.length-8+e]^=p[e]}if(!w||e.length?(s.unshift(r),n=v[t](e,E,f),n.catch((()=>{})),k+=e.length-o+c):(d.setInt32(5+h+4,b),n=v[t](r,E,y),n.catch((()=>{})),k+=c,l=!0),b+=e.length-o,m=m.then((()=>n)).then((async e=>{await a.ready,await a.write(e),k-=e.length})).catch((e=>a.abort(e))),(l||k>a.desiredSize)&&await m,l){await a.close();break}i?A.setInt32(g.length-4,++w):d.setInt32(9,++w)}}catch(e){await a.ready.catch((()=>{})),await a.abort(e)}}))}const ba=N.constructAllowedPackets([Xs,la,oa,ia]);class Ea{static get tag(){return Q.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=Q.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(e){await I(e,(async e=>{const t=await e.readByte();if(1!==t)throw new Nn(`Version ${t} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte();const r=Zi.getAEADMode(this.aeadAlgorithm);this.iv=await e.readBytes(r.ivLength),this.encrypted=e.remainder()}))}write(){return N.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(e,t,r=O){this.packets=await ua.fromBinary(await ma(this,"decrypt",t,C(this.encrypted)),ba,r)}async encrypt(e,t,r=O){this.cipherAlgorithm=e;const{ivLength:n}=Zi.getAEADMode(this.aeadAlgorithm);this.iv=Zi.random.getRandomBytes(n),this.chunkSizeByte=r.aeadChunkSizeByte;const i=this.packets.write();this.encrypted=await ma(this,"encrypt",t,i)}}class ka{static get tag(){return Q.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new ea,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:t,anonymousRecipient:r,sessionKey:n,sessionKeyAlgorithm:i}){const s=new ka;if(3!==e&&6!==e)throw Error("Unsupported PKESK version");return s.version=e,6===e&&(s.publicKeyVersion=r?null:t.version,s.publicKeyFingerprint=r?null:t.getFingerprintBytes()),s.publicKeyID=r?ea.wildcard():t.getKeyID(),s.publicKeyAlgorithm=t.algorithm,s.sessionKey=n,s.sessionKeyAlgorithm=i,s}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new Nn(`Version ${this.version} of the PKESK packet is unsupported.`);if(6===this.version){const r=e[t++];if(r){this.publicKeyVersion=e[t++];const n=r-1;this.publicKeyFingerprint=e.subarray(t,t+n),t+=n,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=ea.wildcard()}else t+=this.publicKeyID.read(e.subarray(t,t+8));if(this.publicKeyAlgorithm=e[t++],this.encrypted=Zi.parseEncSessionKeyParams(this.publicKeyAlgorithm,e.subarray(t)),this.publicKeyAlgorithm===Q.publicKey.x25519||this.publicKeyAlgorithm===Q.publicKey.x448)if(3===this.version)this.sessionKeyAlgorithm=Q.write(Q.symmetric,this.encrypted.C.algorithm);else if(null!==this.encrypted.C.algorithm)throw Error("Unexpected cleartext symmetric algorithm")}write(){const e=[new Uint8Array([this.version])];return 6===this.version?null!==this.publicKeyFingerprint?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),Zi.serializeParams(this.publicKeyAlgorithm,this.encrypted)),N.concatUint8Array(e)}async encrypt(e){const t=Q.write(Q.publicKey,this.publicKeyAlgorithm),r=3===this.version?this.sessionKeyAlgorithm:null,n=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),i=va(this.version,t,r,this.sessionKey);this.encrypted=await Zi.publicKeyEncrypt(t,r,e.publicParams,i,n)}async decrypt(e,t){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");const r=t?va(this.version,this.publicKeyAlgorithm,t.sessionKeyAlgorithm,t.sessionKey):null,n=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),i=await Zi.publicKeyDecrypt(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,n,r),{sessionKey:s,sessionKeyAlgorithm:a}=function(e,t,r,n){switch(t){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.elgamal:case Q.publicKey.ecdh:{const t=r.subarray(0,r.length-2),i=r.subarray(r.length-2),s=N.writeChecksum(t.subarray(t.length%8)),a=s[0]===i[0]&s[1]===i[1],o=6===e?{sessionKeyAlgorithm:null,sessionKey:t}:{sessionKeyAlgorithm:t[0],sessionKey:t.subarray(1)};if(n){const t=a&o.sessionKeyAlgorithm===n.sessionKeyAlgorithm&o.sessionKey.length===n.sessionKey.length;return{sessionKey:N.selectUint8Array(t,o.sessionKey,n.sessionKey),sessionKeyAlgorithm:6===e?null:N.selectUint8(t,o.sessionKeyAlgorithm,n.sessionKeyAlgorithm)}}if(a&&(6===e||Q.read(Q.symmetric,o.sessionKeyAlgorithm)))return o;throw Error("Decryption error")}case Q.publicKey.x25519:case Q.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:r};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,i,t);if(3===this.version){const e=this.publicKeyAlgorithm!==Q.publicKey.x25519&&this.publicKeyAlgorithm!==Q.publicKey.x448;if(this.sessionKeyAlgorithm=e?a:this.sessionKeyAlgorithm,s.length!==Zi.getCipherParams(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=s}}function va(e,t,r,n){switch(t){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.elgamal:case Q.publicKey.ecdh:return N.concatUint8Array([new Uint8Array(6===e?[]:[r]),n,N.writeChecksum(n.subarray(n.length%8))]);case Q.publicKey.x25519:case Q.publicKey.x448:return n;default:throw Error("Unsupported public key algorithm")}}class Ba{static get tag(){return Q.packet.symEncryptedSessionKey}constructor(e=O){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=Q.write(Q.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let t=0;if(this.version=e[t++],4!==this.version&&5!==this.version&&6!==this.version)throw new Nn(`Version ${this.version} of the SKESK packet is unsupported.`);6===this.version&&t++;const r=e[t++];this.version>=5&&(this.aeadAlgorithm=e[t++],6===this.version&&t++);const n=e[t++];if(this.s2k=ss(n),t+=this.s2k.read(e.subarray(t,e.length)),this.version>=5){const r=Zi.getAEADMode(this.aeadAlgorithm);this.iv=e.subarray(t,t+=r.ivLength)}this.version>=5||t<e.length?(this.encrypted=e.subarray(t,e.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const e=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let t;const r=this.s2k.write();if(6===this.version){const n=r.length,i=3+n+this.iv.length;t=N.concatUint8Array([new Uint8Array([this.version,i,e,this.aeadAlgorithm,n]),r,this.iv,this.encrypted])}else 5===this.version?t=N.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(t=N.concatUint8Array([new Uint8Array([this.version,e]),r]),null!==this.encrypted&&(t=N.concatUint8Array([t,this.encrypted])));return t}async decrypt(e){const t=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:n}=Zi.getCipherParams(t),i=await this.s2k.produceKey(e,n);if(this.version>=5){const e=Zi.getAEADMode(this.aeadAlgorithm),r=new Uint8Array([192|Ba.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),s=6===this.version?await ri(Q.hash.sha256,i,new Uint8Array,r,n):i,a=await e(t,s);this.sessionKey=await a.decrypt(this.encrypted,this.iv,r)}else if(null!==this.encrypted){const e=await Zi.mode.cfb.decrypt(t,i,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=Q.write(Q.symmetric,e[0]),this.sessionKey=e.subarray(1,e.length),this.sessionKey.length!==Zi.getCipherParams(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=i}async encrypt(e,t=O){const r=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=as(t),this.s2k.generateSalt();const{blockSize:n,keySize:i}=Zi.getCipherParams(r),s=await this.s2k.produceKey(e,i);if(null===this.sessionKey&&(this.sessionKey=Zi.generateSessionKey(this.sessionKeyAlgorithm)),this.version>=5){const e=Zi.getAEADMode(this.aeadAlgorithm);this.iv=Zi.random.getRandomBytes(e.ivLength);const t=new Uint8Array([192|Ba.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),n=6===this.version?await ri(Q.hash.sha256,s,new Uint8Array,t,i):s,a=await e(r,n);this.encrypted=await a.encrypt(this.sessionKey,this.iv,t)}else{const e=N.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await Zi.mode.cfb.encrypt(r,s,e,new Uint8Array(n),t)}}}class Sa{static get tag(){return Q.packet.publicKey}constructor(e=new Date,t=O){this.version=t.v6Keys?6:4,this.created=N.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const t=new Sa,{version:r,created:n,algorithm:i,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=n,t.algorithm=i,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}async read(e,t=O){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new Nn("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4===this.version||5===this.version||6===this.version){this.created=N.readDate(e.subarray(r,r+4)),r+=4,this.algorithm=e[r++],this.version>=5&&(r+=4);const{read:t,publicParams:n}=Zi.parsePublicKeyParams(this.algorithm,e.subarray(r));if(6===this.version&&n.oid&&(n.oid.getName()===Q.curve.curve25519Legacy||n.oid.getName()===Q.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=n,r+=t,await this.computeFingerprintAndKeyID(),r}throw new Nn(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(N.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const t=Zi.serializeParams(this.algorithm,this.publicParams);return this.version>=5&&e.push(N.writeNumber(t.length,4)),e.push(t),N.concatUint8Array(e)}writeForHash(e){const t=this.writePublicKey(),r=149+e,n=e>=5?4:2;return N.concatUint8Array([new Uint8Array([r]),N.writeNumber(t.length,n),t])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new ea,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(4!==this.version)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await Zi.hash.sha256(e);else{if(4!==this.version)throw Error("Unsupported key version");this.fingerprint=await Zi.hash.sha1(e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return N.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&N.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=Q.read(Q.publicKey,this.algorithm);const t=this.publicParams.n||this.publicParams.p;return t?e.bits=N.uint8ArrayBitLength(t):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}Sa.prototype.readPublicKey=Sa.prototype.read,Sa.prototype.writePublicKey=Sa.prototype.write;const Ia=N.constructAllowedPackets([Xs,la,oa,ia]);class Ca{static get tag(){return Q.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(e){this.encrypted=e}write(){return this.encrypted}async decrypt(e,t,r=O){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:n}=Zi.getCipherParams(e),i=await D(C(this.encrypted)),s=await Zi.mode.cfb.decrypt(e,t,i.subarray(n+2),i.subarray(2,n+2));this.packets=await ua.fromBinary(s,Ia,r)}async encrypt(e,t,r=O){const n=this.packets.write(),{blockSize:i}=Zi.getCipherParams(e),s=await Zi.getPrefixRandom(e),a=await Zi.mode.cfb.encrypt(e,t,s,new Uint8Array(i),r),o=await Zi.mode.cfb.encrypt(e,t,n,a.subarray(2),r);this.encrypted=N.concat([a,o])}}class Ka{static get tag(){return Q.packet.marker}read(e){return 80===e[0]&&71===e[1]&&80===e[2]}write(){return new Uint8Array([80,71,80])}}class Pa extends Sa{static get tag(){return Q.packet.publicSubkey}constructor(e,t){super(e,t)}static fromSecretSubkeyPacket(e){const t=new Pa,{version:r,created:n,algorithm:i,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=n,t.algorithm=i,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}}class Ua{static get tag(){return Q.packet.userAttribute}constructor(){this.attributes=[]}read(e){let t=0;for(;t<e.length;){const r=Rn(e.subarray(t,e.length));t+=r.offset,this.attributes.push(N.uint8ArrayToString(e.subarray(t,t+r.len))),t+=r.len}}write(){const e=[];for(let t=0;t<this.attributes.length;t++)e.push(Tn(this.attributes[t].length)),e.push(N.stringToUint8Array(this.attributes[t]));return N.concatUint8Array(e)}equals(e){return!!(e&&e instanceof Ua)&&this.attributes.every((function(t,r){return t===e.attributes[r]}))}}class Da extends Sa{static get tag(){return Q.packet.secretKey}constructor(e=new Date,t=O){super(e,t),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(e,t=O){let r=await this.readPublicKey(e,t);const n=r;this.s2kUsage=e[r++],5===this.version&&r++,6===this.version&&this.s2kUsage&&r++;try{if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){this.symmetric=e[r++],253===this.s2kUsage&&(this.aead=e[r++]),6===this.version&&r++;const t=e[r++];if(this.s2k=ss(t),r+=this.s2k.read(e.subarray(r,e.length)),"gnu-dummy"===this.s2k.type)return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=253===this.s2kUsage&&(5===this.version||4===this.version&&t.parseAEADEncryptedV4KeysAsLegacy),253!==this.s2kUsage||this.isLegacyAEAD?(this.iv=e.subarray(r,r+Zi.getCipherParams(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=e.subarray(r,r+Zi.getAEADMode(this.aead).ivLength),this.usedModernAEAD=!0),r+=this.iv.length)}catch(t){if(!this.s2kUsage)throw t;this.unparseableKeyMaterial=e.subarray(n),this.isEncrypted=!0}if(5===this.version&&(r+=4),this.keyMaterial=e.subarray(r),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let t;if(6===this.version)t=this.keyMaterial;else if(t=this.keyMaterial.subarray(0,-2),!N.equalsUint8Array(N.writeChecksum(t),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:e,privateParams:r}=Zi.parsePrivateKeyParams(this.algorithm,t,this.publicParams);if(e<t.length)throw Error("Error reading MPIs");this.privateParams=r}catch(e){if(e instanceof Nn)throw e;throw Error("Error reading MPIs")}}}write(){const e=this.writePublicKey();if(this.unparseableKeyMaterial)return N.concatUint8Array([e,this.unparseableKeyMaterial]);const t=[e];t.push(new Uint8Array([this.s2kUsage]));const r=[];if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){r.push(this.symmetric),253===this.s2kUsage&&r.push(this.aead);const e=this.s2k.write();6===this.version&&r.push(e.length),r.push(...e)}return this.s2kUsage&&"gnu-dummy"!==this.s2k.type&&r.push(...this.iv),(5===this.version||6===this.version&&this.s2kUsage)&&t.push(new Uint8Array([r.length])),t.push(new Uint8Array(r)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=Zi.serializeParams(this.algorithm,this.privateParams)),5===this.version&&t.push(N.writeNumber(this.keyMaterial.length,4)),t.push(this.keyMaterial),this.s2kUsage||6===this.version||t.push(N.writeChecksum(this.keyMaterial))),N.concatUint8Array(t)}isDecrypted(){return!1===this.isEncrypted}isMissingSecretKeyMaterial(){return void 0!==this.unparseableKeyMaterial||this.isDummy()}isDummy(){return!(!this.s2k||"gnu-dummy"!==this.s2k.type)}makeDummy(e=O){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=ss(Q.s2k.gnu,e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=Q.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(e,t=O){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=as(t),this.s2k.generateSalt();const r=Zi.serializeParams(this.algorithm,this.privateParams);this.symmetric=Q.symmetric.aes256;const{blockSize:n}=Zi.getCipherParams(this.symmetric);if(t.aeadProtect){this.s2kUsage=253,this.aead=t.preferredAEADAlgorithm;const i=Zi.getAEADMode(this.aead);this.isLegacyAEAD=5===this.version,this.usedModernAEAD=!this.isLegacyAEAD;const s=Ln(this.constructor.tag),a=await xa(this.version,this.s2k,e,this.symmetric,this.aead,s,this.isLegacyAEAD),o=await i(this.symmetric,a);this.iv=this.isLegacyAEAD?Zi.random.getRandomBytes(n):Zi.random.getRandomBytes(i.ivLength);const c=this.isLegacyAEAD?new Uint8Array:N.concatUint8Array([s,this.writePublicKey()]);this.keyMaterial=await o.encrypt(r,this.iv.subarray(0,i.ivLength),c)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const i=await xa(this.version,this.s2k,e,this.symmetric);this.iv=Zi.random.getRandomBytes(n),this.keyMaterial=await Zi.mode.cfb.encrypt(this.symmetric,i,N.concatUint8Array([r,await Zi.hash.sha1(r,t)]),this.iv,t)}}async decrypt(e){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let t;const r=Ln(this.constructor.tag);if(254!==this.s2kUsage&&253!==this.s2kUsage)throw 255===this.s2kUsage?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let n;if(t=await xa(this.version,this.s2k,e,this.symmetric,this.aead,r,this.isLegacyAEAD),253===this.s2kUsage){const i=Zi.getAEADMode(this.aead),s=await i(this.symmetric,t);try{const e=this.isLegacyAEAD?new Uint8Array:N.concatUint8Array([r,this.writePublicKey()]);n=await s.decrypt(this.keyMaterial,this.iv.subarray(0,i.ivLength),e)}catch(e){if("Authentication tag mismatch"===e.message)throw Error("Incorrect key passphrase: "+e.message);throw e}}else{const e=await Zi.mode.cfb.decrypt(this.symmetric,t,this.keyMaterial,this.iv);n=e.subarray(0,-20);const r=await Zi.hash.sha1(n);if(!N.equalsUint8Array(r,e.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:e}=Zi.parsePrivateKeyParams(this.algorithm,n,this.publicParams);this.privateParams=e}catch(e){throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let e;try{e=await Zi.validateParams(this.algorithm,this.publicParams,this.privateParams)}catch(t){e=!1}if(!e)throw Error("Key is invalid")}async generate(e,t){if(6===this.version&&(this.algorithm===Q.publicKey.ecdh&&t===Q.curve.curve25519Legacy||this.algorithm===Q.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${t}. Generate a key of type 'curve25519' instead`);const{privateParams:r,publicParams:n}=await Zi.generateParams(this.algorithm,e,t);this.privateParams=r,this.publicParams=n,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach((e=>{this.privateParams[e].fill(0),delete this.privateParams[e]})),this.privateParams=null,this.isEncrypted=!0)}}async function xa(e,t,r,n,i,s,a){if("argon2"===t.type&&!i)throw Error("Using Argon2 S2K without AEAD is not allowed");if("simple"===t.type&&6===e)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=Zi.getCipherParams(n),c=await t.produceKey(r,o);if(!i||5===e||a)return c;const u=N.concatUint8Array([s,new Uint8Array([e,n,i])]);return ri(Q.hash.sha256,c,new Uint8Array,u,o)}class Ra{static get tag(){return Q.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(N.isString(e)||e.name&&!N.isString(e.name)||e.email&&!N.isEmailAddress(e.email)||e.comment&&!N.isString(e.comment))throw Error("Invalid user ID format");const t=new Ra;Object.assign(t,e);const r=[];return t.name&&r.push(t.name),t.comment&&r.push(`(${t.comment})`),t.email&&r.push(`<${t.email}>`),t.userID=r.join(" "),t}read(e,t=O){const r=N.decodeUTF8(e);if(r.length>t.maxUserIDLength)throw Error("User ID string is too long");const n=/^(?<name>[^()]+\s+)?(?<comment>\([^()]+\)\s+)?(?<email><\S+@\S+>)$/.exec(r);if(null!==n){const{name:e,comment:t,email:r}=n.groups;this.comment=t?.replace(/^\(|\)|\s$/g,"").trim()||"",this.name=e?.trim()||"",this.email=r.substring(1,r.length-1)}else/^[^\s@]+@[^\s@]+$/.test(r)&&(this.email=r);this.userID=r}write(){return N.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}}class Ta extends Da{static get tag(){return Q.packet.secretSubkey}constructor(e=new Date,t=O){super(e,t)}}class _a{static get tag(){return Q.packet.trust}read(){throw new Nn("Trust packets are not supported")}write(){throw new Nn("Trust packets are not supported")}}class La{static get tag(){return Q.packet.padding}constructor(){this.padding=null}read(e){}write(){return this.padding}async createPadding(e){this.padding=await Zi.random.getRandomBytes(e)}}const Qa=N.constructAllowedPackets([ia]);class Oa{constructor(e){this.packets=e||new ua}write(){return this.packets.write()}armor(e=O){const t=this.packets.some((e=>e.constructor.tag===ia.tag&&6!==e.version));return re(Q.armor.signature,this.write(),void 0,void 0,void 0,t,e)}getSigningKeyIDs(){return this.packets.map((e=>e.issuerKeyID))}}async function Ma({armoredSignature:e,binarySignature:t,config:r,...n}){r={...O,...r};let i=e||t;if(!i)throw Error("readSignature: must pass options object containing `armoredSignature` or `binarySignature`");if(e&&!N.isString(e))throw Error("readSignature: options.armoredSignature must be a string");if(t&&!N.isUint8Array(t))throw Error("readSignature: options.binarySignature must be a Uint8Array");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(e){const{type:e,data:t}=await te(i);if(e!==Q.armor.signature)throw Error("Armored text not of type signature");i=t}const a=await ua.fromBinary(i,Qa,r);return new Oa(a)}async function Na(e,t){const r=new Ta(e.date,t);return r.packets=null,r.algorithm=Q.write(Q.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve),await r.computeFingerprintAndKeyID(),r}async function Fa(e,t){const r=new Da(e.date,t);return r.packets=null,r.algorithm=Q.write(Q.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve,e.config),await r.computeFingerprintAndKeyID(),r}async function Ha(e,t,r,n,i=new Date,s){let a,o;for(let c=e.length-1;c>=0;c--)try{(!a||e[c].created>=a.created)&&(await e[c].verify(t,r,n,i,void 0,s),a=e[c])}catch(e){o=e}if(!a)throw N.wrapError(`Could not find valid ${Q.read(Q.signature,r)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,((e,t,r)=>t+" "+r.toLowerCase())),o);return a}function za(e,t,r=new Date){const n=N.normalizeDate(r);if(null!==n){const r=Ja(e,t);return!(e.created<=n&&n<r)}return!1}async function ja(e,t,r,n){const i={};i.key=t,i.bind=e;const s={signatureType:Q.signature.subkeyBinding};return r.sign?(s.keyFlags=[Q.keyFlags.signData],s.embeddedSignature=await Ga(i,[],e,{signatureType:Q.signature.keyBinding},r.date,void 0,void 0,void 0,n)):s.keyFlags=[Q.keyFlags.encryptCommunication|Q.keyFlags.encryptStorage],r.keyExpirationTime>0&&(s.keyExpirationTime=r.keyExpirationTime,s.keyNeverExpires=!1),await Ga(i,[],t,s,r.date,void 0,void 0,void 0,n)}async function Ga(e,t,r,n,i,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new ia;return Object.assign(u,n),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await async function(e,t,r=new Date,n=[],i){const s=Q.hash.sha256,a=i.preferredHashAlgorithm,o=await Promise.all(e.map((async(e,t)=>(await e.getPrimarySelfSignature(r,n[t],i)).preferredHashAlgorithms))),c=new Map;for(const e of o)for(const t of e)try{const e=Q.write(Q.hash,t);c.set(e,c.has(e)?c.get(e)+1:1)}catch{}const u=t=>0===e.length||c.get(t)===e.length||t===s,h=()=>{if(0===c.size)return s;const e=Array.from(c.keys()).filter((e=>u(e))).sort(((e,t)=>Zi.hash.getHashByteLength(e)-Zi.hash.getHashByteLength(t)))[0];return Zi.hash.getHashByteLength(e)>=Zi.hash.getHashByteLength(s)?e:s};if(new Set([Q.publicKey.ecdsa,Q.publicKey.eddsaLegacy,Q.publicKey.ed25519,Q.publicKey.ed448]).has(t.algorithm)){const e=Zi.getPreferredCurveHashAlgo(t.algorithm,t.publicParams.oid),r=u(a),n=Zi.hash.getHashByteLength(a)>=Zi.hash.getHashByteLength(e);if(r&&n)return a;{const t=h();return Zi.hash.getHashByteLength(t)>=Zi.hash.getHashByteLength(e)?t:e}}return u(a)?a:h()}(t,r,i,s,c),u.rawNotations=[...a],await u.sign(r,e,i,o,c),u}async function qa(e,t,r,n=new Date,i){(e=e[r])&&(t[r].length?await Promise.all(e.map((async function(e){e.isExpired(n)||i&&!await i(e)||t[r].some((function(t){return N.equalsUint8Array(t.writeParams(),e.writeParams())}))||t[r].push(e)}))):t[r]=e)}async function Va(e,t,r,n,i,s,a=new Date,o){s=s||e;const c=[];return await Promise.all(n.map((async function(e){try{if(!i||e.issuerKeyID.equals(i.issuerKeyID)){const n=![Q.reasonForRevocation.keyRetired,Q.reasonForRevocation.keySuperseded,Q.reasonForRevocation.userIDInvalid].includes(e.reasonForRevocationFlag);await e.verify(s,t,r,n?null:a,!1,o),c.push(e.issuerKeyID)}}catch(e){}}))),i?(i.revoked=!!c.some((e=>e.equals(i.issuerKeyID)))||i.revoked||!1,i.revoked):c.length>0}function Ja(e,t){let r;return!1===t.keyNeverExpires&&(r=e.created.getTime()+1e3*t.keyExpirationTime),r?new Date(r):1/0}function Wa(e,t={}){switch(e.type=e.type||t.type,e.curve=e.curve||t.curve,e.rsaBits=e.rsaBits||t.rsaBits,e.keyExpirationTime=void 0!==e.keyExpirationTime?e.keyExpirationTime:t.keyExpirationTime,e.passphrase=N.isString(e.passphrase)?e.passphrase:t.passphrase,e.date=e.date||t.date,e.sign=e.sign||!1,e.type){case"ecc":try{e.curve=Q.write(Q.curve,e.curve)}catch(e){throw Error("Unknown curve")}e.curve!==Q.curve.ed25519Legacy&&e.curve!==Q.curve.curve25519Legacy&&"ed25519"!==e.curve&&"curve25519"!==e.curve||(e.curve=e.sign?Q.curve.ed25519Legacy:Q.curve.curve25519Legacy),e.sign?e.algorithm=e.curve===Q.curve.ed25519Legacy?Q.publicKey.eddsaLegacy:Q.publicKey.ecdsa:e.algorithm=Q.publicKey.ecdh;break;case"curve25519":e.algorithm=e.sign?Q.publicKey.ed25519:Q.publicKey.x25519;break;case"curve448":e.algorithm=e.sign?Q.publicKey.ed448:Q.publicKey.x448;break;case"rsa":e.algorithm=Q.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+e.type)}return e}function $a(e,t,r){switch(e.algorithm){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:case Q.publicKey.dsa:case Q.publicKey.ecdsa:case Q.publicKey.eddsaLegacy:case Q.publicKey.ed25519:case Q.publicKey.ed448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&Q.keyFlags.signData);default:return!1}}function Ya(e,t,r){switch(e.algorithm){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaEncrypt:case Q.publicKey.elgamal:case Q.publicKey.ecdh:case Q.publicKey.x25519:case Q.publicKey.x448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&Q.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&Q.keyFlags.encryptStorage);default:return!1}}function Za(e,t,r){if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(e.algorithm){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaEncrypt:case Q.publicKey.elgamal:case Q.publicKey.ecdh:case Q.publicKey.x25519:case Q.publicKey.x448:return!((t.keyFlags&&!(t.keyFlags[0]&Q.keyFlags.signData)||!r.allowInsecureDecryptionWithSigningKeys)&&t.keyFlags&&!(t.keyFlags[0]&Q.keyFlags.encryptCommunication)&&!(t.keyFlags[0]&Q.keyFlags.encryptStorage));default:return!1}}function Xa(e,t){const r=Q.write(Q.publicKey,e.algorithm),n=e.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(r))throw Error(n.algorithm+" keys are considered too weak.");switch(r){case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:case Q.publicKey.rsaEncrypt:if(n.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case Q.publicKey.ecdsa:case Q.publicKey.eddsaLegacy:case Q.publicKey.ecdh:if(t.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}class eo{constructor(e,t){this.userID=e.constructor.tag===Q.packet.userID?e:null,this.userAttribute=e.constructor.tag===Q.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new ua;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new eo(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,t,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n},s=new eo(i.userID||i.userAttribute,this.mainKey);return s.otherCertifications=await Promise.all(e.map((async function(e){if(!e.isPrivate())throw Error("Need private key for signing");if(e.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const s=await e.getSigningKey(void 0,t,void 0,r);return Ga(i,[e],s.keyPacket,{signatureType:Q.signature.certGeneric,keyFlags:[Q.keyFlags.certifyKeys|Q.keyFlags.signData]},t,void 0,void 0,void 0,r)}))),await s.update(this,t,r),s}async isRevoked(e,t,r=new Date,n=O){const i=this.mainKey.keyPacket;return Va(i,Q.signature.certRevocation,{key:i,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,t,r,n)}async verifyCertificate(e,t,r=new Date,n){const i=this,s=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:s},{issuerKeyID:o}=e,c=t.filter((e=>e.getKeys(o).length>0));return 0===c.length?null:(await Promise.all(c.map((async t=>{const s=await t.getSigningKey(o,e.created,void 0,n);if(e.revoked||await i.isRevoked(e,s.keyPacket,r,n))throw Error("User certificate is revoked");try{await e.verify(s.keyPacket,Q.signature.certGeneric,a,r,void 0,n)}catch(e){throw N.wrapError("User certificate is invalid",e)}}))),!0)}async verifyAllCertifications(e,t=new Date,r){const n=this,i=this.selfCertifications.concat(this.otherCertifications);return Promise.all(i.map((async i=>({keyID:i.issuerKeyID,valid:await n.verifyCertificate(i,e,t,r).catch((()=>!1))}))))}async verify(e=new Date,t){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};let s;for(let a=this.selfCertifications.length-1;a>=0;a--)try{const s=this.selfCertifications[a];if(s.revoked||await r.isRevoked(s,void 0,e,t))throw Error("Self-certification is revoked");try{await s.verify(n,Q.signature.certGeneric,i,e,void 0,t)}catch(e){throw N.wrapError("Self-certification is invalid",e)}return!0}catch(e){s=e}throw s}async update(e,t,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};await qa(e,this,"selfCertifications",t,(async function(e){try{return await e.verify(n,Q.signature.certGeneric,i,t,!1,r),!0}catch(e){return!1}})),await qa(e,this,"otherCertifications",t),await qa(e,this,"revocationSignatures",t,(function(e){return Va(n,Q.signature.certRevocation,i,[e],void 0,void 0,t,r)}))}async revoke(e,{flag:t=Q.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=O){const s={userID:this.userID,userAttribute:this.userAttribute,key:e},a=new eo(s.userID||s.userAttribute,this.mainKey);return a.revocationSignatures.push(await Ga(s,[],e,{signatureType:Q.signature.certRevocation,reasonForRevocationFlag:Q.write(Q.reasonForRevocation,t),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}}class to{constructor(e,t){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new ua;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new to(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,t,r=new Date,n=O){const i=this.mainKey.keyPacket;return Va(i,Q.signature.subkeyRevocation,{key:i,bind:this.keyPacket},this.revocationSignatures,e,t,r,n)}async verify(e=new Date,t=O){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket},i=await Ha(this.bindingSignatures,r,Q.signature.subkeyBinding,n,e,t);if(i.revoked||await this.isRevoked(i,null,e,t))throw Error("Subkey is revoked");if(za(this.keyPacket,i,e))throw Error("Subkey is expired");return i}async getExpirationTime(e=new Date,t=O){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket};let i;try{i=await Ha(this.bindingSignatures,r,Q.signature.subkeyBinding,n,e,t)}catch(e){return null}const s=Ja(this.keyPacket,i),a=i.getExpirationTime();return s<a?s:a}async update(e,t=new Date,r=O){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===Q.packet.publicSubkey&&e.keyPacket.constructor.tag===Q.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const i=this,s={key:n,bind:i.keyPacket};await qa(e,this,"bindingSignatures",t,(async function(e){for(let t=0;t<i.bindingSignatures.length;t++)if(i.bindingSignatures[t].issuerKeyID.equals(e.issuerKeyID))return e.created>i.bindingSignatures[t].created&&(i.bindingSignatures[t]=e),!1;try{return await e.verify(n,Q.signature.subkeyBinding,s,t,void 0,r),!0}catch(e){return!1}})),await qa(e,this,"revocationSignatures",t,(function(e){return Va(n,Q.signature.subkeyRevocation,s,[e],void 0,void 0,t,r)}))}async revoke(e,{flag:t=Q.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=O){const s={key:e,bind:this.keyPacket},a=new to(this.keyPacket,this.mainKey);return a.revocationSignatures.push(await Ga(s,[],e,{signatureType:Q.signature.subkeyRevocation,reasonForRevocationFlag:Q.write(Q.reasonForRevocation,t),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach((e=>{to.prototype[e]=function(){return this.keyPacket[e]()}}));const ro=N.constructAllowedPackets([ia]),no=new Set([Q.packet.publicKey,Q.packet.privateKey]),io=new Set([Q.packet.publicKey,Q.packet.privateKey,Q.packet.publicSubkey,Q.packet.privateSubkey]);class so{packetListToStructure(e,t=new Set){let r,n,i,s;for(const a of e){if(a instanceof Hn){io.has(a.tag)&&!s&&(s=no.has(a.tag)?no:io);continue}const e=a.constructor.tag;if(s){if(!s.has(e))continue;s=null}if(t.has(e))throw Error("Unexpected packet type: "+e);switch(e){case Q.packet.publicKey:case Q.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=a,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case Q.packet.userID:case Q.packet.userAttribute:r=new eo(a,this),this.users.push(r);break;case Q.packet.publicSubkey:case Q.packet.secretSubkey:r=null,i=new to(a,this),this.subkeys.push(i);break;case Q.packet.signature:switch(a.signatureType){case Q.signature.certGeneric:case Q.signature.certPersona:case Q.signature.certCasual:case Q.signature.certPositive:if(!r){N.printDebug("Dropping certification signatures without preceding user packet");continue}a.issuerKeyID.equals(n)?r.selfCertifications.push(a):r.otherCertifications.push(a);break;case Q.signature.certRevocation:r?r.revocationSignatures.push(a):this.directSignatures.push(a);break;case Q.signature.key:this.directSignatures.push(a);break;case Q.signature.subkeyBinding:if(!i){N.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}i.bindingSignatures.push(a);break;case Q.signature.keyRevocation:this.revocationSignatures.push(a);break;case Q.signature.subkeyRevocation:if(!i){N.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}i.revocationSignatures.push(a)}}}}toPacketList(){const e=new ua;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map((t=>e.push(...t.toPacketList()))),this.subkeys.map((t=>e.push(...t.toPacketList()))),e}clone(e=!1){const t=new this.constructor(this.toPacketList());return e&&t.getKeys().forEach((e=>{if(e.keyPacket=Object.create(Object.getPrototypeOf(e.keyPacket),Object.getOwnPropertyDescriptors(e.keyPacket)),!e.keyPacket.isDecrypted())return;const t={};Object.keys(e.keyPacket.privateParams).forEach((r=>{t[r]=new Uint8Array(e.keyPacket.privateParams[r])})),e.keyPacket.privateParams=t})),t}getSubkeys(e=null){return this.subkeys.filter((t=>!e||t.getKeyID().equals(e,!0)))}getKeys(e=null){const t=[];return e&&!this.getKeyID().equals(e,!0)||t.push(this),t.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map((e=>e.getKeyID()))}getUserIDs(){return this.users.map((e=>e.userID?e.userID.userID:null)).filter((e=>null!==e))}write(){return this.toPacketList().write()}async getSigningKey(e=null,t=new Date,r={},n=O){await this.verifyPrimaryKey(t,r,n);const i=this.keyPacket;try{Xa(i,n)}catch(e){throw N.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort(((e,t)=>t.keyPacket.created-e.keyPacket.created));let a;for(const r of s)if(!e||r.getKeyID().equals(e))try{await r.verify(t,n);const e={key:i,bind:r.keyPacket},s=await Ha(r.bindingSignatures,i,Q.signature.subkeyBinding,e,t,n);if(!$a(r.keyPacket,s,n))continue;if(!s.embeddedSignature)throw Error("Missing embedded signature");return await Ha([s.embeddedSignature],r.keyPacket,Q.signature.keyBinding,e,t,n),Xa(r.keyPacket,n),r}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,n);if((!e||i.getKeyID().equals(e))&&$a(i,s,n))return Xa(i,n),this}catch(e){a=e}throw N.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),a)}async getEncryptionKey(e,t=new Date,r={},n=O){await this.verifyPrimaryKey(t,r,n);const i=this.keyPacket;try{Xa(i,n)}catch(e){throw N.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort(((e,t)=>t.keyPacket.created-e.keyPacket.created));let a;for(const r of s)if(!e||r.getKeyID().equals(e))try{await r.verify(t,n);const e={key:i,bind:r.keyPacket},s=await Ha(r.bindingSignatures,i,Q.signature.subkeyBinding,e,t,n);if(Ya(r.keyPacket,s,n))return Xa(r.keyPacket,n),r}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,n);if((!e||i.getKeyID().equals(e))&&Ya(i,s,n))return Xa(i,n),this}catch(e){a=e}throw N.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),a)}async isRevoked(e,t,r=new Date,n=O){return Va(this.keyPacket,Q.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,t,r,n)}async verifyPrimaryKey(e=new Date,t={},r=O){const n=this.keyPacket;if(await this.isRevoked(null,null,e,r))throw Error("Primary key is revoked");if(za(n,await this.getPrimarySelfSignature(e,t,r),e))throw Error("Primary key is expired");if(6!==n.version){const t=await Ha(this.directSignatures,n,Q.signature.key,{key:n},e,r).catch((()=>{}));if(t&&za(n,t,e))throw Error("Primary key is expired")}}async getExpirationTime(e,t=O){let r;try{const n=await this.getPrimarySelfSignature(null,e,t),i=Ja(this.keyPacket,n),s=n.getExpirationTime(),a=6!==this.keyPacket.version&&await Ha(this.directSignatures,this.keyPacket,Q.signature.key,{key:this.keyPacket},null,t).catch((()=>{}));if(a){const e=Ja(this.keyPacket,a);r=Math.min(i,s,e)}else r=i<s?i:s}catch(e){r=null}return N.normalizeDate(r)}async getPrimarySelfSignature(e=new Date,t={},r=O){const n=this.keyPacket;if(6===n.version)return Ha(this.directSignatures,n,Q.signature.key,{key:n},e,r);const{selfCertification:i}=await this.getPrimaryUser(e,t,r);return i}async getPrimaryUser(e=new Date,t={},r=O){const n=this.keyPacket,i=[];let s;for(let a=0;a<this.users.length;a++)try{const s=this.users[a];if(!s.userID)continue;if(void 0!==t.name&&s.userID.name!==t.name||void 0!==t.email&&s.userID.email!==t.email||void 0!==t.comment&&s.userID.comment!==t.comment)throw Error("Could not find user that matches that user ID");const o={userID:s.userID,key:n},c=await Ha(s.selfCertifications,n,Q.signature.certGeneric,o,e,r);i.push({index:a,user:s,selfCertification:c})}catch(e){s=e}if(!i.length)throw s||Error("Could not find primary user");await Promise.all(i.map((async function(t){return t.selfCertification.revoked||t.user.isRevoked(t.selfCertification,null,e,r)})));const a=i.sort((function(e,t){const r=e.selfCertification,n=t.selfCertification;return n.revoked-r.revoked||r.isPrimaryUserID-n.isPrimaryUserID||r.created-n.created})).pop(),{user:o,selfCertification:c}=a;if(c.revoked||await o.isRevoked(c,null,e,r))throw Error("Primary user is revoked");return a}async update(e,t=new Date,r=O){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(this.subkeys.length!==e.subkeys.length||!this.subkeys.every((t=>e.subkeys.some((e=>t.hasSameFingerprintAs(e))))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,r)}const n=this.clone();return await qa(e,n,"revocationSignatures",t,(i=>Va(n.keyPacket,Q.signature.keyRevocation,n,[i],null,e.keyPacket,t,r))),await qa(e,n,"directSignatures",t),await Promise.all(e.users.map((async e=>{const i=n.users.filter((t=>e.userID&&e.userID.equals(t.userID)||e.userAttribute&&e.userAttribute.equals(t.userAttribute)));if(i.length>0)await Promise.all(i.map((n=>n.update(e,t,r))));else{const t=e.clone();t.mainKey=n,n.users.push(t)}}))),await Promise.all(e.subkeys.map((async e=>{const i=n.subkeys.filter((t=>t.hasSameFingerprintAs(e)));if(i.length>0)await Promise.all(i.map((n=>n.update(e,t,r))));else{const t=e.clone();t.mainKey=n,n.subkeys.push(t)}}))),n}async getRevocationCertificate(e=new Date,t=O){const r={key:this.keyPacket},n=await Ha(this.revocationSignatures,this.keyPacket,Q.signature.keyRevocation,r,e,t),i=new ua;i.push(n);const s=6!==this.keyPacket.version;return re(Q.armor.publicKey,i.write(),null,null,"This is a revocation certificate",s,t)}async applyRevocationCertificate(e,t=new Date,r=O){const n=await te(e),i=(await ua.fromBinary(n.data,ro,r)).findPacket(Q.packet.signature);if(!i||i.signatureType!==Q.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!i.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await i.verify(this.keyPacket,Q.signature.keyRevocation,{key:this.keyPacket},t,void 0,r)}catch(e){throw N.wrapError("Could not verify revocation signature",e)}const s=this.clone();return s.revocationSignatures.push(i),s}async signPrimaryUser(e,t,r,n=O){const{index:i,user:s}=await this.getPrimaryUser(t,r,n),a=await s.certify(e,t,n),o=this.clone();return o.users[i]=a,o}async signAllUsers(e,t=new Date,r=O){const n=this.clone();return n.users=await Promise.all(this.users.map((function(n){return n.certify(e,t,r)}))),n}async verifyPrimaryUser(e,t=new Date,r,n=O){const i=this.keyPacket,{user:s}=await this.getPrimaryUser(t,r,n);return e?await s.verifyAllCertifications(e,t,n):[{keyID:i.getKeyID(),valid:await s.verify(t,n).catch((()=>!1))}]}async verifyAllUsers(e,t=new Date,r=O){const n=this.keyPacket,i=[];return await Promise.all(this.users.map((async s=>{const a=e?await s.verifyAllCertifications(e,t,r):[{keyID:n.getKeyID(),valid:await s.verify(t,r).catch((()=>!1))}];i.push(...a.map((e=>({userID:s.userID?s.userID.userID:null,userAttribute:s.userAttribute,keyID:e.keyID,valid:e.valid}))))}))),i}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach((e=>{so.prototype[e]=to.prototype[e]}));class ao extends so{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([Q.packet.secretKey,Q.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=O){const t=6!==this.keyPacket.version;return re(Q.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,t,e)}}class oo extends ao{constructor(e){if(super(),this.packetListToStructure(e,new Set([Q.packet.publicKey,Q.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const e=new ua,t=this.toPacketList();for(const r of t)switch(r.constructor.tag){case Q.packet.secretKey:{const t=Sa.fromSecretKeyPacket(r);e.push(t);break}case Q.packet.secretSubkey:{const t=Pa.fromSecretSubkeyPacket(r);e.push(t);break}default:e.push(r)}return new ao(e)}armor(e=O){const t=6!==this.keyPacket.version;return re(Q.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,t,e)}async getDecryptionKeys(e,t=new Date,r={},n=O){const i=this.keyPacket,s=[];let a=null;for(let r=0;r<this.subkeys.length;r++)if(!e||this.subkeys[r].getKeyID().equals(e,!0)){if(this.subkeys[r].keyPacket.isDummy()){a=a||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const e={key:i,bind:this.subkeys[r].keyPacket},a=await Ha(this.subkeys[r].bindingSignatures,i,Q.signature.subkeyBinding,e,t,n);Za(this.subkeys[r].keyPacket,a,n)&&s.push(this.subkeys[r])}catch(e){a=e}}const o=await this.getPrimarySelfSignature(t,r,n);if(e&&!i.getKeyID().equals(e,!0)||!Za(i,o,n)||(i.isDummy()?a=a||Error("Gnu-dummy key packets cannot be used for decryption"):s.push(this)),0===s.length)throw a||Error("No decryption key packets found");return s}isDecrypted(){return this.getKeys().some((({keyPacket:e})=>e.isDecrypted()))}async validate(e=O){if(!this.isPrivate())throw Error("Cannot validate a public key");let t;if(this.keyPacket.isDummy()){const r=await this.getSigningKey(null,null,void 0,{...e,rejectPublicKeyAlgorithms:new Set,minRSABits:0});r&&!r.keyPacket.isDummy()&&(t=r.keyPacket)}else t=this.keyPacket;if(t)return t.validate();{const e=this.getKeys();if(e.map((e=>e.keyPacket.isDummy())).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(e.map((async e=>e.keyPacket.validate())))}}clearPrivateParams(){this.getKeys().forEach((({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()}))}async revoke({flag:e=Q.reasonForRevocation.noReason,string:t=""}={},r=new Date,n=O){if(!this.isPrivate())throw Error("Need private key for revoking");const i={key:this.keyPacket},s=this.clone();return s.revocationSignatures.push(await Ga(i,[],this.keyPacket,{signatureType:Q.signature.keyRevocation,reasonForRevocationFlag:Q.write(Q.reasonForRevocation,e),reasonForRevocationString:t},r,void 0,void 0,void 0,n)),s}async addSubkey(e={}){const t={...O,...e.config};if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<t.minRSABits)throw Error(`rsaBits should be at least ${t.minRSABits}, got: ${e.rsaBits}`);const r=this.keyPacket;if(r.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!r.isDecrypted())throw Error("Key is not decrypted");const n=r.getAlgorithmInfo();n.type=function(e){switch(Q.write(Q.publicKey,e)){case Q.publicKey.rsaEncrypt:case Q.publicKey.rsaEncryptSign:case Q.publicKey.rsaSign:case Q.publicKey.dsa:return"rsa";case Q.publicKey.ecdsa:case Q.publicKey.eddsaLegacy:return"ecc";case Q.publicKey.ed25519:return"curve25519";case Q.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(n.algorithm),n.rsaBits=n.bits||4096,n.curve=n.curve||"curve25519Legacy",e=Wa(e,n);const i=await Na(e,{...t,v6Keys:6===this.keyPacket.version});Xa(i,t);const s=await ja(i,r,e,t),a=this.toPacketList();return a.push(i,s),new oo(a)}}const co=N.constructAllowedPackets([Sa,Pa,Da,Ta,Ra,Ua,ia]);function uo(e){for(const t of e)switch(t.constructor.tag){case Q.packet.secretKey:return new oo(e);case Q.packet.publicKey:return new ao(e)}throw Error("No key packet found")}async function ho(e,t,r,n){r.passphrase&&await e.encrypt(r.passphrase,n),await Promise.all(t.map((async function(e,t){const i=r.subkeys[t].passphrase;i&&await e.encrypt(i,n)})));const i=new ua;function s(e,t){return[t,...e.filter((e=>e!==t))]}function a(){const e={};e.keyFlags=[Q.keyFlags.certifyKeys|Q.keyFlags.signData];const t=s([Q.symmetric.aes256,Q.symmetric.aes128],n.preferredSymmetricAlgorithm);if(e.preferredSymmetricAlgorithms=t,n.aeadProtect){const r=s([Q.aead.gcm,Q.aead.eax,Q.aead.ocb],n.preferredAEADAlgorithm);e.preferredCipherSuites=r.flatMap((e=>t.map((t=>[t,e]))))}return e.preferredHashAlgorithms=s([Q.hash.sha512,Q.hash.sha256,Q.hash.sha3_512,Q.hash.sha3_256],n.preferredHashAlgorithm),e.preferredCompressionAlgorithms=s([Q.compression.uncompressed,Q.compression.zlib,Q.compression.zip],n.preferredCompressionAlgorithm),e.features=[0],e.features[0]|=Q.features.modificationDetection,n.aeadProtect&&(e.features[0]|=Q.features.seipdv2),r.keyExpirationTime>0&&(e.keyExpirationTime=r.keyExpirationTime,e.keyNeverExpires=!1),e}if(i.push(e),6===e.version){const t={key:e},s=a();s.signatureType=Q.signature.key;const o=await Ga(t,[],e,s,r.date,void 0,void 0,void 0,n);i.push(o)}await Promise.all(r.userIDs.map((async function(t,i){const s=Ra.fromObject(t),o={userID:s,key:e},c=6!==e.version?a():{};return c.signatureType=Q.signature.certPositive,0===i&&(c.isPrimaryUserID=!0),{userIDPacket:s,signaturePacket:await Ga(o,[],e,c,r.date,void 0,void 0,void 0,n)}}))).then((e=>{e.forEach((({userIDPacket:e,signaturePacket:t})=>{i.push(e),i.push(t)}))})),await Promise.all(t.map((async function(t,i){const s=r.subkeys[i];return{secretSubkeyPacket:t,subkeySignaturePacket:await ja(t,e,s,n)}}))).then((e=>{e.forEach((({secretSubkeyPacket:e,subkeySignaturePacket:t})=>{i.push(e),i.push(t)}))}));const o={key:e};return i.push(await Ga(o,[],e,{signatureType:Q.signature.keyRevocation,reasonForRevocationFlag:Q.reasonForRevocation.noReason,reasonForRevocationString:""},r.date,void 0,void 0,void 0,n)),r.passphrase&&e.clearPrivateParams(),await Promise.all(t.map((async function(e,t){r.subkeys[t].passphrase&&e.clearPrivateParams()}))),new oo(i)}async function lo({armoredKey:e,binaryKey:t,config:r,...n}){if(r={...O,...r},!e&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!N.isString(e))throw Error("readKey: options.armoredKey must be a string");if(t&&!N.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const i=Object.keys(n);if(i.length>0)throw Error("Unknown option: "+i.join(", "));let s;if(e){const{type:t,data:r}=await te(e);if(t!==Q.armor.publicKey&&t!==Q.armor.privateKey)throw Error("Armored text not of type key");s=r}else s=t;const a=await ua.fromBinary(s,co,r),o=a.indexOfTag(Q.packet.publicKey,Q.packet.secretKey);if(0===o.length)throw Error("No key packet found");return uo(a.slice(o[0],o[1]))}async function fo({armoredKey:e,binaryKey:t,config:r,...n}){if(r={...O,...r},!e&&!t)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!N.isString(e))throw Error("readPrivateKey: options.armoredKey must be a string");if(t&&!N.isUint8Array(t))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const i=Object.keys(n);if(i.length>0)throw Error("Unknown option: "+i.join(", "));let s;if(e){const{type:t,data:r}=await te(e);if(t!==Q.armor.privateKey)throw Error("Armored text not of type private key");s=r}else s=t;const a=await ua.fromBinary(s,co,r),o=a.indexOfTag(Q.packet.publicKey,Q.packet.secretKey);for(let e=0;e<o.length;e++){if(a[o[e]].constructor.tag===Q.packet.publicKey)continue;const t=a.slice(o[e],o[e+1]);return new oo(t)}throw Error("No secret key packet found")}async function yo({armoredKeys:e,binaryKeys:t,config:r,...n}){r={...O,...r};let i=e||t;if(!i)throw Error("readKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(e&&!N.isString(e))throw Error("readKeys: options.armoredKeys must be a string");if(t&&!N.isUint8Array(t))throw Error("readKeys: options.binaryKeys must be a Uint8Array");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(e){const{type:t,data:r}=await te(e);if(t!==Q.armor.publicKey&&t!==Q.armor.privateKey)throw Error("Armored text not of type key");i=r}const a=[],o=await ua.fromBinary(i,co,r),c=o.indexOfTag(Q.packet.publicKey,Q.packet.secretKey);if(0===c.length)throw Error("No key packet found");for(let e=0;e<c.length;e++){const t=uo(o.slice(c[e],c[e+1]));a.push(t)}return a}async function po({armoredKeys:e,binaryKeys:t,config:r}){r={...O,...r};let n=e||t;if(!n)throw Error("readPrivateKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(e&&!N.isString(e))throw Error("readPrivateKeys: options.armoredKeys must be a string");if(t&&!N.isUint8Array(t))throw Error("readPrivateKeys: options.binaryKeys must be a Uint8Array");if(e){const{type:t,data:r}=await te(e);if(t!==Q.armor.privateKey)throw Error("Armored text not of type private key");n=r}const i=[],s=await ua.fromBinary(n,co,r),a=s.indexOfTag(Q.packet.publicKey,Q.packet.secretKey);for(let e=0;e<a.length;e++){if(s[a[e]].constructor.tag===Q.packet.publicKey)continue;const t=s.slice(a[e],a[e+1]),r=new oo(t);i.push(r)}if(0===i.length)throw Error("No secret key packet found");return i}const go=N.constructAllowedPackets([Xs,la,Ea,wa,Ca,ka,Ba,oa,ia]),Ao=N.constructAllowedPackets([Ba]),wo=N.constructAllowedPackets([ia]);class mo{constructor(e){this.packets=e||new ua}getEncryptionKeyIDs(){const e=[];return this.packets.filterByTag(Q.packet.publicKeyEncryptedSessionKey).forEach((function(t){e.push(t.publicKeyID)})),e}getSigningKeyIDs(){const e=this.unwrapCompressed(),t=e.packets.filterByTag(Q.packet.onePassSignature);return t.length>0?t.map((e=>e.issuerKeyID)):e.packets.filterByTag(Q.packet.signature).map((e=>e.issuerKeyID))}async decrypt(e,t,r,n=new Date,i=O){const s=this.packets.filterByTag(Q.packet.symmetricallyEncryptedData,Q.packet.symEncryptedIntegrityProtectedData,Q.packet.aeadEncryptedData);if(0===s.length)throw Error("No encrypted data found");const a=s[0],o=a.cipherAlgorithm,c=r||await this.decryptSessionKeys(e,t,o,n,i);let u=null;const h=Promise.all(c.map((async({algorithm:e,data:t})=>{if(!N.isUint8Array(t)||!a.cipherAlgorithm&&!N.isString(e))throw Error("Invalid session key for decryption.");try{const r=a.cipherAlgorithm||Q.write(Q.symmetric,e);await a.decrypt(r,t,i)}catch(e){N.printDebugError(e),u=e}})));if(x(a.encrypted),a.encrypted=null,await h,!a.packets||!a.packets.length)throw u||Error("Decryption failed.");const l=new mo(a.packets);return a.packets=new ua,l}async decryptSessionKeys(e,t,r,n=new Date,i=O){let s,a=[];if(t){const e=this.packets.filterByTag(Q.packet.symEncryptedSessionKey);if(0===e.length)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(t.map((async function(t,r){let n;n=r?await ua.fromBinary(e.write(),Ao,i):e,await Promise.all(n.map((async function(e){try{await e.decrypt(t),a.push(e)}catch(e){N.printDebugError(e),e instanceof Xi&&(s=e)}})))})))}else{if(!e)throw Error("No key or password specified.");{const t=this.packets.filterByTag(Q.packet.publicKeyEncryptedSessionKey);if(0===t.length)throw Error("No public key encrypted session key packet found.");await Promise.all(t.map((async function(t){await Promise.all(e.map((async function(e){let o;try{o=(await e.getDecryptionKeys(t.publicKeyID,null,void 0,i)).map((e=>e.keyPacket))}catch(e){return void(s=e)}let c=[Q.symmetric.aes256,Q.symmetric.aes128,Q.symmetric.tripledes,Q.symmetric.cast5];try{const t=await e.getPrimarySelfSignature(n,void 0,i);t.preferredSymmetricAlgorithms&&(c=c.concat(t.preferredSymmetricAlgorithms))}catch(e){}await Promise.all(o.map((async function(e){if(!e.isDecrypted())throw Error("Decryption key is not decrypted.");if(!i.constantTimePKCS1Decryption||t.publicKeyAlgorithm!==Q.publicKey.rsaEncrypt&&t.publicKeyAlgorithm!==Q.publicKey.rsaEncryptSign&&t.publicKeyAlgorithm!==Q.publicKey.rsaSign&&t.publicKeyAlgorithm!==Q.publicKey.elgamal)try{await t.decrypt(e);const n=r||t.sessionKeyAlgorithm;if(n&&!c.includes(Q.write(Q.symmetric,n)))throw Error("A non-preferred symmetric algorithm was used.");a.push(t)}catch(e){N.printDebugError(e),s=e}else{const n=t.write();await Promise.all((r?[r]:Array.from(i.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map((async t=>{const r=new ka;r.read(n);const i={sessionKeyAlgorithm:t,sessionKey:Zi.generateSessionKey(t)};try{await r.decrypt(e,i),a.push(r)}catch(e){N.printDebugError(e),s=e}})))}})))}))),x(t.encrypted),t.encrypted=null})))}}if(a.length>0){if(a.length>1){const e=new Set;a=a.filter((t=>{const r=t.sessionKeyAlgorithm+N.uint8ArrayToString(t.sessionKey);return!e.has(r)&&(e.add(r),!0)}))}return a.map((e=>({data:e.sessionKey,algorithm:e.sessionKeyAlgorithm&&Q.read(Q.symmetric,e.sessionKeyAlgorithm)})))}throw s||Error("Session key decryption failed.")}getLiteralData(){const e=this.unwrapCompressed().packets.findPacket(Q.packet.literalData);return e&&e.getBytes()||null}getFilename(){const e=this.unwrapCompressed().packets.findPacket(Q.packet.literalData);return e&&e.getFilename()||null}getText(){const e=this.unwrapCompressed().packets.findPacket(Q.packet.literalData);return e?e.getText():null}static async generateSessionKey(e=[],t=new Date,r=[],n=O){const{symmetricAlgo:i,aeadAlgo:s}=await async function(e=[],t=new Date,r=[],n=O){const i=await Promise.all(e.map(((e,i)=>e.getPrimarySelfSignature(t,r[i],n))));if(e.length?i.every((e=>e.features&&e.features[0]&Q.features.seipdv2)):n.aeadProtect){const e={symmetricAlgo:Q.symmetric.aes128,aeadAlgo:Q.aead.ocb},t=[{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:n.preferredAEADAlgorithm},{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:Q.aead.ocb},{symmetricAlgo:Q.symmetric.aes128,aeadAlgo:n.preferredAEADAlgorithm}];for(const e of t)if(i.every((t=>t.preferredCipherSuites&&t.preferredCipherSuites.some((t=>t[0]===e.symmetricAlgo&&t[1]===e.aeadAlgo)))))return e;return e}const s=Q.symmetric.aes128,a=n.preferredSymmetricAlgorithm;return{symmetricAlgo:i.every((e=>e.preferredSymmetricAlgorithms&&e.preferredSymmetricAlgorithms.includes(a)))?a:s,aeadAlgo:void 0}}(e,t,r,n),a=Q.read(Q.symmetric,i),o=s?Q.read(Q.aead,s):void 0;return await Promise.all(e.map((e=>e.getEncryptionKey().catch((()=>null)).then((e=>{if(e&&(e.keyPacket.algorithm===Q.publicKey.x25519||e.keyPacket.algorithm===Q.publicKey.x448)&&!o&&!N.isAES(i))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))))),{data:Zi.generateSessionKey(i),algorithm:a,aeadAlgorithm:o}}async encrypt(e,t,r,n=!1,i=[],s=new Date,a=[],o=O){if(r){if(!N.isUint8Array(r.data)||!N.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)r=await mo.generateSessionKey(e,s,a,o);else{if(!t||!t.length)throw Error("No keys, passwords, or session key provided.");r=await mo.generateSessionKey(void 0,void 0,void 0,o)}const{data:c,algorithm:u,aeadAlgorithm:h}=r,l=await mo.encryptSessionKey(c,u,h,e,t,n,i,s,a,o),f=wa.fromObject({version:h?2:1,aeadAlgorithm:h?Q.write(Q.aead,h):null});f.packets=this.packets;const y=Q.write(Q.symmetric,u);return await f.encrypt(y,c,o),l.packets.push(f),f.packets=new ua,l}static async encryptSessionKey(e,t,r,n,i,s=!1,a=[],o=new Date,c=[],u=O){const h=new ua,l=Q.write(Q.symmetric,t),f=r&&Q.write(Q.aead,r);if(n){const t=await Promise.all(n.map((async function(t,r){const n=await t.getEncryptionKey(a[r],o,c,u),i=ka.fromObject({version:f?6:3,encryptionKeyPacket:n.keyPacket,anonymousRecipient:s,sessionKey:e,sessionKeyAlgorithm:l});return await i.encrypt(n.keyPacket),delete i.sessionKey,i})));h.push(...t)}if(i){const t=async function(e,t){try{return await e.decrypt(t),1}catch(e){return 0}},r=(e,t)=>e+t,n=async function(e,s,a,o){const c=new Ba(u);return c.sessionKey=e,c.sessionKeyAlgorithm=s,a&&(c.aeadAlgorithm=a),await c.encrypt(o,u),u.passwordCollisionCheck&&1!==(await Promise.all(i.map((e=>t(c,e))))).reduce(r)?n(e,s,o):(delete c.sessionKey,c)},s=await Promise.all(i.map((t=>n(e,l,f,t))));h.push(...s)}return new mo(h)}async sign(e=[],t=[],r=null,n=[],i=new Date,s=[],a=[],o=[],c=O){const u=new ua,h=this.packets.findPacket(Q.packet.literalData);if(!h)throw Error("No literal data packet to sign.");const l=await bo(h,e,t,r,n,i,s,a,o,!1,c),f=l.map(((e,t)=>oa.fromSignaturePacket(e,0===t))).reverse();return u.push(...f),u.push(h),u.push(...l),new mo(u)}compress(e,t=O){if(e===Q.compression.uncompressed)return this;const r=new la(t);r.algorithm=e,r.packets=this.packets;const n=new ua;return n.push(r),new mo(n)}async signDetached(e=[],t=[],r=null,n=[],i=[],s=new Date,a=[],o=[],c=O){const u=this.packets.findPacket(Q.packet.literalData);if(!u)throw Error("No literal data packet to sign.");return new Oa(await bo(u,e,t,r,n,i,s,a,o,!0,c))}async verify(e,t=new Date,r=O){const n=this.unwrapCompressed(),i=n.packets.filterByTag(Q.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");h(n.packets.stream)&&n.packets.push(...await D(n.packets.stream,(e=>e||[])));const s=n.packets.filterByTag(Q.packet.onePassSignature).reverse(),a=n.packets.filterByTag(Q.packet.signature);return s.length&&!a.length&&N.isStream(n.packets.stream)&&!h(n.packets.stream)?(await Promise.all(s.map((async e=>{e.correspondingSig=new Promise(((t,r)=>{e.correspondingSigResolve=t,e.correspondingSigReject=r})),e.signatureData=R((async()=>(await e.correspondingSig).signatureData)),e.hashed=D(await e.hash(e.signatureType,i[0],void 0,!1)),e.hashed.catch((()=>{}))}))),n.packets.stream=S(n.packets.stream,(async(e,t)=>{const r=T(e),n=_(t);try{for(let e=0;e<s.length;e++){const{value:t}=await r.read();s[e].correspondingSigResolve(t)}await r.readToEnd(),await n.ready,await n.close()}catch(e){s.forEach((t=>{t.correspondingSigReject(e)})),await n.abort(e)}})),Eo(s,i,e,t,!1,r)):Eo(a,i,e,t,!1,r)}verifyDetached(e,t,r=new Date,n=O){const i=this.unwrapCompressed().packets.filterByTag(Q.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");return Eo(e.packets.filterByTag(Q.packet.signature),i,t,r,!0,n)}unwrapCompressed(){const e=this.packets.filterByTag(Q.packet.compressedData);return e.length?new mo(e[0].packets):this}async appendSignature(e,t=O){await this.packets.read(N.isUint8Array(e)?e:(await te(e)).data,wo,t)}write(){return this.packets.write()}armor(e=O){const t=this.packets[this.packets.length-1],r=t.constructor.tag===wa.tag?2!==t.version:this.packets.some((e=>e.constructor.tag===ia.tag&&6!==e.version));return re(Q.armor.message,this.write(),null,null,null,r,e)}}async function bo(e,t,r=[],n=null,i=[],s=new Date,a=[],o=[],c=[],u=!1,h=O){const l=new ua,f=null===e.text?Q.signature.binary:Q.signature.text;if(await Promise.all(t.map((async(t,n)=>{const l=a[n];if(!t.isPrivate())throw Error("Need private key for signing");const y=await t.getSigningKey(i[n],s,l,h);return Ga(e,r.length?r:[t],y.keyPacket,{signatureType:f},s,o,c,u,h)}))).then((e=>{l.push(...e)})),n){const e=n.packets.filterByTag(Q.packet.signature);l.push(...e)}return l}async function Eo(e,t,r,n=new Date,i=!1,s=O){return Promise.all(e.filter((function(e){return["text","binary"].includes(Q.read(Q.signature,e.signatureType))})).map((async function(e){return async function(e,t,r,n=new Date,i=!1,s=O){let a,o;for(const t of r){const r=t.getKeys(e.issuerKeyID);if(r.length>0){a=t,o=r[0];break}}const c=e instanceof oa?e.correspondingSig:e,u={keyID:e.issuerKeyID,verified:(async()=>{if(!o)throw Error("Could not find signing key with key ID "+e.issuerKeyID.toHex());await e.verify(o.keyPacket,e.signatureType,t[0],n,i,s);const r=await c;if(o.getCreationTime()>r.created)throw Error("Key is newer than the signature");try{await a.getSigningKey(o.getKeyID(),r.created,void 0,s)}catch(e){if(!s.allowInsecureVerificationWithReformattedKeys||!e.message.match(/Signature creation time is in the future/))throw e;await a.getSigningKey(o.getKeyID(),n,void 0,s)}return!0})(),signature:(async()=>{const e=await c,t=new ua;return e&&t.push(e),new Oa(t)})()};return u.signature.catch((()=>{})),u.verified.catch((()=>{})),u}(e,t,r,n,i,s)})))}async function ko({armoredMessage:e,binaryMessage:t,config:r,...n}){r={...O,...r};let i=e||t;if(!i)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(e&&!N.isString(e)&&!N.isStream(e))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!N.isUint8Array(t)&&!N.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=N.isStream(i);if(e){const{type:e,data:t}=await te(i);if(e!==Q.armor.message)throw Error("Armored text not of type message");i=t}const o=await ua.fromBinary(i,go,r),c=new mo(o);return c.fromStream=a,c}async function vo({text:e,binary:t,filename:r,date:n=new Date,format:i=(void 0!==e?"utf8":"binary"),...s}){const a=void 0!==e?e:t;if(void 0===a)throw Error("createMessage: must pass options object containing `text` or `binary`");if(e&&!N.isString(e)&&!N.isStream(e))throw Error("createMessage: options.text must be a string or stream");if(t&&!N.isUint8Array(t)&&!N.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=N.isStream(a),u=new Xs(n);void 0!==e?u.setText(a,Q.write(Q.literal,i)):u.setBytes(a,Q.write(Q.literal,i)),void 0!==r&&u.setFilename(r);const h=new ua;h.push(u);const l=new mo(h);return l.fromStream=c,l}const Bo=N.constructAllowedPackets([ia]);class So{constructor(e,t){if(this.text=N.removeTrailingSpaces(e).replace(/\r?\n/g,"\r\n"),t&&!(t instanceof Oa))throw Error("Invalid signature input");this.signature=t||new Oa(new ua)}getSigningKeyIDs(){const e=[];return this.signature.packets.forEach((function(t){e.push(t.issuerKeyID)})),e}async sign(e,t=[],r=null,n=[],i=new Date,s=[],a=[],o=[],c=O){const u=new Xs;u.setText(this.text);const h=new Oa(await bo(u,e,t,r,n,i,s,a,o,!0,c));return new So(this.text,h)}verify(e,t=new Date,r=O){const n=this.signature.packets.filterByTag(Q.packet.signature),i=new Xs;return i.setText(this.text),Eo(n,[i],e,t,!0,r)}getText(){return this.text.replace(/\r\n/g,"\n")}armor(e=O){const t=this.signature.packets.some((e=>6!==e.version)),r={hash:t?Array.from(new Set(this.signature.packets.map((e=>Q.read(Q.hash,e.hashAlgorithm).toUpperCase())))).join():null,text:this.text,data:this.signature.packets.write()};return re(Q.armor.signed,r,void 0,void 0,void 0,t,e)}}async function Io({cleartextMessage:e,config:t,...r}){if(t={...O,...t},!e)throw Error("readCleartextMessage: must pass options object containing `cleartextMessage`");if(!N.isString(e))throw Error("readCleartextMessage: options.cleartextMessage must be a string");const n=Object.keys(r);if(n.length>0)throw Error("Unknown option: "+n.join(", "));const i=await te(e);if(i.type!==Q.armor.signed)throw Error("No cleartext signed message.");const s=await ua.fromBinary(i.data,Bo,t);!function(e,t){const r=[];if(e.forEach((e=>{const t=e.match(/^Hash: (.+)$/);if(!t)throw Error('Only "Hash" header allowed in cleartext signed message');{const e=t[1].replace(/\s/g,"").split(",").map((e=>{try{return Q.write(Q.hash,e.toLowerCase())}catch(t){throw Error("Unknown hash algorithm in armor header: "+e.toLowerCase())}}));r.push(...e)}})),r.length&&!function(e){const r=e=>t=>e.hashAlgorithm===t;for(let n=0;n<t.length;n++)if(t[n].constructor.tag===Q.packet.signature&&!e.some(r(t[n])))return!1;return!0}(r))throw Error("Hash algorithm mismatch in armor header and signature")}(i.headers,s);const a=new Oa(s);return new So(i.text,a)}async function Co({text:e,...t}){if(!e)throw Error("createCleartextMessage: must pass options object containing `text`");if(!N.isString(e))throw Error("createCleartextMessage: options.text must be a string");const r=Object.keys(t);if(r.length>0)throw Error("Unknown option: "+r.join(", "));return new So(e)}async function Ko({userIDs:e=[],passphrase:t,type:r,curve:n,rsaBits:i=4096,keyExpirationTime:s=0,date:a=new Date,subkeys:o=[{}],format:c="armored",config:u,...h}){jo(u={...O,...u}),r||n?(r=r||"ecc",n=n||"curve25519Legacy"):(r=u.v6Keys?"curve25519":"ecc",n="curve25519Legacy"),e=Go(e);const l=Object.keys(h);if(l.length>0)throw Error("Unknown option: "+l.join(", "));if(0===e.length&&!u.v6Keys)throw Error("UserIDs are required for V4 keys");if("rsa"===r&&i<u.minRSABits)throw Error(`rsaBits should be at least ${u.minRSABits}, got: ${i}`);const f={userIDs:e,passphrase:t,type:r,rsaBits:i,curve:n,keyExpirationTime:s,date:a,subkeys:o};try{const{key:e,revocationCertificate:t}=await async function(e,t){e.sign=!0,(e=Wa(e)).subkeys=e.subkeys.map(((t,r)=>Wa(e.subkeys[r],e)));let r=[Fa(e,t)];r=r.concat(e.subkeys.map((e=>Na(e,t))));const n=await Promise.all(r),i=await ho(n[0],n.slice(1),e,t),s=await i.getRevocationCertificate(e.date,t);return i.revocationSignatures=[],{key:i,revocationCertificate:s}}(f,u);return e.getKeys().forEach((({keyPacket:e})=>Xa(e,u))),{privateKey:Jo(e,c,u),publicKey:Jo(e.toPublic(),c,u),revocationCertificate:t}}catch(e){throw N.wrapError("Error generating keypair",e)}}async function Po({privateKey:e,userIDs:t=[],passphrase:r,keyExpirationTime:n=0,date:i,format:s="armored",config:a,...o}){jo(a={...O,...a}),t=Go(t);const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(0===t.length&&6!==e.keyPacket.version)throw Error("UserIDs are required for V4 keys");const u={privateKey:e,userIDs:t,passphrase:r,keyExpirationTime:n,date:i};try{const{key:e,revocationCertificate:t}=await async function(e,t){e=o(e);const{privateKey:r}=e;if(!r.isPrivate())throw Error("Cannot reformat a public key");if(r.keyPacket.isDummy())throw Error("Cannot reformat a gnu-dummy primary key");if(!r.getKeys().every((({keyPacket:e})=>e.isDecrypted())))throw Error("Key is not decrypted");const n=r.keyPacket;e.subkeys||(e.subkeys=await Promise.all(r.subkeys.map((async e=>{const r=e.keyPacket,i={key:n,bind:r},s=await Ha(e.bindingSignatures,n,Q.signature.subkeyBinding,i,null,t).catch((()=>({})));return{sign:s.keyFlags&&s.keyFlags[0]&Q.keyFlags.signData}}))));const i=r.subkeys.map((e=>e.keyPacket));if(e.subkeys.length!==i.length)throw Error("Number of subkey options does not match number of subkeys");e.subkeys=e.subkeys.map((t=>o(t,e)));const s=await ho(n,i,e,t),a=await s.getRevocationCertificate(e.date,t);return s.revocationSignatures=[],{key:s,revocationCertificate:a};function o(e,t={}){return e.keyExpirationTime=e.keyExpirationTime||t.keyExpirationTime,e.passphrase=N.isString(e.passphrase)?e.passphrase:t.passphrase,e.date=e.date||t.date,e}}(u,a);return{privateKey:Jo(e,s,a),publicKey:Jo(e.toPublic(),s,a),revocationCertificate:t}}catch(e){throw N.wrapError("Error reformatting keypair",e)}}async function Uo({key:e,revocationCertificate:t,reasonForRevocation:r,date:n=new Date,format:i="armored",config:s,...a}){jo(s={...O,...s});const o=Object.keys(a);if(o.length>0)throw Error("Unknown option: "+o.join(", "));try{const a=t?await e.applyRevocationCertificate(t,n,s):await e.revoke(r,n,s);return a.isPrivate()?{privateKey:Jo(a,i,s),publicKey:Jo(a.toPublic(),i,s)}:{privateKey:null,publicKey:Jo(a,i,s)}}catch(e){throw N.wrapError("Error revoking key",e)}}async function Do({privateKey:e,passphrase:t,config:r,...n}){jo(r={...O,...r});const i=Object.keys(n);if(i.length>0)throw Error("Unknown option: "+i.join(", "));if(!e.isPrivate())throw Error("Cannot decrypt a public key");const s=e.clone(!0),a=N.isArray(t)?t:[t];try{return await Promise.all(s.getKeys().map((e=>N.anyPromise(a.map((t=>e.keyPacket.decrypt(t))))))),await s.validate(r),s}catch(e){throw s.clearPrivateParams(),N.wrapError("Error decrypting private key",e)}}async function xo({privateKey:e,passphrase:t,config:r,...n}){jo(r={...O,...r});const i=Object.keys(n);if(i.length>0)throw Error("Unknown option: "+i.join(", "));if(!e.isPrivate())throw Error("Cannot encrypt a public key");const s=e.clone(!0),a=s.getKeys(),o=N.isArray(t)?t:Array(a.length).fill(t);if(o.length!==a.length)throw Error("Invalid number of passphrases given for key encryption");try{return await Promise.all(a.map((async(e,t)=>{const{keyPacket:n}=e;await n.encrypt(o[t],r),n.clearPrivateParams()}))),s}catch(e){throw s.clearPrivateParams(),N.wrapError("Error encrypting private key",e)}}async function Ro({message:e,encryptionKeys:t,signingKeys:r,passwords:n,sessionKey:i,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:u=[],date:h=new Date,signingUserIDs:l=[],encryptionUserIDs:f=[],signatureNotations:y=[],config:d,...p}){if(jo(d={...O,...d}),No(e),Ho(s),t=Go(t),r=Go(r),n=Go(n),c=Go(c),u=Go(u),l=Go(l),f=Go(f),y=Go(y),p.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(p.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(p.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(void 0!==p.armor)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const g=Object.keys(p);if(g.length>0)throw Error("Unknown option: "+g.join(", "));r||(r=[]);try{if((r.length||a)&&(e=await e.sign(r,t,a,c,h,l,u,y,d)),e=e.compress(await async function(e=[],t=new Date,r=[],n=O){const i=Q.compression.uncompressed,s=n.preferredCompressionAlgorithm,a=await Promise.all(e.map((async function(e,i){const a=(await e.getPrimarySelfSignature(t,r[i],n)).preferredCompressionAlgorithms;return!!a&&a.indexOf(s)>=0})));return a.every(Boolean)?s:i}(t,h,f,d),d),e=await e.encrypt(t,n,i,o,u,h,f,d),"object"===s)return e;const p="armored"===s?e.armor(d):e.write();return await qo(p)}catch(e){throw N.wrapError("Error encrypting message",e)}}async function To({message:e,decryptionKeys:t,passwords:r,sessionKeys:n,verificationKeys:i,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:u,...h}){if(jo(u={...O,...u}),No(e),i=Go(i),t=Go(t),r=Go(r),n=Go(n),h.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(h.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const l=Object.keys(h);if(l.length>0)throw Error("Unknown option: "+l.join(", "));try{const h=await e.decrypt(t,r,n,c,u);i||(i=[]);const l={};if(l.signatures=o?await h.verifyDetached(o,i,c,u):await h.verify(i,c,u),l.data="binary"===a?h.getLiteralData():h.getText(),l.filename=h.getFilename(),Vo(l,e),s){if(0===i.length)throw Error("Verification keys are required to verify message signatures");if(0===l.signatures.length)throw Error("Message is not signed");l.data=b([l.data,R((async()=>(await N.anyPromise(l.signatures.map((e=>e.verified))),"binary"===a?new Uint8Array:"")))])}return l.data=await qo(l.data),l}catch(e){throw N.wrapError("Error decrypting message",e)}}async function _o({message:e,signingKeys:t,recipientKeys:r=[],format:n="armored",detached:i=!1,signingKeyIDs:s=[],date:a=new Date,signingUserIDs:o=[],recipientUserIDs:c=[],signatureNotations:u=[],config:h,...l}){if(jo(h={...O,...h}),Fo(e),Ho(n),t=Go(t),s=Go(s),o=Go(o),r=Go(r),c=Go(c),u=Go(u),l.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.sign, pass `signingKeys` instead");if(void 0!==l.armor)throw Error("The `armor` option has been removed from openpgp.sign, pass `format` instead.");const f=Object.keys(l);if(f.length>0)throw Error("Unknown option: "+f.join(", "));if(e instanceof So&&"binary"===n)throw Error("Cannot return signed cleartext message in binary format");if(e instanceof So&&i)throw Error("Cannot detach-sign a cleartext message");if(!t||0===t.length)throw Error("No signing keys provided");try{let l;return l=i?await e.signDetached(t,r,void 0,s,a,o,c,u,h):await e.sign(t,r,void 0,s,a,o,c,u,h),"object"===n?l:(l="armored"===n?l.armor(h):l.write(),i&&(l=S(e.packets.write(),(async(e,t)=>{await Promise.all([E(l,t),D(e).catch((()=>{}))])}))),await qo(l))}catch(e){throw N.wrapError("Error signing message",e)}}async function Lo({message:e,verificationKeys:t,expectSigned:r=!1,format:n="utf8",signature:i=null,date:s=new Date,config:a,...o}){if(jo(a={...O,...a}),Fo(e),t=Go(t),o.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.verify, pass `verificationKeys` instead");const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(e instanceof So&&"binary"===n)throw Error("Can't return cleartext message data as binary");if(e instanceof So&&i)throw Error("Can't verify detached cleartext signature");try{const o={};if(o.signatures=i?await e.verifyDetached(i,t,s,a):await e.verify(t,s,a),o.data="binary"===n?e.getLiteralData():e.getText(),e.fromStream&&!i&&Vo(o,e),r){if(0===o.signatures.length)throw Error("Message is not signed");o.data=b([o.data,R((async()=>(await N.anyPromise(o.signatures.map((e=>e.verified))),"binary"===n?new Uint8Array:"")))])}return o.data=await qo(o.data),o}catch(e){throw N.wrapError("Error verifying signed message",e)}}async function Qo({encryptionKeys:e,date:t=new Date,encryptionUserIDs:r=[],config:n,...i}){if(jo(n={...O,...n}),e=Go(e),r=Go(r),i.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.generateSessionKey, pass `encryptionKeys` instead");const s=Object.keys(i);if(s.length>0)throw Error("Unknown option: "+s.join(", "));try{return await mo.generateSessionKey(e,t,r,n)}catch(e){throw N.wrapError("Error generating session key",e)}}async function Oo({data:e,algorithm:t,aeadAlgorithm:r,encryptionKeys:n,passwords:i,format:s="armored",wildcard:a=!1,encryptionKeyIDs:o=[],date:c=new Date,encryptionUserIDs:u=[],config:h,...l}){if(jo(h={...O,...h}),function(e){if(!N.isUint8Array(e))throw Error("Parameter [data] must be of type Uint8Array")}(e),function(e){if(!N.isString(e))throw Error("Parameter [algorithm] must be of type String")}(t),Ho(s),n=Go(n),i=Go(i),o=Go(o),u=Go(u),l.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encryptSessionKey, pass `encryptionKeys` instead");const f=Object.keys(l);if(f.length>0)throw Error("Unknown option: "+f.join(", "));if(!(n&&0!==n.length||i&&0!==i.length))throw Error("No encryption keys or passwords provided.");try{return Jo(await mo.encryptSessionKey(e,t,r,n,i,a,o,c,u,h),s,h)}catch(e){throw N.wrapError("Error encrypting session key",e)}}async function Mo({message:e,decryptionKeys:t,passwords:r,date:n=new Date,config:i,...s}){if(jo(i={...O,...i}),No(e),t=Go(t),r=Go(r),s.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decryptSessionKeys, pass `decryptionKeys` instead");const a=Object.keys(s);if(a.length>0)throw Error("Unknown option: "+a.join(", "));try{return await e.decryptSessionKeys(t,r,void 0,n,i)}catch(e){throw N.wrapError("Error decrypting session keys",e)}}function No(e){if(!(e instanceof mo))throw Error("Parameter [message] needs to be of type Message")}function Fo(e){if(!(e instanceof So||e instanceof mo))throw Error("Parameter [message] needs to be of type Message or CleartextMessage")}function Ho(e){if("armored"!==e&&"binary"!==e&&"object"!==e)throw Error("Unsupported format "+e)}const zo=Object.keys(O).length;function jo(e){const t=Object.keys(e);if(t.length!==zo)for(const e of t)if(void 0===O[e])throw Error("Unknown config property: "+e)}function Go(e){return e&&!N.isArray(e)&&(e=[e]),e}async function qo(e){return"array"===N.isStream(e)?D(e):e}function Vo(e,t){e.data=S(t.packets.stream,(async(t,r)=>{await E(e.data,r,{preventClose:!0});const n=_(r);try{await D(t,(e=>e)),await n.close()}catch(e){await n.abort(e)}}))}function Jo(e,t,r){switch(t){case"object":return e;case"armored":return e.armor(r);case"binary":return e.write();default:throw Error("Unsupported format "+t)}}function Wo(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, not "+e)}function $o(e,...t){if(!((r=e)instanceof Uint8Array||null!=r&&"object"==typeof r&&"Uint8Array"===r.constructor.name))throw Error("Uint8Array expected");var r;if(t.length>0&&!t.includes(e.length))throw Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Yo(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function Zo(e,t){$o(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}const Xo="object"==typeof n&&"crypto"in n?n.crypto:void 0,ec=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),tc=(e,t)=>e<<32-t|e>>>t,rc=(e,t)=>e<<t|e>>>32-t>>>0,nc=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function ic(e){for(let r=0;r<e.length;r++)e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t}function sc(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function ac(e){return"string"==typeof e&&(e=sc(e)),$o(e),e}function oc(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];$o(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}class cc{clone(){return this._cloneInto()}}function uc(e){const t=t=>e().update(ac(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function hc(e=32){if(Xo&&"function"==typeof Xo.getRandomValues)return Xo.getRandomValues(new Uint8Array(e));if(Xo&&"function"==typeof Xo.randomBytes)return Xo.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}const lc=(e,t,r)=>e&t^~e&r,fc=(e,t,r)=>e&t^e&r^t&r;class yc extends cc{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ec(this.buffer)}update(e){Yo(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=ac(e)).length;for(let s=0;s<i;){const a=Math.min(n-this.pos,i-s);if(a!==n)r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=ec(e);for(;n<=i-s;s+=n)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Yo(this),Zo(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>n-s&&(this.process(r,0),s=0);for(let e=s;e<n;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,a,n),e.setUint32(t+u,o,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const a=ec(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,u=this.get();if(c>u.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:a}=this;return e.length=n,e.pos=a,e.finished=i,e.destroyed=s,n%t&&e.buffer.set(r),e}}const dc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),pc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),gc=new Uint32Array(64);class Ac extends yc{constructor(){super(64,32,8,!1),this.A=0|pc[0],this.B=0|pc[1],this.C=0|pc[2],this.D=0|pc[3],this.E=0|pc[4],this.F=0|pc[5],this.G=0|pc[6],this.H=0|pc[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:a,H:o}=this;return[e,t,r,n,i,s,a,o]}set(e,t,r,n,i,s,a,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)gc[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=gc[e-15],r=gc[e-2],n=tc(t,7)^tc(t,18)^t>>>3,i=tc(r,17)^tc(r,19)^r>>>10;gc[e]=i+gc[e-7]+n+gc[e-16]|0}let{A:r,B:n,C:i,D:s,E:a,F:o,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(tc(a,6)^tc(a,11)^tc(a,25))+lc(a,o,c)+dc[e]+gc[e]|0,h=(tc(r,2)^tc(r,13)^tc(r,22))+fc(r,n,i)|0;u=c,c=o,o=a,a=s+t|0,s=i,i=n,n=r,r=t+h|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,s,a,o,c,u)}roundClean(){gc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class wc extends Ac{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const mc=uc((()=>new Ac)),bc=uc((()=>new wc));class Ec extends cc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");Wo(e.outputLen),Wo(e.blockLen)}(e);const r=ac(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return Yo(this),this.iHash.update(e),this}digestInto(e){Yo(this),$o(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:a}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const kc=(e,t,r)=>new Ec(e,t).update(r).digest();kc.create=(e,t)=>new Ec(e,t);const vc=BigInt(0),Bc=BigInt(1),Sc=BigInt(2);function Ic(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function Cc(e){if(!Ic(e))throw Error("Uint8Array expected")}function Kc(e,t){if("boolean"!=typeof t)throw Error(`${e} must be valid boolean, got "${t}".`)}const Pc=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Uc(e){Cc(e);let t="";for(let r=0;r<e.length;r++)t+=Pc[e[r]];return t}function Dc(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function xc(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x"+e)}function Rc(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function Tc(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=Rc(e.charCodeAt(i)),s=Rc(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n}function _c(e){return xc(Uc(e))}function Lc(e){return Cc(e),xc(Uc(Uint8Array.from(e).reverse()))}function Qc(e,t){return Tc(e.toString(16).padStart(2*t,"0"))}function Oc(e,t){return Qc(e,t).reverse()}function Mc(e,t,r){let n;if("string"==typeof t)try{n=Tc(t)}catch(r){throw Error(`${e} must be valid hex string, got "${t}". Cause: ${r}`)}else{if(!Ic(t))throw Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw Error(`${e} expected ${r} bytes, got ${i}`);return n}function Nc(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];Cc(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const Fc=e=>"bigint"==typeof e&&vc<=e;function Hc(e,t,r){return Fc(e)&&Fc(t)&&Fc(r)&&t<=e&&e<r}function zc(e,t,r,n){if(!Hc(t,r,n))throw Error(`expected valid ${e}: ${r} <= n < ${n}, got ${typeof t} ${t}`)}function jc(e){let t;for(t=0;e>vc;e>>=Bc,t+=1);return t}const Gc=e=>(Sc<<BigInt(e-1))-Bc,qc=e=>new Uint8Array(e),Vc=e=>Uint8Array.from(e);function Jc(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=qc(e),i=qc(e),s=0;const a=()=>{n.fill(1),i.fill(0),s=0},o=(...e)=>r(i,n,...e),c=(e=qc())=>{i=o(Vc([0]),e),n=o(),0!==e.length&&(i=o(Vc([1]),e),n=o())},u=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){n=o();const t=n.slice();r.push(t),e+=n.length}return Nc(...r)};return(e,t)=>{let r;for(a(),c(e);!(r=t(u()));)c();return a(),r}}const Wc={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||Ic(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function $c(e,t,r={}){const n=(t,r,n)=>{const i=Wc[r];if("function"!=typeof i)throw Error(`Invalid validator "${r}", expected function`);const s=e[t];if(!(n&&void 0===s||i(s,e)))throw Error(`Invalid param ${t+""}=${s} (${typeof s}), expected ${r}`)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function Yc(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}var Zc=Object.freeze({__proto__:null,aInRange:zc,abool:Kc,abytes:Cc,bitGet:function(e,t){return e>>BigInt(t)&Bc},bitLen:jc,bitMask:Gc,bitSet:function(e,t,r){return e|(r?Bc:vc)<<BigInt(t)},bytesToHex:Uc,bytesToNumberBE:_c,bytesToNumberLE:Lc,concatBytes:Nc,createHmacDrbg:Jc,ensureBytes:Mc,equalBytes:function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},hexToBytes:Tc,hexToNumber:xc,inRange:Hc,isBytes:Ic,memoized:Yc,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:Qc,numberToBytesLE:Oc,numberToHexUnpadded:Dc,numberToVarBytesBE:function(e){return Tc(Dc(e))},utf8ToBytes:function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))},validateObject:$c});const Xc=BigInt(0),eu=BigInt(1),tu=BigInt(2),ru=BigInt(3),nu=BigInt(4),iu=BigInt(5),su=BigInt(8);function au(e,t){const r=e%t;return r>=Xc?r:t+r}function ou(e,t,r){if(r<=Xc||t<Xc)throw Error("Expected power/modulo > 0");if(r===eu)return Xc;let n=eu;for(;t>Xc;)t&eu&&(n=n*e%r),e=e*e%r,t>>=eu;return n}function cu(e,t,r){let n=e;for(;t-- >Xc;)n*=n,n%=r;return n}function uu(e,t){if(e===Xc||t<=Xc)throw Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=au(e,t),n=t,i=Xc,s=eu;for(;r!==Xc;){const e=n%r,t=i-s*(n/r);n=r,r=e,i=s,s=t}if(n!==eu)throw Error("invert: does not exist");return au(i,t)}BigInt(9),BigInt(16);const hu=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function lu(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function fu(e,t,r=!1,n={}){if(e<=Xc)throw Error("Expected Field ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=lu(e,t);if(s>2048)throw Error("Field lengths over 2048 bytes are not supported");const a=function(e){if(e%nu===ru){const t=(e+eu)/nu;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}if(e%su===iu){const t=(e-iu)/su;return function(e,r){const n=e.mul(r,tu),i=e.pow(n,t),s=e.mul(r,i),a=e.mul(e.mul(s,tu),i),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),r))throw Error("Cannot find square root");return o}}return function(e){const t=(e-eu)/tu;let r,n,i;for(r=e-eu,n=0;r%tu===Xc;r/=tu,n++);for(i=tu;i<e&&ou(i,t,e)!==e-eu;i++);if(1===n){const t=(e+eu)/nu;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}const s=(r+eu)/tu;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw Error("Cannot find square root");let o=n,c=e.pow(e.mul(e.ONE,i),r),u=e.pow(a,s),h=e.pow(a,r);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(h);t<o&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const r=e.pow(c,eu<<BigInt(o-t-1));c=e.sqr(r),u=e.mul(u,r),h=e.mul(h,c),o=t}return u}}(e)}(e),o=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:Gc(i),ZERO:Xc,ONE:eu,create:t=>au(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("Invalid field element: expected bigint, got "+typeof t);return Xc<=t&&t<e},is0:e=>e===Xc,isOdd:e=>(e&eu)===eu,neg:t=>au(-t,e),eql:(e,t)=>e===t,sqr:t=>au(t*t,e),add:(t,r)=>au(t+r,e),sub:(t,r)=>au(t-r,e),mul:(t,r)=>au(t*r,e),pow:(e,t)=>function(e,t,r){if(r<Xc)throw Error("Expected power > 0");if(r===Xc)return e.ONE;if(r===eu)return t;let n=e.ONE,i=t;for(;r>Xc;)r&eu&&(n=e.mul(n,i)),i=e.sqr(i),r>>=eu;return n}(o,e,t),div:(t,r)=>au(t*uu(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>uu(t,e),sqrt:n.sqrt||(e=>a(o,e)),invertBatch:e=>function(e,t){const r=Array(t.length),n=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),i=e.inv(n);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),i),r}(o,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?Oc(e,s):Qc(e,s),fromBytes:e=>{if(e.length!==s)throw Error(`Fp.fromBytes: expected ${s}, got ${e.length}`);return r?Lc(e):_c(e)}});return Object.freeze(o)}function yu(e){if("bigint"!=typeof e)throw Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function du(e){const t=yu(e);return t+Math.ceil(t/2)}const pu=BigInt(0),gu=BigInt(1),Au=new WeakMap,wu=new WeakMap;function mu(e,t){const r=(e,t)=>{const r=t.negate();return e?r:t},n=e=>{if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error(`Wrong window size=${e}, should be [1..${t}]`)},i=e=>(n(e),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:r,unsafeLadder(t,r){let n=e.ZERO,i=t;for(;r>pu;)r&gu&&(n=n.add(i)),i=i.double(),r>>=gu;return n},precomputeWindow(e,t){const{windows:r,windowSize:n}=i(t),s=[];let a=e,o=a;for(let e=0;e<r;e++){o=a,s.push(o);for(let e=1;e<n;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(t,n,s){const{windows:a,windowSize:o}=i(t);let c=e.ZERO,u=e.BASE;const h=BigInt(2**t-1),l=2**t,f=BigInt(t);for(let e=0;e<a;e++){const t=e*o;let i=Number(s&h);s>>=f,i>o&&(i-=l,s+=gu);const a=t,y=t+Math.abs(i)-1,d=e%2!=0,p=i<0;0===i?u=u.add(r(d,n[a])):c=c.add(r(p,n[y]))}return{p:c,f:u}},wNAFCached(e,t,r){const n=wu.get(e)||1;let i=Au.get(e);return i||(i=this.precomputeWindow(e,n),1!==n&&Au.set(e,r(i))),this.wNAF(n,i,t)},setWindowSize(e,t){n(t),wu.set(e,t),Au.delete(e)}}}function bu(e,t,r,n){if(!Array.isArray(r)||!Array.isArray(n)||n.length!==r.length)throw Error("arrays of points and scalars must have equal length");n.forEach(((e,r)=>{if(!t.isValid(e))throw Error("wrong scalar at index "+r)})),r.forEach(((t,r)=>{if(!(t instanceof e))throw Error("wrong point at index "+r)}));const i=jc(BigInt(r.length)),s=i>12?i-3:i>4?i-2:i?2:1,a=(1<<s)-1,o=Array(a+1).fill(e.ZERO),c=Math.floor((t.BITS-1)/s)*s;let u=e.ZERO;for(let t=c;t>=0;t-=s){o.fill(e.ZERO);for(let e=0;e<n.length;e++){const i=n[e],s=Number(i>>BigInt(t)&BigInt(a));o[s]=o[s].add(r[e])}let i=e.ZERO;for(let t=o.length-1,r=e.ZERO;t>0;t--)r=r.add(o[t]),i=i.add(r);if(u=u.add(i),0!==t)for(let e=0;e<s;e++)u=u.double()}return u}function Eu(e){return $c(e.Fp,hu.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),$c(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...lu(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function ku(e){void 0!==e.lowS&&Kc("lowS",e.lowS),void 0!==e.prehash&&Kc("prehash",e.prehash)}const{bytesToNumberBE:vu,hexToBytes:Bu}=Zc,Su={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{const{Err:r}=Su;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=Dc(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Dc(i.length/2|128):"";return`${Dc(e)}${s}${i}${t}`},decode(e,t){const{Err:r}=Su;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let s=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const a=t.subarray(n,n+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of a)s=s<<8|e;if(n+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const a=t.subarray(n,n+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+s)}}},_int:{encode(e){const{Err:t}=Su;if(e<Iu)throw new t("integer: negative integers are not allowed");let r=Dc(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected assertion");return r},decode(e){const{Err:t}=Su;if(128&e[0])throw new t("Invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("Invalid signature integer: unnecessary leading zero");return vu(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Su,i="string"==typeof e?Bu(e):e;Cc(i);const{v:s,l:a}=n.decode(48,i);if(a.length)throw new t("Invalid signature: left bytes after parsing");const{v:o,l:c}=n.decode(2,s),{v:u,l:h}=n.decode(2,c);if(h.length)throw new t("Invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(u)}},hexFromSig(e){const{_tlv:t,_int:r}=Su,n=`${t.encode(2,r.encode(e.r))}${t.encode(2,r.encode(e.s))}`;return t.encode(48,n)}},Iu=BigInt(0),Cu=BigInt(1);BigInt(2);const Ku=BigInt(3);function Pu(e){return{hash:e,hmac:(t,...r)=>kc(e,t,oc(...r)),randomBytes:hc}}function Uu(e,t){const r=t=>function(e){const t=function(e){const t=Eu(e);return $c(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function a(e){return au(e,n)}function o(e){return uu(e,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=function(e){const t=function(e){const t=Eu(e);$c(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:r}=t,n=fu(t.n,t.nBitLength),i=t.toBytes||((e,t,n)=>{const i=t.toAffine();return Nc(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),s=t.fromBytes||(e=>{const t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function a(e){const{a:n,b:i}=t,s=r.sqr(e),a=r.mul(s,e);return r.add(r.add(a,r.mul(e,n)),i)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw Error("bad generator point: equation left != right");function o(e){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:s}=t;if(r&&"bigint"!=typeof e){if(Ic(e)&&(e=Uc(e)),"string"!=typeof e||!r.includes(e.length))throw Error("Invalid key");e=e.padStart(2*n,"0")}let a;try{a="bigint"==typeof e?e:_c(Mc("private key",e,n))}catch(t){throw Error(`private key must be ${n} bytes, hex or bigint, not ${typeof e}`)}return i&&(a=au(a,s)),zc("private key",a,Cu,s),a}function c(e){if(!(e instanceof l))throw Error("ProjectivePoint expected")}const u=Yc(((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const a=e.is0();null==t&&(t=a?r.ONE:r.inv(s));const o=r.mul(n,t),c=r.mul(i,t),u=r.mul(s,t);if(a)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw Error("invZ was invalid");return{x:o,y:c}})),h=Yc((e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw Error("bad point: x or y not FE");const s=r.sqr(i),o=a(n);if(!r.eql(s,o))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0}));class l{constructor(e,t,n){if(this.px=e,this.py=t,this.pz=n,null==e||!r.isValid(e))throw Error("x required");if(null==t||!r.isValid(t))throw Error("y required");if(null==n||!r.isValid(n))throw Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw Error("invalid affine point");if(e instanceof l)throw Error("projective point not allowed");const i=e=>r.eql(e,r.ZERO);return i(t)&&i(n)?l.ZERO:new l(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.pz)));return e.map(((e,r)=>e.toAffine(t[r]))).map(l.fromAffine)}static fromHex(e){const t=l.fromAffine(s(Mc("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return l.BASE.multiply(o(e))}static msm(e,t){return bu(l,n,e,t)}_setWindowSize(e){y.setWindowSize(this,e)}assertValidity(){h(this)}hasEvenY(){const{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){c(e);const{px:t,py:n,pz:i}=this,{px:s,py:a,pz:o}=e,u=r.eql(r.mul(t,o),r.mul(s,i)),h=r.eql(r.mul(n,o),r.mul(a,i));return u&&h}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,Ku),{px:s,py:a,pz:o}=this;let c=r.ZERO,u=r.ZERO,h=r.ZERO,f=r.mul(s,s),y=r.mul(a,a),d=r.mul(o,o),p=r.mul(s,a);return p=r.add(p,p),h=r.mul(s,o),h=r.add(h,h),c=r.mul(e,h),u=r.mul(i,d),u=r.add(c,u),c=r.sub(y,u),u=r.add(y,u),u=r.mul(c,u),c=r.mul(p,c),h=r.mul(i,h),d=r.mul(e,d),p=r.sub(f,d),p=r.mul(e,p),p=r.add(p,h),h=r.add(f,f),f=r.add(h,f),f=r.add(f,d),f=r.mul(f,p),u=r.add(u,f),d=r.mul(a,o),d=r.add(d,d),f=r.mul(d,p),c=r.sub(c,f),h=r.mul(d,y),h=r.add(h,h),h=r.add(h,h),new l(c,u,h)}add(e){c(e);const{px:n,py:i,pz:s}=this,{px:a,py:o,pz:u}=e;let h=r.ZERO,f=r.ZERO,y=r.ZERO;const d=t.a,p=r.mul(t.b,Ku);let g=r.mul(n,a),A=r.mul(i,o),w=r.mul(s,u),m=r.add(n,i),b=r.add(a,o);m=r.mul(m,b),b=r.add(g,A),m=r.sub(m,b),b=r.add(n,s);let E=r.add(a,u);return b=r.mul(b,E),E=r.add(g,w),b=r.sub(b,E),E=r.add(i,s),h=r.add(o,u),E=r.mul(E,h),h=r.add(A,w),E=r.sub(E,h),y=r.mul(d,b),h=r.mul(p,w),y=r.add(h,y),h=r.sub(A,y),y=r.add(A,y),f=r.mul(h,y),A=r.add(g,g),A=r.add(A,g),w=r.mul(d,w),b=r.mul(p,b),A=r.add(A,w),w=r.sub(g,w),w=r.mul(d,w),b=r.add(b,w),g=r.mul(A,b),f=r.add(f,g),g=r.mul(E,b),h=r.mul(m,h),h=r.sub(h,g),g=r.mul(m,A),y=r.mul(E,y),y=r.add(y,g),new l(h,f,y)}subtract(e){return this.add(e.negate())}is0(){return this.equals(l.ZERO)}wNAF(e){return y.wNAFCached(this,e,l.normalizeZ)}multiplyUnsafe(e){zc("scalar",e,Iu,t.n);const n=l.ZERO;if(e===Iu)return n;if(e===Cu)return this;const{endo:i}=t;if(!i)return y.unsafeLadder(this,e);let{k1neg:s,k1:a,k2neg:o,k2:c}=i.splitScalar(e),u=n,h=n,f=this;for(;a>Iu||c>Iu;)a&Cu&&(u=u.add(f)),c&Cu&&(h=h.add(f)),f=f.double(),a>>=Cu,c>>=Cu;return s&&(u=u.negate()),o&&(h=h.negate()),h=new l(r.mul(h.px,i.beta),h.py,h.pz),u.add(h)}multiply(e){const{endo:n,n:i}=t;let s,a;if(zc("scalar",e,Cu,i),n){const{k1neg:t,k1:i,k2neg:o,k2:c}=n.splitScalar(e);let{p:u,f:h}=this.wNAF(i),{p:f,f:d}=this.wNAF(c);u=y.constTimeNegate(t,u),f=y.constTimeNegate(o,f),f=new l(r.mul(f.px,n.beta),f.py,f.pz),s=u.add(f),a=h.add(d)}else{const{p:t,f:r}=this.wNAF(e);s=t,a=r}return l.normalizeZ([s,a])[0]}multiplyAndAddUnsafe(e,t,r){const n=l.BASE,i=(e,t)=>t!==Iu&&t!==Cu&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),s=i(this,t).add(i(e,r));return s.is0()?void 0:s}toAffine(e){return u(this,e)}isTorsionFree(){const{h:e,isTorsionFree:r}=t;if(e===Cu)return!0;if(r)return r(l,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:r}=t;return e===Cu?this:r?r(l,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return Kc("isCompressed",e),this.assertValidity(),i(l,this,e)}toHex(e=!0){return Kc("isCompressed",e),Uc(this.toRawBytes(e))}}l.BASE=new l(t.Gx,t.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);const f=t.nBitLength,y=mu(l,t.endo?Math.ceil(f/2):f);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(e){return Hc(e,Cu,t.n)}}}({...t,toBytes(e,t,n){const i=t.toAffine(),s=r.toBytes(i.x),a=Nc;return Kc("isCompressed",n),n?a(Uint8Array.from([t.hasEvenY()?2:3]),s):a(Uint8Array.from([4]),s,r.toBytes(i.y))},fromBytes(e){const t=e.length,n=e[0],a=e.subarray(1);if(t!==i||2!==n&&3!==n){if(t===s&&4===n)return{x:r.fromBytes(a.subarray(0,r.BYTES)),y:r.fromBytes(a.subarray(r.BYTES,2*r.BYTES))};throw Error(`Point of length ${t} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const t=_c(a);if(!Hc(t,Cu,r.ORDER))throw Error("Point is not on curve");const i=h(t);let s;try{s=r.sqrt(i)}catch(e){const t=e instanceof Error?": "+e.message:"";throw Error("Point is not on curve"+t)}return!(1&~n)!=((s&Cu)===Cu)&&(s=r.neg(s)),{x:t,y:s}}}}),f=e=>Uc(Qc(e,t.nByteLength));function y(e){return e>n>>Cu}const d=(e,t,r)=>_c(e.slice(t,r));class p{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){const r=t.nByteLength;return e=Mc("compactSignature",e,2*r),new p(d(e,0,r),d(e,r,2*r))}static fromDER(e){const{r:t,s:r}=Su.toSig(Mc("DER",e));return new p(t,r)}assertValidity(){zc("r",this.r,Cu,n),zc("s",this.s,Cu,n)}addRecoveryBit(e){return new p(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:i,recovery:s}=this,u=m(Mc("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");const h=2===s||3===s?n+t.n:n;if(h>=r.ORDER)throw Error("recovery id 2 or 3 invalid");const l=1&s?"03":"02",y=c.fromHex(l+f(h)),d=o(h),p=a(-u*d),g=a(i*d),A=c.BASE.multiplyAndAddUnsafe(y,p,g);if(!A)throw Error("point at infinify");return A.assertValidity(),A}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Tc(this.toDERHex())}toDERHex(){return Su.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Tc(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const g={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=du(t.n);return function(e,t,r=!1){const n=e.length,i=yu(t),s=du(t);if(n<16||n<s||n>1024)throw Error(`expected ${s}-1024 bytes of input, got ${n}`);const a=au(r?_c(e):Lc(e),t-eu)+eu;return r?Oc(a,i):Qc(a,i)}(t.randomBytes(e),t.n)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function A(e){const t=Ic(e),r="string"==typeof e,n=(t||r)&&e.length;return t?n===i||n===s:r?n===2*i||n===2*s:e instanceof c}const w=t.bits2int||function(e){const r=_c(e),n=8*e.length-t.nBitLength;return n>0?r>>BigInt(n):r},m=t.bits2int_modN||function(e){return a(w(e))},b=Gc(t.nBitLength);function E(e){return zc("num < 2^"+t.nBitLength,e,Iu,b),Qc(e,t.nByteLength)}function k(e,n,i=v){if(["recovered","canonical"].some((e=>e in i)))throw Error("sign() legacy options not supported");const{hash:s,randomBytes:h}=t;let{lowS:f,prehash:d,extraEntropy:g}=i;null==f&&(f=!0),e=Mc("msgHash",e),ku(i),d&&(e=Mc("prehashed msgHash",s(e)));const A=m(e),b=u(n),k=[E(b),E(A)];if(null!=g&&!1!==g){const e=!0===g?h(r.BYTES):g;k.push(Mc("extraEntropy",e))}const B=Nc(...k),S=A;return{seed:B,k2sig:function(e){const t=w(e);if(!l(t))return;const r=o(t),n=c.BASE.multiply(t).toAffine(),i=a(n.x);if(i===Iu)return;const s=a(r*a(S+i*b));if(s===Iu)return;let u=(n.x===i?0:2)|Number(n.y&Cu),h=s;return f&&y(s)&&(h=function(e){return y(e)?a(-e):e}(s),u^=1),new p(i,h,u)}}}const v={lowS:t.lowS,prehash:!1},B={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(A(e))throw Error("first arg must be private key");if(!A(t))throw Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,r,n=v){const{seed:i,k2sig:s}=k(e,r,n),a=t;return Jc(a.hash.outputLen,a.nByteLength,a.hmac)(i,s)},verify:function(e,r,n,i=B){const s=e;if(r=Mc("msgHash",r),n=Mc("publicKey",n),"strict"in i)throw Error("options.strict was renamed to lowS");ku(i);const{lowS:u,prehash:h}=i;let l,f;try{if("string"==typeof s||Ic(s))try{l=p.fromDER(s)}catch(e){if(!(e instanceof Su.Err))throw e;l=p.fromCompact(s)}else{if("object"!=typeof s||"bigint"!=typeof s.r||"bigint"!=typeof s.s)throw Error("PARSE");{const{r:e,s:t}=s;l=new p(e,t)}}f=c.fromHex(n)}catch(e){if("PARSE"===e.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&l.hasHighS())return!1;h&&(r=t.hash(r));const{r:y,s:d}=l,g=m(r),A=o(d),w=a(g*A),b=a(y*A),E=c.BASE.multiplyAndAddUnsafe(f,w,b)?.toAffine();return!!E&&a(E.x)===y},ProjectivePoint:c,Signature:p,utils:g}}({...e,...Pu(t)});return Object.freeze({...r(t),create:r})}BigInt(4);const Du=fu(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),xu=Uu({a:Du.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:Du,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},mc),Ru=BigInt(2**32-1),Tu=BigInt(32);function _u(e,t=!1){return t?{h:Number(e&Ru),l:Number(e>>Tu&Ru)}:{h:0|Number(e>>Tu&Ru),l:0|Number(e&Ru)}}function Lu(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:a}=_u(e[i],t);[r[i],n[i]]=[s,a]}return[r,n]}const Qu=(e,t,r)=>e<<r|t>>>32-r,Ou=(e,t,r)=>t<<r|e>>>32-r,Mu=(e,t,r)=>t<<r-32|e>>>64-r,Nu=(e,t,r)=>e<<r-32|t>>>64-r,Fu={fromBig:_u,split:Lu,toBig:(e,t)=>BigInt(e>>>0)<<Tu|BigInt(t>>>0),shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:Qu,rotlSL:Ou,rotlBH:Mu,rotlBL:Nu,add:function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L:(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H:(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,add5H:(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0,add5L:(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},[Hu,zu]=(()=>Fu.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),ju=new Uint32Array(80),Gu=new Uint32Array(80);class qu extends yc{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:a,Dl:o,Eh:c,El:u,Fh:h,Fl:l,Gh:f,Gl:y,Hh:d,Hl:p}=this;return[e,t,r,n,i,s,a,o,c,u,h,l,f,y,d,p]}set(e,t,r,n,i,s,a,o,c,u,h,l,f,y,d,p){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|c,this.El=0|u,this.Fh=0|h,this.Fl=0|l,this.Gh=0|f,this.Gl=0|y,this.Hh=0|d,this.Hl=0|p}process(e,t){for(let r=0;r<16;r++,t+=4)ju[r]=e.getUint32(t),Gu[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|ju[e-15],r=0|Gu[e-15],n=Fu.rotrSH(t,r,1)^Fu.rotrSH(t,r,8)^Fu.shrSH(t,r,7),i=Fu.rotrSL(t,r,1)^Fu.rotrSL(t,r,8)^Fu.shrSL(t,r,7),s=0|ju[e-2],a=0|Gu[e-2],o=Fu.rotrSH(s,a,19)^Fu.rotrBH(s,a,61)^Fu.shrSH(s,a,6),c=Fu.rotrSL(s,a,19)^Fu.rotrBL(s,a,61)^Fu.shrSL(s,a,6),u=Fu.add4L(i,c,Gu[e-7],Gu[e-16]),h=Fu.add4H(u,n,o,ju[e-7],ju[e-16]);ju[e]=0|h,Gu[e]=0|u}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:a,Cl:o,Dh:c,Dl:u,Eh:h,El:l,Fh:f,Fl:y,Gh:d,Gl:p,Hh:g,Hl:A}=this;for(let e=0;e<80;e++){const t=Fu.rotrSH(h,l,14)^Fu.rotrSH(h,l,18)^Fu.rotrBH(h,l,41),w=Fu.rotrSL(h,l,14)^Fu.rotrSL(h,l,18)^Fu.rotrBL(h,l,41),m=h&f^~h&d,b=l&y^~l&p,E=Fu.add5L(A,w,b,zu[e],Gu[e]),k=Fu.add5H(E,g,t,m,Hu[e],ju[e]),v=0|E,B=Fu.rotrSH(r,n,28)^Fu.rotrBH(r,n,34)^Fu.rotrBH(r,n,39),S=Fu.rotrSL(r,n,28)^Fu.rotrBL(r,n,34)^Fu.rotrBL(r,n,39),I=r&i^r&a^i&a,C=n&s^n&o^s&o;g=0|d,A=0|p,d=0|f,p=0|y,f=0|h,y=0|l,({h,l}=Fu.add(0|c,0|u,0|k,0|v)),c=0|a,u=0|o,a=0|i,o=0|s,i=0|r,s=0|n;const K=Fu.add3L(v,S,C);r=Fu.add3H(K,k,B,I),n=0|K}({h:r,l:n}=Fu.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=Fu.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:a,l:o}=Fu.add(0|this.Ch,0|this.Cl,0|a,0|o)),({h:c,l:u}=Fu.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l}=Fu.add(0|this.Eh,0|this.El,0|h,0|l)),({h:f,l:y}=Fu.add(0|this.Fh,0|this.Fl,0|f,0|y)),({h:d,l:p}=Fu.add(0|this.Gh,0|this.Gl,0|d,0|p)),({h:g,l:A}=Fu.add(0|this.Hh,0|this.Hl,0|g,0|A)),this.set(r,n,i,s,a,o,c,u,h,l,f,y,d,p,g,A)}roundClean(){ju.fill(0),Gu.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Vu extends qu{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Ju=uc((()=>new qu)),Wu=uc((()=>new Vu)),$u=fu(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),Yu=Uu({a:$u.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:$u,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},Wu),Zu=fu(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),Xu={a:Zu.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:Zu,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},eh=Uu({a:Xu.a,b:Xu.b,Fp:Zu,n:Xu.n,Gx:Xu.Gx,Gy:Xu.Gy,h:Xu.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},Ju),th=[],rh=[],nh=[],ih=BigInt(0),sh=BigInt(1),ah=BigInt(2),oh=BigInt(7),ch=BigInt(256),uh=BigInt(113);for(let e=0,t=sh,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],th.push(2*(5*n+r)),rh.push((e+1)*(e+2)/2%64);let i=ih;for(let e=0;e<7;e++)t=(t<<sh^(t>>oh)*uh)%ch,t&ah&&(i^=sh<<(sh<<BigInt(e))-sh);nh.push(i)}const[hh,lh]=Lu(nh,!0),fh=(e,t,r)=>r>32?Mu(e,t,r):Qu(e,t,r),yh=(e,t,r)=>r>32?Nu(e,t,r):Ou(e,t,r);class dh extends cc{constructor(e,t,r,n=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Wo(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}keccak(){nc||ic(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],a=r[i+1],o=fh(s,a,1)^r[n],c=yh(s,a,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=rh[r],s=fh(t,i,n),a=yh(t,i,n),o=th[r];t=e[o],i=e[o+1],e[o]=s,e[o+1]=a}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=hh[n],e[1]^=lh[n]}r.fill(0)}(this.state32,this.rounds),nc||ic(this.state32),this.posOut=0,this.pos=0}update(e){Yo(this);const{blockLen:t,state:r}=this,n=(e=ac(e)).length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Yo(this,!1),$o(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Wo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Zo(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new dh(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}const ph=(e,t,r)=>uc((()=>new dh(t,e,r))),gh=ph(6,136,32),Ah=ph(6,72,64),wh=(()=>function(e){const t=(t,r)=>e(r).update(ac(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(((e={})=>new dh(136,31,void 0===e.dkLen?32:e.dkLen,!0))))(),mh=BigInt(0),bh=BigInt(1),Eh=BigInt(2),kh=BigInt(8),vh={zip215:!0};function Bh(e){const t=function(e){const t=Eu(e);return $c(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=t,u=Eh<<BigInt(8*o)-bh,h=r.create,l=fu(t.n,t.nBitLength),f=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch(e){return{isValid:!1,value:mh}}}),y=t.adjustScalarBytes||(e=>e),d=t.domain||((e,t,r)=>{if(Kc("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function p(e,t){zc("coordinate "+e,t,mh,u)}function g(e){if(!(e instanceof m))throw Error("ExtendedPoint expected")}const A=Yc(((e,t)=>{const{ex:n,ey:i,ez:s}=e,a=e.is0();null==t&&(t=a?kh:r.inv(s));const o=h(n*t),c=h(i*t),u=h(s*t);if(a)return{x:mh,y:bh};if(u!==bh)throw Error("invZ was invalid");return{x:o,y:c}})),w=Yc((e=>{const{a:r,d:n}=t;if(e.is0())throw Error("bad point: ZERO");const{ex:i,ey:s,ez:a,et:o}=e,c=h(i*i),u=h(s*s),l=h(a*a),f=h(l*l),y=h(c*r);if(h(l*h(y+u))!==h(f+h(n*h(c*u))))throw Error("bad point: equation left != right (1)");if(h(i*s)!==h(a*o))throw Error("bad point: equation left != right (2)");return!0}));class m{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,p("x",e),p("y",t),p("z",r),p("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof m)throw Error("extended point not allowed");const{x:t,y:r}=e||{};return p("x",t),p("y",r),new m(t,r,bh,h(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.ez)));return e.map(((e,r)=>e.toAffine(t[r]))).map(m.fromAffine)}static msm(e,t){return bu(m,l,e,t)}_setWindowSize(e){k.setWindowSize(this,e)}assertValidity(){w(this)}equals(e){g(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:a}=e,o=h(t*a),c=h(i*n),u=h(r*a),l=h(s*n);return o===c&&u===l}is0(){return this.equals(m.ZERO)}negate(){return new m(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,s=h(r*r),a=h(n*n),o=h(Eh*h(i*i)),c=h(e*s),u=r+n,l=h(h(u*u)-s-a),f=c+a,y=f-o,d=c-a,p=h(l*y),g=h(f*d),A=h(l*d),w=h(y*f);return new m(p,g,w,A)}add(e){g(e);const{a:r,d:n}=t,{ex:i,ey:s,ez:a,et:o}=this,{ex:c,ey:u,ez:l,et:f}=e;if(r===BigInt(-1)){const e=h((s-i)*(u+c)),t=h((s+i)*(u-c)),r=h(t-e);if(r===mh)return this.double();const n=h(a*Eh*f),y=h(o*Eh*l),d=y+n,p=t+e,g=y-n,A=h(d*r),w=h(p*g),b=h(d*g),E=h(r*p);return new m(A,w,E,b)}const y=h(i*c),d=h(s*u),p=h(o*n*f),A=h(a*l),w=h((i+s)*(c+u)-y-d),b=A-p,E=A+p,k=h(d-r*y),v=h(w*b),B=h(E*k),S=h(w*k),I=h(b*E);return new m(v,B,I,S)}subtract(e){return this.add(e.negate())}wNAF(e){return k.wNAFCached(this,e,m.normalizeZ)}multiply(e){const t=e;zc("scalar",t,bh,n);const{p:r,f:i}=this.wNAF(t);return m.normalizeZ([r,i])[0]}multiplyUnsafe(e){const t=e;return zc("scalar",t,mh,n),t===mh?E:this.equals(E)||t===bh?this:this.equals(b)?this.wNAF(t).p:k.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return k.unsafeLadder(this,n).is0()}toAffine(e){return A(this,e)}clearCofactor(){const{h:e}=t;return e===bh?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:s}=t,a=r.BYTES;e=Mc("pointHex",e,a),Kc("zip215",n);const o=e.slice(),c=e[a-1];o[a-1]=-129&c;const l=Lc(o),y=n?u:r.ORDER;zc("pointHex.y",l,mh,y);const d=h(l*l),p=h(d-bh),g=h(i*d-s);let{isValid:A,value:w}=f(p,g);if(!A)throw Error("Point.fromHex: invalid y coordinate");const b=(w&bh)===bh,E=!!(128&c);if(!n&&w===mh&&E)throw Error("Point.fromHex: x=0 and x_0=1");return E!==b&&(w=h(-w)),m.fromAffine({x:w,y:l})}static fromPrivateKey(e){return S(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=Oc(t,r.BYTES);return n[n.length-1]|=e&bh?128:0,n}toHex(){return Uc(this.toRawBytes())}}m.BASE=new m(t.Gx,t.Gy,bh,h(t.Gx*t.Gy)),m.ZERO=new m(mh,bh,bh,mh);const{BASE:b,ZERO:E}=m,k=mu(m,8*o);function v(e){return au(e,n)}function B(e){return v(Lc(e))}function S(e){const t=o;e=Mc("private key",e,t);const r=Mc("hashed private key",s(e),2*t),n=y(r.slice(0,t)),i=r.slice(t,2*t),a=B(n),c=b.multiply(a),u=c.toRawBytes();return{head:n,prefix:i,scalar:a,point:c,pointBytes:u}}function I(e=new Uint8Array,...t){const r=Nc(...t);return B(s(d(r,Mc("context",e),!!i)))}const C=vh;return b._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return S(e).pointBytes},sign:function(e,t,s={}){e=Mc("message",e),i&&(e=i(e));const{prefix:a,scalar:c,pointBytes:u}=S(t),h=I(s.context,a,e),l=b.multiply(h).toRawBytes(),f=v(h+I(s.context,l,u,e)*c);return zc("signature.s",f,mh,n),Mc("result",Nc(l,Oc(f,r.BYTES)),2*o)},verify:function(e,t,n,s=C){const{context:a,zip215:o}=s,c=r.BYTES;e=Mc("signature",e,2*c),t=Mc("message",t),void 0!==o&&Kc("zip215",o),i&&(t=i(t));const u=Lc(e.slice(c,2*c));let h,l,f;try{h=m.fromHex(n,o),l=m.fromHex(e.slice(0,c),o),f=b.multiplyUnsafe(u)}catch(e){return!1}if(!o&&h.isSmallOrder())return!1;const y=I(a,l.toRawBytes(),h.toRawBytes(),t);return l.add(h.multiplyUnsafe(y)).subtract(f).clearCofactor().equals(m.ZERO)},ExtendedPoint:m,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>a(r.BYTES),precompute:(e=8,t=m.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}const Sh=BigInt(0),Ih=BigInt(1),Ch=uc((()=>wh.create({dkLen:114}))),Kh=(uc((()=>wh.create({dkLen:64}))),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),Ph=BigInt(1),Uh=BigInt(2),Dh=BigInt(3);BigInt(4);const xh=BigInt(11),Rh=BigInt(22),Th=BigInt(44),_h=BigInt(88),Lh=BigInt(223);function Qh(e){const t=Kh,r=e*e*e%t,n=r*r*e%t,i=cu(n,Dh,t)*n%t,s=cu(i,Dh,t)*n%t,a=cu(s,Uh,t)*r%t,o=cu(a,xh,t)*a%t,c=cu(o,Rh,t)*o%t,u=cu(c,Th,t)*c%t,h=cu(u,_h,t)*u%t,l=cu(h,Th,t)*c%t,f=cu(l,Uh,t)*r%t,y=cu(f,Ph,t)*e%t;return cu(y,Lh,t)*f%t}function Oh(e){return e[0]&=252,e[55]|=128,e[56]=0,e}const Mh=fu(Kh,456,!0),Nh={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:Mh,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:Ch,randomBytes:hc,adjustScalarBytes:Oh,domain:(e,t,r)=>{if(t.length>255)throw Error("Context is too big: "+t.length);return oc(sc("SigEd448"),new Uint8Array([r?1:0,t.length]),t,e)},uvRatio:function(e,t){const r=Kh,n=au(e*e*t,r),i=au(n*e,r),s=au(i*n*t,r),a=au(i*Qh(s),r),o=au(a*a,r);return{isValid:au(o*t,r)===e,value:a}}},Fh=Bh(Nh),Hh=(()=>function(e){const t=($c(r=e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r}));var r;const{P:n}=t,i=e=>au(e,n),s=t.montgomeryBits,a=Math.ceil(s/8),o=t.nByteLength,c=t.adjustScalarBytes||(e=>e),u=t.powPminus2||(e=>ou(e,n-BigInt(2),n));function h(e,t,r){const n=i(e*(t-r));return[t=i(t-n),r=i(r+n)]}const l=(t.a-BigInt(2))/BigInt(4);function f(e){return Oc(i(e),a)}function y(e,t){const r=function(e){const t=Mc("u coordinate",e,a);return 32===o&&(t[31]&=127),Lc(t)}(t),y=function(e){const t=Mc("scalar",e),r=t.length;if(r!==a&&r!==o)throw Error(`Expected ${a} or ${o} bytes, got ${r}`);return Lc(c(t))}(e),d=function(e,t){zc("u",e,Sh,n),zc("scalar",t,Sh,n);const r=t,a=e;let o,c=Ih,f=Sh,y=e,d=Ih,p=Sh;for(let e=BigInt(s-1);e>=Sh;e--){const t=r>>e&Ih;p^=t,o=h(p,c,y),c=o[0],y=o[1],o=h(p,f,d),f=o[0],d=o[1],p=t;const n=c+f,s=i(n*n),u=c-f,g=i(u*u),A=s-g,w=y+d,m=i((y-d)*n),b=i(w*u),E=m+b,k=m-b;y=i(E*E),d=i(a*i(k*k)),c=i(s*g),f=i(A*(s+i(l*A)))}o=h(p,c,y),c=o[0],y=o[1],o=h(p,f,d),f=o[0],d=o[1];const g=u(f);return i(c*g)}(r,y);if(d===Sh)throw Error("Invalid private or public key received");return f(d)}const d=f(t.Gu);function p(e){return y(e,d)}return{scalarMult:y,scalarMultBase:p,getSharedSecret:(e,t)=>y(e,t),getPublicKey:e=>p(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:d}}({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:Kh,Gu:BigInt(5),powPminus2:e=>{const t=Kh;return au(cu(Qh(e),BigInt(2),t)*e,t)},adjustScalarBytes:Oh,randomBytes:hc}))();Mh.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const zh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),jh=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Gh=BigInt(1),qh=BigInt(2),Vh=(e,t)=>(e+t/qh)/t,Jh=fu(zh,void 0,void 0,{sqrt:function(e){const t=zh,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=e*e*e%t,h=u*u*e%t,l=cu(h,r,t)*h%t,f=cu(l,r,t)*h%t,y=cu(f,qh,t)*u%t,d=cu(y,i,t)*y%t,p=cu(d,s,t)*d%t,g=cu(p,o,t)*p%t,A=cu(g,c,t)*g%t,w=cu(A,o,t)*p%t,m=cu(w,r,t)*h%t,b=cu(m,a,t)*d%t,E=cu(b,n,t)*u%t,k=cu(E,qh,t);if(!Jh.eql(Jh.sqr(k),e))throw Error("Cannot find square root");return k}}),Wh=Uu({a:BigInt(0),b:BigInt(7),Fp:Jh,n:jh,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=jh,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Gh*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=Vh(s*e,t),c=Vh(-n*e,t);let u=au(e-o*r-c*i,t),h=au(-o*n-c*s,t);const l=u>a,f=h>a;if(l&&(u=t-u),f&&(h=t-h),u>a||h>a)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:u,k2neg:f,k2:h}}}},mc);BigInt(0),Wh.ProjectivePoint;const $h=fu(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Yh=Uu({a:$h.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:$h,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},mc),Zh=fu(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Xh=Uu({a:Zh.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:Zh,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},Wu),el=fu(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),tl=Uu({a:el.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:el,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},Ju),rl=new Map(Object.entries({nistP256:xu,nistP384:Yu,nistP521:eh,brainpoolP256r1:Yh,brainpoolP384r1:Xh,brainpoolP512r1:tl,secp256k1:Wh,x448:Hh,ed448:Fh}));var nl=Object.freeze({__proto__:null,nobleCurves:rl});function il(e,t,r,n,i,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let d,p,g,A,w,m,b,E,k,v,B=0,S=t.length;const I=32===e.length?3:9;E=3===I?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(t=function(e){const t=8-e.length%8;let r;if(!(t<8)){if(8===t)return e;throw Error("des: invalid padding")}r=0;const n=new Uint8Array(e.length+t);for(let t=0;t<e.length;t++)n[t]=e[t];for(let r=0;r<t;r++)n[e.length+r]=0;return n}(t),S=t.length);let C=new Uint8Array(S),K=0;for(;B<S;){for(m=t[B++]<<24|t[B++]<<16|t[B++]<<8|t[B++],b=t[B++]<<24|t[B++]<<16|t[B++]<<8|t[B++],g=252645135&(m>>>4^b),b^=g,m^=g<<4,g=65535&(m>>>16^b),b^=g,m^=g<<16,g=858993459&(b>>>2^m),m^=g,b^=g<<2,g=16711935&(b>>>8^m),m^=g,b^=g<<8,g=1431655765&(m>>>1^b),b^=g,m^=g<<1,m=m<<1|m>>>31,b=b<<1|b>>>31,p=0;p<I;p+=3){for(k=E[p+1],v=E[p+2],d=E[p];d!==k;d+=v)A=b^e[d],w=(b>>>4|b<<28)^e[d+1],g=m,m=b,b=g^(o[A>>>24&63]|u[A>>>16&63]|l[A>>>8&63]|y[63&A]|a[w>>>24&63]|c[w>>>16&63]|h[w>>>8&63]|f[63&w]);g=m,m=b,b=g}m=m>>>1|m<<31,b=b>>>1|b<<31,g=1431655765&(m>>>1^b),b^=g,m^=g<<1,g=16711935&(b>>>8^m),m^=g,b^=g<<8,g=858993459&(b>>>2^m),m^=g,b^=g<<2,g=65535&(m>>>16^b),b^=g,m^=g<<16,g=252645135&(m>>>4^b),b^=g,m^=g<<4,C[K++]=m>>>24,C[K++]=m>>>16&255,C[K++]=m>>>8&255,C[K++]=255&m,C[K++]=b>>>24,C[K++]=b>>>16&255,C[K++]=b>>>8&255,C[K++]=255&b}return r||(C=function(e){let t,r=null;if(t=0,!r){for(r=1;0===e[e.length-r];)r++;r--}return e.subarray(0,e.length-r)}(C)),C}function sl(e){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=e.length>8?3:1,g=Array(32*p),A=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let w,m,b,E=0,k=0;for(let v=0;v<p;v++){let p=e[E++]<<24|e[E++]<<16|e[E++]<<8|e[E++],v=e[E++]<<24|e[E++]<<16|e[E++]<<8|e[E++];b=252645135&(p>>>4^v),v^=b,p^=b<<4,b=65535&(v>>>-16^p),p^=b,v^=b<<-16,b=858993459&(p>>>2^v),v^=b,p^=b<<2,b=65535&(v>>>-16^p),p^=b,v^=b<<-16,b=1431655765&(p>>>1^v),v^=b,p^=b<<1,b=16711935&(v>>>8^p),p^=b,v^=b<<8,b=1431655765&(p>>>1^v),v^=b,p^=b<<1,b=p<<8|v>>>20&240,p=v<<24|v<<8&16711680|v>>>8&65280|v>>>24&240,v=b;for(let e=0;e<16;e++)A[e]?(p=p<<2|p>>>26,v=v<<2|v>>>26):(p=p<<1|p>>>27,v=v<<1|v>>>27),p&=-15,v&=-15,w=t[p>>>28]|r[p>>>24&15]|n[p>>>20&15]|i[p>>>16&15]|s[p>>>12&15]|a[p>>>8&15]|o[p>>>4&15],m=c[v>>>28]|u[v>>>24&15]|h[v>>>20&15]|l[v>>>16&15]|f[v>>>12&15]|y[v>>>8&15]|d[v>>>4&15],b=65535&(m>>>16^w),g[k++]=w^b,g[k++]=m^b<<16}return g}function al(e){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(e.subarray(8*t,8*t+8)));this.encrypt=function(e){return il(sl(this.key[2]),il(sl(this.key[1]),il(sl(this.key[0]),e,!0),!1),!0)}}function ol(){this.BlockSize=8,this.KeySize=16,this.setKey=function(e){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),e.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(e),!0},this.reset=function(){for(let e=0;e<16;e++)this.masking[e]=0,this.rotate[e]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(e){const t=Array(e.length);for(let s=0;s<e.length;s+=8){let a,o=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],c=e[s+4]<<24|e[s+5]<<16|e[s+6]<<8|e[s+7];a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,a=c,c=o^n(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^i(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^n(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^i(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^n(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^i(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^n(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^i(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^n(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^i(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,t[s]=c>>>24&255,t[s+1]=c>>>16&255,t[s+2]=c>>>8&255,t[s+3]=255&c,t[s+4]=o>>>24&255,t[s+5]=o>>>16&255,t[s+6]=o>>>8&255,t[s+7]=255&o}return t},this.decrypt=function(e){const t=Array(e.length);for(let s=0;s<e.length;s+=8){let a,o=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],c=e[s+4]<<24|e[s+5]<<16|e[s+6]<<8|e[s+7];a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,a=c,c=o^i(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^n(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^i(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^n(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^i(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^n(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^i(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^n(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^i(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^n(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,t[s]=c>>>24&255,t[s+1]=c>>>16&255,t[s+2]=c>>>8&255,t[s+3]=255&c,t[s+4]=o>>>24&255,t[s+5]=o>>16&255,t[s+6]=o>>8&255,t[s+7]=255&o}return t};const e=[,,,,];e[0]=[,,,,],e[0][0]=[4,0,13,15,12,14,8],e[0][1]=[5,2,16,18,17,19,10],e[0][2]=[6,3,23,22,21,20,9],e[0][3]=[7,1,26,25,27,24,11],e[1]=[,,,,],e[1][0]=[0,6,21,23,20,22,16],e[1][1]=[1,4,0,2,1,3,18],e[1][2]=[2,5,7,6,5,4,17],e[1][3]=[3,7,10,9,11,8,19],e[2]=[,,,,],e[2][0]=[4,0,13,15,12,14,8],e[2][1]=[5,2,16,18,17,19,10],e[2][2]=[6,3,23,22,21,20,9],e[2][3]=[7,1,26,25,27,24,11],e[3]=[,,,,],e[3][0]=[0,6,21,23,20,22,16],e[3][1]=[1,4,0,2,1,3,18],e[3][2]=[2,5,7,6,5,4,17],e[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function r(e,t,r){const n=t+e,i=n<<r|n>>>32-r;return(s[0][i>>>24]^s[1][i>>>16&255])-s[2][i>>>8&255]+s[3][255&i]}function n(e,t,r){const n=t^e,i=n<<r|n>>>32-r;return s[0][i>>>24]-s[1][i>>>16&255]+s[2][i>>>8&255]^s[3][255&i]}function i(e,t,r){const n=t-e,i=n<<r|n>>>32-r;return(s[0][i>>>24]+s[1][i>>>16&255]^s[2][i>>>8&255])-s[3][255&i]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(r){const n=[,,,,,,,,],i=Array(32);let a;for(let e=0;e<4;e++)a=4*e,n[e]=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3];const o=[6,7,4,5];let c,u=0;for(let r=0;r<2;r++)for(let r=0;r<4;r++){for(a=0;a<4;a++){const t=e[r][a];c=n[t[1]],c^=s[4][n[t[2]>>>2]>>>24-8*(3&t[2])&255],c^=s[5][n[t[3]>>>2]>>>24-8*(3&t[3])&255],c^=s[6][n[t[4]>>>2]>>>24-8*(3&t[4])&255],c^=s[7][n[t[5]>>>2]>>>24-8*(3&t[5])&255],c^=s[o[a]][n[t[6]>>>2]>>>24-8*(3&t[6])&255],n[t[0]]=c}for(a=0;a<4;a++){const e=t[r][a];c=s[4][n[e[0]>>>2]>>>24-8*(3&e[0])&255],c^=s[5][n[e[1]>>>2]>>>24-8*(3&e[1])&255],c^=s[6][n[e[2]>>>2]>>>24-8*(3&e[2])&255],c^=s[7][n[e[3]>>>2]>>>24-8*(3&e[3])&255],c^=s[4+a][n[e[4]>>>2]>>>24-8*(3&e[4])&255],i[u]=c,u++}}for(let e=0;e<16;e++)this.masking[e]=i[e],this.rotate[e]=31&i[16+e]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function cl(e){this.cast5=new ol,this.cast5.setKey(e),this.encrypt=function(e){return this.cast5.encrypt(e)}}al.keySize=al.prototype.keySize=24,al.blockSize=al.prototype.blockSize=8,cl.blockSize=cl.prototype.blockSize=8,cl.keySize=cl.prototype.keySize=16;const ul=4294967295;function hl(e,t){return(e<<t|e>>>32-t)&ul}function ll(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function fl(e,t,r){e.splice(t,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function yl(e,t){return e>>>8*t&255}function dl(e){this.tf=function(){let e=null,t=null,r=-1,n=[],i=[[],[],[],[]];function s(e){return i[0][yl(e,0)]^i[1][yl(e,1)]^i[2][yl(e,2)]^i[3][yl(e,3)]}function a(e){return i[0][yl(e,3)]^i[1][yl(e,0)]^i[2][yl(e,1)]^i[3][yl(e,2)]}function o(e,t){let r=s(t[0]),i=a(t[1]);t[2]=hl(t[2]^r+i+n[4*e+8]&ul,31),t[3]=hl(t[3],1)^r+2*i+n[4*e+9]&ul,r=s(t[2]),i=a(t[3]),t[0]=hl(t[0]^r+i+n[4*e+10]&ul,31),t[1]=hl(t[1],1)^r+2*i+n[4*e+11]&ul}function c(e,t){let r=s(t[0]),i=a(t[1]);t[2]=hl(t[2],1)^r+i+n[4*e+10]&ul,t[3]=hl(t[3]^r+2*i+n[4*e+11]&ul,31),r=s(t[2]),i=a(t[3]),t[0]=hl(t[0],1)^r+i+n[4*e+8]&ul,t[1]=hl(t[1]^r+2*i+n[4*e+9]&ul,31)}return{name:"twofish",blocksize:16,open:function(t){let r,s,a,o,c;e=t;const u=[],h=[],l=[];let f;const y=[];let d,p,g;const A=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],w=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],m=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],b=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],E=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],k=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],v=[[],[]],B=[[],[],[],[]];function S(e){return e^e>>2^[0,90,180,238][3&e]}function I(e){return e^e>>1^e>>2^[0,238,180,90][3&e]}function C(e,t){let r,n,i;for(r=0;r<8;r++)n=t>>>24,t=t<<8&ul|e>>>24,e=e<<8&ul,i=n<<1,128&n&&(i^=333),t^=n^i<<16,i^=n>>>1,1&n&&(i^=166),t^=i<<24|i<<8;return t}function K(e,t){const r=t>>4,n=15&t,i=A[e][r^n],s=w[e][E[n]^k[r]];return b[e][E[s]^k[i]]<<4|m[e][i^s]}function P(e,t){let r=yl(e,0),n=yl(e,1),i=yl(e,2),s=yl(e,3);switch(f){case 4:r=v[1][r]^yl(t[3],0),n=v[0][n]^yl(t[3],1),i=v[0][i]^yl(t[3],2),s=v[1][s]^yl(t[3],3);case 3:r=v[1][r]^yl(t[2],0),n=v[1][n]^yl(t[2],1),i=v[0][i]^yl(t[2],2),s=v[0][s]^yl(t[2],3);case 2:r=v[0][v[0][r]^yl(t[1],0)]^yl(t[0],0),n=v[0][v[1][n]^yl(t[1],1)]^yl(t[0],1),i=v[1][v[0][i]^yl(t[1],2)]^yl(t[0],2),s=v[1][v[1][s]^yl(t[1],3)]^yl(t[0],3)}return B[0][r]^B[1][n]^B[2][i]^B[3][s]}for(e=e.slice(0,32),r=e.length;16!==r&&24!==r&&32!==r;)e[r++]=0;for(r=0;r<e.length;r+=4)l[r>>2]=ll(e,r);for(r=0;r<256;r++)v[0][r]=K(0,r),v[1][r]=K(1,r);for(r=0;r<256;r++)d=v[1][r],p=S(d),g=I(d),B[0][r]=d+(p<<8)+(g<<16)+(g<<24),B[2][r]=p+(g<<8)+(d<<16)+(g<<24),d=v[0][r],p=S(d),g=I(d),B[1][r]=g+(g<<8)+(p<<16)+(d<<24),B[3][r]=p+(d<<8)+(g<<16)+(p<<24);for(f=l.length/2,r=0;r<f;r++)s=l[r+r],u[r]=s,a=l[r+r+1],h[r]=a,y[f-r-1]=C(s,a);for(r=0;r<40;r+=2)s=16843009*r,a=s+16843009,s=P(s,u),a=hl(P(a,h),8),n[r]=s+a&ul,n[r+1]=hl(s+2*a,9);for(r=0;r<256;r++)switch(s=a=o=c=r,f){case 4:s=v[1][s]^yl(y[3],0),a=v[0][a]^yl(y[3],1),o=v[0][o]^yl(y[3],2),c=v[1][c]^yl(y[3],3);case 3:s=v[1][s]^yl(y[2],0),a=v[1][a]^yl(y[2],1),o=v[0][o]^yl(y[2],2),c=v[0][c]^yl(y[2],3);case 2:i[0][r]=B[0][v[0][v[0][s]^yl(y[1],0)]^yl(y[0],0)],i[1][r]=B[1][v[0][v[1][a]^yl(y[1],1)]^yl(y[0],1)],i[2][r]=B[2][v[1][v[0][o]^yl(y[1],2)]^yl(y[0],2)],i[3][r]=B[3][v[1][v[1][c]^yl(y[1],3)]^yl(y[0],3)]}},close:function(){n=[],i=[[],[],[],[]]},encrypt:function(e,i){t=e,r=i;const s=[ll(t,r)^n[0],ll(t,r+4)^n[1],ll(t,r+8)^n[2],ll(t,r+12)^n[3]];for(let e=0;e<8;e++)o(e,s);return fl(t,r,s[2]^n[4]),fl(t,r+4,s[3]^n[5]),fl(t,r+8,s[0]^n[6]),fl(t,r+12,s[1]^n[7]),r+=16,t},decrypt:function(e,i){t=e,r=i;const s=[ll(t,r)^n[4],ll(t,r+4)^n[5],ll(t,r+8)^n[6],ll(t,r+12)^n[7]];for(let e=7;e>=0;e--)c(e,s);fl(t,r,s[2]^n[0]),fl(t,r+4,s[3]^n[1]),fl(t,r+8,s[0]^n[2]),fl(t,r+12,s[1]^n[3]),r+=16},finalize:function(){return t}}}(),this.tf.open(Array.from(e),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function pl(){}function gl(e){this.bf=new pl,this.bf.init(e),this.encrypt=function(e){return this.bf.encryptBlock(e)}}dl.keySize=dl.prototype.keySize=32,dl.blockSize=dl.prototype.blockSize=16,pl.prototype.BLOCKSIZE=8,pl.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],pl.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],pl.prototype.NN=16,pl.prototype._clean=function(e){return e<0&&(e=2147483648+(2147483647&e)),e},pl.prototype._F=function(e){let t;const r=255&e,n=255&(e>>>=8),i=255&(e>>>=8),s=255&(e>>>=8);return t=this.sboxes[0][s]+this.sboxes[1][i],t^=this.sboxes[2][n],t+=this.sboxes[3][r],t},pl.prototype._encryptBlock=function(e){let t,r=e[0],n=e[1];for(t=0;t<this.NN;++t){r^=this.parray[t],n=this._F(r)^n;const e=r;r=n,n=e}r^=this.parray[this.NN+0],n^=this.parray[this.NN+1],e[0]=this._clean(n),e[1]=this._clean(r)},pl.prototype.encryptBlock=function(e){let t;const r=[0,0],n=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)r[0]=r[0]<<8|255&e[t+0],r[1]=r[1]<<8|255&e[t+n];this._encryptBlock(r);const i=[];for(t=0;t<this.BLOCKSIZE/2;++t)i[t+0]=r[0]>>>24-8*t&255,i[t+n]=r[1]>>>24-8*t&255;return i},pl.prototype._decryptBlock=function(e){let t,r=e[0],n=e[1];for(t=this.NN+1;t>1;--t){r^=this.parray[t],n=this._F(r)^n;const e=r;r=n,n=e}r^=this.parray[1],n^=this.parray[0],e[0]=this._clean(n),e[1]=this._clean(r)},pl.prototype.init=function(e){let t,r=0;for(this.parray=[],t=0;t<this.NN+2;++t){let n=0;for(let t=0;t<4;++t)n=n<<8|255&e[r],++r>=e.length&&(r=0);this.parray[t]=this.PARRAY[t]^n}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],r=0;r<256;++r)this.sboxes[t][r]=this.SBOXES[t][r];const n=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(n),this.parray[t+0]=n[0],this.parray[t+1]=n[1];for(t=0;t<4;++t)for(r=0;r<256;r+=2)this._encryptBlock(n),this.sboxes[t][r+0]=n[0],this.sboxes[t][r+1]=n[1]},gl.keySize=gl.prototype.keySize=16,gl.blockSize=gl.prototype.blockSize=8;const Al=new Map([[Q.symmetric.tripledes,al],[Q.symmetric.cast5,cl],[Q.symmetric.blowfish,gl],[Q.symmetric.twofish,dl]]);var wl=Object.freeze({__proto__:null,legacyCiphers:Al});const ml=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),bl=new Uint32Array(80);class El extends yc{constructor(){super(64,20,8,!1),this.A=0|ml[0],this.B=0|ml[1],this.C=0|ml[2],this.D=0|ml[3],this.E=0|ml[4]}get(){const{A:e,B:t,C:r,D:n,E:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i}process(e,t){for(let r=0;r<16;r++,t+=4)bl[r]=e.getUint32(t,!1);for(let e=16;e<80;e++)bl[e]=rc(bl[e-3]^bl[e-8]^bl[e-14]^bl[e-16],1);let{A:r,B:n,C:i,D:s,E:a}=this;for(let e=0;e<80;e++){let t,o;e<20?(t=lc(n,i,s),o=1518500249):e<40?(t=n^i^s,o=1859775393):e<60?(t=fc(n,i,s),o=2400959708):(t=n^i^s,o=3395469782);const c=rc(r,5)+t+a+o+bl[e]|0;a=s,s=i,i=rc(n,30),n=r,r=c}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,this.set(r,n,i,s,a)}roundClean(){bl.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const kl=uc((()=>new El)),vl=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Bl=new Uint8Array(Array(16).fill(0).map(((e,t)=>t))),Sl=Bl.map((e=>(9*e+5)%16));let Il=[Bl],Cl=[Sl];for(let e=0;e<4;e++)for(let t of[Il,Cl])t.push(t[e].map((e=>vl[e])));const Kl=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((e=>new Uint8Array(e))),Pl=Il.map(((e,t)=>e.map((e=>Kl[t][e])))),Ul=Cl.map(((e,t)=>e.map((e=>Kl[t][e])))),Dl=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),xl=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Rl(e,t,r,n){return 0===e?t^r^n:1===e?t&r|~t&n:2===e?(t|~r)^n:3===e?t&n|r&~n:t^(r|~n)}const Tl=new Uint32Array(16);class _l extends yc{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:r,h3:n,h4:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.h0=0|e,this.h1=0|t,this.h2=0|r,this.h3=0|n,this.h4=0|i}process(e,t){for(let r=0;r<16;r++,t+=4)Tl[r]=e.getUint32(t,!0);let r=0|this.h0,n=r,i=0|this.h1,s=i,a=0|this.h2,o=a,c=0|this.h3,u=c,h=0|this.h4,l=h;for(let e=0;e<5;e++){const t=4-e,f=Dl[e],y=xl[e],d=Il[e],p=Cl[e],g=Pl[e],A=Ul[e];for(let t=0;t<16;t++){const n=rc(r+Rl(e,i,a,c)+Tl[d[t]]+f,g[t])+h|0;r=h,h=c,c=0|rc(a,10),a=i,i=n}for(let e=0;e<16;e++){const r=rc(n+Rl(t,s,o,u)+Tl[p[e]]+y,A[e])+l|0;n=l,l=u,u=0|rc(o,10),o=s,s=r}}this.set(this.h1+a+u|0,this.h2+c+l|0,this.h3+h+n|0,this.h4+r+s|0,this.h0+i+o|0)}roundClean(){Tl.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const Ll=new Map(Object.entries({sha1:kl,sha224:bc,sha256:mc,sha384:Wu,sha512:Ju,sha3_256:gh,sha3_512:Ah,ripemd160:uc((()=>new _l))}));var Ql=Object.freeze({__proto__:null,nobleHashes:Ll});function Ol(e,t,r,n){e[t]+=r[n],e[t+1]+=r[n+1]+(e[t]<r[n])}function Ml(e,t){e[0]+=t,e[1]+=e[0]<t}function Nl(e,t,r,n,i,s,a,o){Ol(e,r,e,n),Ol(e,r,t,a);let c=e[s]^e[r],u=e[s+1]^e[r+1];e[s]=u,e[s+1]=c,Ol(e,i,e,s),c=e[n]^e[i],u=e[n+1]^e[i+1],e[n]=c>>>24^u<<8,e[n+1]=u>>>24^c<<8,Ol(e,r,e,n),Ol(e,r,t,o),c=e[s]^e[r],u=e[s+1]^e[r+1],e[s]=c>>>16^u<<16,e[s+1]=u>>>16^c<<16,Ol(e,i,e,s),c=e[n]^e[i],u=e[n+1]^e[i+1],e[n]=u>>>31^c<<1,e[n+1]=c>>>31^u<<1}const Fl=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Hl=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((e=>2*e)));function zl(e,t){const r=new Uint32Array(32),n=new Uint32Array(e.b.buffer,e.b.byteOffset,32);for(let t=0;t<16;t++)r[t]=e.h[t],r[t+16]=Fl[t];r[24]^=e.t0[0],r[25]^=e.t0[1];const i=t?4294967295:0;r[28]^=i,r[29]^=i;for(let e=0;e<12;e++){const t=e<<4;Nl(r,n,0,8,16,24,Hl[t+0],Hl[t+1]),Nl(r,n,2,10,18,26,Hl[t+2],Hl[t+3]),Nl(r,n,4,12,20,28,Hl[t+4],Hl[t+5]),Nl(r,n,6,14,22,30,Hl[t+6],Hl[t+7]),Nl(r,n,0,10,20,30,Hl[t+8],Hl[t+9]),Nl(r,n,2,12,22,24,Hl[t+10],Hl[t+11]),Nl(r,n,4,14,16,26,Hl[t+12],Hl[t+13]),Nl(r,n,6,8,18,28,Hl[t+14],Hl[t+15])}for(let t=0;t<16;t++)e.h[t]^=r[t]^r[t+16]}class jl{constructor(e,t,r,n){const i=new Uint8Array(64);this.S={b:new Uint8Array(Vl),h:new Uint32Array(ql/4),t0:new Uint32Array(2),c:0,outlen:e},i[0]=e,t&&(i[1]=t.length),i[2]=1,i[3]=1,r&&i.set(r,32),n&&i.set(n,48);const s=new Uint32Array(i.buffer,i.byteOffset,i.length/Uint32Array.BYTES_PER_ELEMENT);for(let e=0;e<16;e++)this.S.h[e]=Fl[e]^s[e];if(t){const e=new Uint8Array(Vl);e.set(t),this.update(e)}}update(e){if(!(e instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let t=0;for(;t<e.length;){this.S.c===Vl&&(Ml(this.S.t0,this.S.c),zl(this.S,!1),this.S.c=0);let r=Vl-this.S.c;this.S.b.set(e.subarray(t,t+r),this.S.c);const n=Math.min(r,e.length-t);this.S.c+=n,t+=n}return this}digest(e){Ml(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=Vl,zl(this.S,!0);const t=e||new Uint8Array(this.S.outlen);for(let e=0;e<this.S.outlen;e++)t[e]=this.S.h[e>>2]>>8*(3&e);return this.S.h=null,t.buffer}}function Gl(e,t,r,n){if(e>ql)throw Error(`outlen must be at most ${ql} (given: ${e})`);return new jl(e,t,r,n)}const ql=64,Vl=128,Jl=1024,Wl=205===new Uint8Array(new Uint16Array([43981]).buffer)[0];function $l(e,t,r){return e[r+0]=t,e[r+1]=t>>8,e[r+2]=t>>16,e[r+3]=t>>24,e}function Yl(e,t,r){if(t>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let n=t;for(let t=r;t<r+7;t++)e[t]=n,n=(n-e[t])/256;return e}function Zl(e,t,r){const n=new Uint8Array(64),i=new Uint8Array(4+t.length);if($l(i,e,0),i.set(t,4),e<=64)return Gl(e).update(i).digest(r),r;const s=Math.ceil(e/32)-2;for(let e=0;e<s;e++)Gl(64).update(0===e?i:n).digest(n),r.set(n.subarray(0,32),32*e);const a=new Uint8Array(Gl(e-32*s).update(n).digest());return r.set(a,32*s),r}function Xl(e,t,r,n){return e.fn.XOR(t.byteOffset,r.byteOffset,n.byteOffset),t}function ef(e,t,r,n){return e.fn.G(t.byteOffset,r.byteOffset,n.byteOffset,e.refs.gZ.byteOffset),n}function tf(e,t,r,n){return e.fn.G2(t.byteOffset,r.byteOffset,n.byteOffset,e.refs.gZ.byteOffset),n}function*rf(e,t,r,n,i,s,a,o){e.refs.prngTmp.fill(0);const c=e.refs.prngTmp.subarray(0,48);Yl(c,t,0),Yl(c,r,8),Yl(c,n,16),Yl(c,i,24),Yl(c,s,32),Yl(c,2,40);for(let t=1;t<=a;t++){Yl(e.refs.prngTmp,t,c.length);const r=tf(e,e.refs.ZERO1024,e.refs.prngTmp,e.refs.prngR);for(let e=1===t?8*o:0;e<r.length;e+=8)yield r.subarray(e,e+8)}return[]}let nf;function sf(e,t,r,i){var s=null,a=n.atob(r),o=a.length;s=new Uint8Array(new ArrayBuffer(o));for(var c=0;c<o;c++)s[c]=a.charCodeAt(c);return function(e,t){var r=WebAssembly.instantiate,n=WebAssembly.compile;return t?r(e,t):n(e)}(s,i)}var af=Object.freeze({__proto__:null,default:async()=>async function(e,t){const r=new WebAssembly.Memory({initial:1040,maximum:65536}),n=await async function(e,t,r){const n={env:{memory:e}};if(void 0===nf)try{const e=await t(n);return nf=!0,e}catch(e){nf=!1}return(nf?t:r)(n)}(r,e,t);return e=>function(e,{memory:t,instance:r}){if(!Wl)throw Error("BigEndian system not supported");const n=function({type:e,version:t,tagLength:r,password:n,salt:i,ad:s,secret:a,parallelism:o,memorySize:c,passes:u}){const h=(e,t,r,n)=>{if(t<r||t>n)throw Error(`${e} size should be between ${r} and ${n} bytes`)};if(2!==e||19!==t)throw Error("Unsupported type or version");return h("password",n,8,4294967295),h("salt",i,8,4294967295),h("tag",r,4,4294967295),h("memory",c,8*o,4294967295),s&&h("associated data",s,0,4294967295),a&&h("secret",a,0,32),{type:e,version:t,tagLength:r,password:n,salt:i,ad:s,secret:a,lanes:o,memorySize:c,passes:u}}({type:2,version:19,...e}),{G:i,G2:s,xor:a,getLZ:o}=r.exports,c={},u={};u.G=i,u.G2=s,u.XOR=a;const h=4*n.lanes*Math.floor(n.memorySize/(4*n.lanes)),l=h*Jl+10240;if(t.buffer.byteLength<l){const e=Math.ceil((l-t.buffer.byteLength)/65536);t.grow(e)}let f=0;c.gZ=new Uint8Array(t.buffer,f,Jl),f+=c.gZ.length,c.prngR=new Uint8Array(t.buffer,f,Jl),f+=c.prngR.length,c.prngTmp=new Uint8Array(t.buffer,f,Jl),f+=c.prngTmp.length,c.ZERO1024=new Uint8Array(t.buffer,f,1024),f+=c.ZERO1024.length;const y=new Uint32Array(t.buffer,f,2);f+=y.length*Uint32Array.BYTES_PER_ELEMENT;const d={fn:u,refs:c},p=new Uint8Array(t.buffer,f,Jl);f+=p.length;const g=new Uint8Array(t.buffer,f,n.memorySize*Jl),A=new Uint8Array(t.buffer,0,f),w=function(e){const t=Gl(64),r=new Uint8Array(4),n=new Uint8Array(24);$l(n,e.lanes,0),$l(n,e.tagLength,4),$l(n,e.memorySize,8),$l(n,e.passes,12),$l(n,e.version,16),$l(n,e.type,20);const i=[n];e.password?(i.push($l(new Uint8Array(4),e.password.length,0)),i.push(e.password)):i.push(r),e.salt?(i.push($l(new Uint8Array(4),e.salt.length,0)),i.push(e.salt)):i.push(r),e.secret?(i.push($l(new Uint8Array(4),e.secret.length,0)),i.push(e.secret)):i.push(r),e.ad?(i.push($l(new Uint8Array(4),e.ad.length,0)),i.push(e.ad)):i.push(r),t.update(function(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++){if(!(e[r]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");t+=e[r].length}const r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}(i));const s=t.digest();return new Uint8Array(s)}(n),m=h/n.lanes,b=Array(n.lanes).fill(null).map((()=>Array(m))),E=(e,t)=>(b[e][t]=g.subarray(e*m*1024+1024*t,e*m*1024+1024*t+Jl),b[e][t]);for(let e=0;e<n.lanes;e++){const t=new Uint8Array(w.length+8);t.set(w),$l(t,0,w.length),$l(t,e,w.length+4),Zl(Jl,t,E(e,0)),$l(t,1,w.length),Zl(Jl,t,E(e,1))}const k=m/4;for(let e=0;e<n.passes;e++)for(let t=0;t<4;t++){const r=0===e&&t<=1;for(let i=0;i<n.lanes;i++){let s=0===t&&0===e?2:0;const a=r?rf(d,e,i,t,h,n.passes,k,s):null;for(;s<k;s++){const c=t*k+s,u=c>0?b[i][c-1]:b[i][m-1],h=r?a.next().value:u;o(y.byteOffset,h.byteOffset,i,n.lanes,e,t,s,4,k);const l=y[0],f=y[1];0===e&&E(i,c),ef(d,u,b[l][f],e>0?p:b[i][c]),e>0&&Xl(d,b[i][c],p,b[i][c])}}}const v=b[0][m-1];for(let e=1;e<n.lanes;e++)Xl(d,v,v,b[e][m-1]);const B=Zl(n.tagLength,v,new Uint8Array(n.tagLength));return A.fill(0),t.grow(0),B}(e,{instance:n.instance,memory:r})}((e=>sf(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",e)),(e=>sf(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",e)))}),of=[0,1,3,7,15,31,63,127,255],cf=function(e){this.stream=e,this.bitOffset=0,this.curByte=0,this.hasByte=!1};cf.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},cf.prototype.read=function(e){for(var t=0;e>0;){this._ensureByte();var r=8-this.bitOffset;if(e>=r)t<<=r,t|=of[r]&this.curByte,this.hasByte=!1,this.bitOffset=0,e-=r;else{t<<=e;var n=r-e;t|=(this.curByte&of[e]<<n)>>n,this.bitOffset+=e,e=0}}return t},cf.prototype.seek=function(e){var t=e%8,r=(e-t)/8;this.bitOffset=t,this.stream.seek(r),this.hasByte=!1},cf.prototype.pi=function(){var e,t=new Uint8Array(6);for(e=0;e<t.length;e++)t[e]=this.read(8);return function(e){return Array.prototype.map.call(e,(e=>("00"+e.toString(16)).slice(-2))).join("")}(t)};var uf=cf,hf=function(){};hf.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},hf.prototype.read=function(e,t,r){for(var n=0;n<r;){var i=this.readByte();if(i<0)return 0===n?-1:n;e[t++]=i,n++}return n},hf.prototype.seek=function(e){throw Error("abstract method seek() not implemented")},hf.prototype.writeByte=function(e){throw Error("abstract method readByte() not implemented")},hf.prototype.write=function(e,t,r){var n;for(n=0;n<r;n++)this.writeByte(e[t++]);return r},hf.prototype.flush=function(){};var lf,ff=hf,yf=(lf=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var e=4294967295;this.getCRC=function(){return~e>>>0},this.updateCRC=function(t){e=e<<8^lf[255&(e>>>24^t)]},this.updateCRCRun=function(t,r){for(;r-- >0;)e=e<<8^lf[255&(e>>>24^t)]}}),df=uf,pf=ff,gf=yf,Af=function(e,t){var r,n=e[t];for(r=t;r>0;r--)e[r]=e[r-1];return e[0]=n,n},wf={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},mf={};mf[wf.LAST_BLOCK]="Bad file checksum",mf[wf.NOT_BZIP_DATA]="Not bzip data",mf[wf.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",mf[wf.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",mf[wf.DATA_ERROR]="Data error",mf[wf.OUT_OF_MEMORY]="Out of memory",mf[wf.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var bf=function(e,t){var r=mf[e]||"unknown error";t&&(r+=": "+t);var n=new TypeError(r);throw n.errorCode=e,n},Ef=function(e,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(e,t)};Ef.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new gf,!0):(this.writeCount=-1,!1)},Ef.prototype._start_bunzip=function(e,t){var r=new Uint8Array(4);4===e.read(r,0,4)&&"BZh"===String.fromCharCode(r[0],r[1],r[2])||bf(wf.NOT_BZIP_DATA,"bad magic");var n=r[3]-48;(n<1||n>9)&&bf(wf.NOT_BZIP_DATA,"level out of range"),this.reader=new df(e),this.dbufSize=1e5*n,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},Ef.prototype._get_next_block=function(){var e,t,r,n=this.reader,i=n.pi();if("177245385090"===i)return!1;"314159265359"!==i&&bf(wf.NOT_BZIP_DATA),this.targetBlockCRC=n.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,n.read(1)&&bf(wf.OBSOLETE_INPUT);var s=n.read(24);s>this.dbufSize&&bf(wf.DATA_ERROR,"initial position out of bounds");var a=n.read(16),o=new Uint8Array(256),c=0;for(e=0;e<16;e++)if(a&1<<15-e){var u=16*e;for(r=n.read(16),t=0;t<16;t++)r&1<<15-t&&(o[c++]=u+t)}var h=n.read(3);(h<2||h>6)&&bf(wf.DATA_ERROR);var l=n.read(15);0===l&&bf(wf.DATA_ERROR);var f=new Uint8Array(256);for(e=0;e<h;e++)f[e]=e;var y=new Uint8Array(l);for(e=0;e<l;e++){for(t=0;n.read(1);t++)t>=h&&bf(wf.DATA_ERROR);y[e]=Af(f,t)}var d,p=c+2,g=[];for(t=0;t<h;t++){var A,w,m=new Uint8Array(p),b=new Uint16Array(21);for(a=n.read(5),e=0;e<p;e++){for(;(a<1||a>20)&&bf(wf.DATA_ERROR),n.read(1);)n.read(1)?a--:a++;m[e]=a}for(A=w=m[0],e=1;e<p;e++)m[e]>w?w=m[e]:m[e]<A&&(A=m[e]);d={},g.push(d),d.permute=new Uint16Array(258),d.limit=new Uint32Array(22),d.base=new Uint32Array(21),d.minLen=A,d.maxLen=w;var E=0;for(e=A;e<=w;e++)for(b[e]=d.limit[e]=0,a=0;a<p;a++)m[a]===e&&(d.permute[E++]=a);for(e=0;e<p;e++)b[m[e]]++;for(E=a=0,e=A;e<w;e++)E+=b[e],d.limit[e]=E-1,E<<=1,a+=b[e],d.base[e+1]=E-a;d.limit[w+1]=Number.MAX_VALUE,d.limit[w]=E+b[w]-1,d.base[A]=0}var k=new Uint32Array(256);for(e=0;e<256;e++)f[e]=e;var v,B=0,S=0,I=0,C=this.dbuf=new Uint32Array(this.dbufSize);for(p=0;;){for(p--||(p=49,I>=l&&bf(wf.DATA_ERROR),d=g[y[I++]]),e=d.minLen,t=n.read(e);e>d.maxLen&&bf(wf.DATA_ERROR),!(t<=d.limit[e]);e++)t=t<<1|n.read(1);((t-=d.base[e])<0||t>=258)&&bf(wf.DATA_ERROR);var K=d.permute[t];if(0!==K&&1!==K){if(B)for(B=0,S+a>this.dbufSize&&bf(wf.DATA_ERROR),k[v=o[f[0]]]+=a;a--;)C[S++]=v;if(K>c)break;S>=this.dbufSize&&bf(wf.DATA_ERROR),k[v=o[v=Af(f,e=K-1)]]++,C[S++]=v}else B||(B=1,a=0),a+=0===K?B:2*B,B<<=1}for((s<0||s>=S)&&bf(wf.DATA_ERROR),t=0,e=0;e<256;e++)r=t+k[e],k[e]=t,t=r;for(e=0;e<S;e++)C[k[v=255&C[e]]]|=e<<8,k[v]++;var P=0,U=0,D=0;return S&&(U=255&(P=C[s]),P>>=8,D=-1),this.writePos=P,this.writeCurrent=U,this.writeCount=S,this.writeRun=D,!0},Ef.prototype._read_bunzip=function(e,t){var r,n,i;if(this.writeCount<0)return 0;var s=this.dbuf,a=this.writePos,o=this.writeCurrent,c=this.writeCount;this.outputsize;for(var u=this.writeRun;c;){for(c--,n=o,o=255&(a=s[a]),a>>=8,3==u++?(r=o,i=n,o=-1):(r=1,i=o),this.blockCRC.updateCRCRun(i,r);r--;)this.outputStream.writeByte(i),this.nextoutput++;o!=n&&(u=0)}return this.writeCount=c,this.blockCRC.getCRC()!==this.targetBlockCRC&&bf(wf.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var kf=function(e){if("readByte"in e)return e;var t=new pf;return t.pos=0,t.readByte=function(){return e[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=e.length},t},vf=function(e){var t=new pf,r=!0;if(e)if("number"==typeof e)t.buffer=new Uint8Array(e),r=!1;else{if("writeByte"in e)return e;t.buffer=e,r=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(e){if(r&&this.pos>=this.buffer.length){var t=new Uint8Array(2*this.buffer.length);t.set(this.buffer),this.buffer=t}this.buffer[this.pos++]=e},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!r)throw new TypeError("outputsize does not match decoded input");var e=new Uint8Array(this.pos);e.set(this.buffer.subarray(0,this.pos)),this.buffer=e}return this.buffer},t._coerced=!0,t},Bf={Bunzip:Ef,Stream:pf,Err:wf,decode:function(e,t,r){for(var n=kf(e),i=vf(t),s=new Ef(n,i);!("eof"in n)||!n.eof();)if(s._init_block())s._read_bunzip();else{var a=s.reader.read(32)>>>0;if(a!==s.streamCRC&&bf(wf.DATA_ERROR,"Bad stream CRC (got "+s.streamCRC.toString(16)+" expected "+a.toString(16)+")"),!r||!("eof"in n)||n.eof())break;s._start_bunzip(n,i)}if("getBuffer"in i)return i.getBuffer()},decodeBlock:function(e,t,r){var n=kf(e),i=vf(r),s=new Ef(n,i);if(s.reader.seek(t),s._get_next_block()&&(s.blockCRC=new gf,s.writeCopies=0,s._read_bunzip()),"getBuffer"in i)return i.getBuffer()},table:function(e,t,r){var n=new pf;n.delegate=kf(e),n.pos=0,n.readByte=function(){return this.pos++,this.delegate.readByte()},n.delegate.eof&&(n.eof=n.delegate.eof.bind(n.delegate));var i=new pf;i.pos=0,i.writeByte=function(){this.pos++};for(var s=new Ef(n,i),a=s.dbufSize;!("eof"in n)||!n.eof();){var o=8*n.pos+s.reader.bitOffset;if(s.reader.hasByte&&(o-=8),s._init_block()){var c=i.pos;s._read_bunzip(),t(o,i.pos-c)}else{if(s.reader.read(32),!r||!("eof"in n)||n.eof())break;s._start_bunzip(n,i),console.assert(s.dbufSize===a,"shouldn't change block size within multistream file")}}}},Sf=i({__proto__:null},[Bf])}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.amdO={},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const{v4:n}=r(182),i="utf-8",s=r(526),a=r(604),o=r(806),{sha256:c}=r(312);str2bytes=e=>new TextEncoder(i).encode(e),bytes2str=e=>new TextDecoder(i).decode(e),bytes2base64str=e=>s.fromByteArray(e),base64str2bytes=e=>s.toByteArray(e),sym_encrypt=async(e,t)=>{const r=await a.createMessage({binary:e});return await a.encrypt({message:r,passwords:[t],format:"armored"})},sym_decrypt=async(e,t)=>{const r=await a.readMessage({armoredMessage:e});return res=await a.decrypt({message:r,passwords:[t],format:"binary"}),res.data},gen_keys=async(e,t,r)=>{const{privateKey:n,publicKey:i}=await a.generateKey({type:"rsa",rsaBits:4096,userIDs:[{name:e,email:t}],passphrase:r});return{private_key:n,public_key:i}},gen_keys2=async(e,t)=>{const{privateKey:r,publicKey:n}=await a.generateKey({type:"rsa",rsaBits:4096,userIDs:[{name:e,email:t}]});return{private_key:r,public_key:n}},sym_encrypt_json=async(e,t)=>(json1_str=JSON.stringify(e),json1_str_bytes=str2bytes(json1_str),await sym_encrypt(json1_str_bytes,t)),sym_decrypt_json=async(e,t)=>(json1_str_bytes=await sym_decrypt(e,t),json1_str=bytes2str(json1_str_bytes),JSON.parse(json1_str)),encrypt=async(e,t)=>{const r=await a.readKey({armoredKey:e});return await a.encrypt({message:await a.createMessage({binary:t}),encryptionKeys:r,format:"armored"})},decrypt=async(e,t,r)=>{const n=await a.readMessage({armoredMessage:r}),i=await a.decryptKey({privateKey:await a.readPrivateKey({armoredKey:e}),passphrase:t}),{data:s,signatures:o}=await a.decrypt({message:n,decryptionKeys:i,format:"binary"});return s},decrypt2=async(e,t)=>{const r=await a.readMessage({armoredMessage:t});privateKey=await a.readPrivateKey({armoredKey:e});const{data:n,signatures:i}=await a.decrypt({message:r,decryptionKeys:privateKey,format:"binary"});return n},populate_select_list=async(e,t)=>{t.options.length=0,e.forEach((e=>{const r=document.createElement("option");r.value=e,r.text=e,t.appendChild(r)}))},wait1=async e=>new Promise((t=>setTimeout(t,1e3*e))),save_file=async(e,t)=>{const r=new Blob([e],{type:"application/octet-stream"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)},open_file_picker=async e=>{const t=document.createElement("input");t.type="file",t.addEventListener("change",(()=>{const r=t.files[0],n=new FileReader;n.onload=async t=>{const r=t.target.result,n=new Uint8Array(r);bytes1=bytes2str(n),await e(bytes1)},n.readAsArrayBuffer(r)})),t.click()},open_file_picker_cb=(e,t)=>{e.addEventListener("change",(()=>{const r=e.files[0],n=new FileReader;n.onload=e=>{const r=e.target.result,n=new Uint8Array(r);bytes1=bytes2str(n),t(bytes1)},n.readAsArrayBuffer(r)}))},open_file_picker_async_cb=(e,t)=>{e.addEventListener("change",(()=>{if(e.files.length>0){const r=e.files[0],n=new FileReader;n.onload=async e=>{const r=e.target.result,n=new Uint8Array(r);text1=bytes2str(n),await t(text1)},n.readAsArrayBuffer(r)}}))},open_file_picker_wz_filename_async_cb=(e,t)=>{e.addEventListener("change",(()=>{if(e.files.length>0){const r=e.files[0],n=new FileReader;n.onload=async e=>{const n=e.target.result,i=new Uint8Array(n);text1=bytes2str(i),await t(r.name,text1)},n.readAsArrayBuffer(r)}}))},_get=e=>document.getElementById(e),handle_form_submit_async_cb=(e,t)=>{document.getElementById(e).addEventListener("submit",(async e=>{e.preventDefault(),await t(e)}))},handle_click_async_cb=(e,t)=>{document.getElementById(e).addEventListener("click",(async e=>{e.preventDefault(),await t(e)}))},_handle_event_async_cb=(e,t,r)=>{document.getElementById(e).addEventListener(t,(async e=>{await r(e)}))},handle_enter_async_cb=(e,t)=>{document.getElementById(e).addEventListener("keypress",(async e=>{"Enter"===e.key&&await t(e)}))},handle_change_async_cb=(e,t)=>{_handle_event_async_cb(e,"change",t)};const u=["setup_div","main_div","login_div","backup_div"];show_div=e=>{for(const t of u)e===t?_get(t).classList.remove("hidden"):_get(t).classList.add("hidden")},form2form_data=e=>new FormData(document.getElementById(e)),form_data2json=e=>Object.fromEntries(e.entries()),form2json=e=>form_data2json(form2form_data(e)),validate_setup_form=async e=>{const t=document.getElementById("password"),r=document.getElementById("confirmPassword"),n=document.getElementById("git_password"),i=document.getElementById("git_confirm_password"),s=document.getElementById("git_token"),a=document.getElementById("git_confirm_token");t.value!==r.value?(t.value="",r.value="",t.focus(),alert("Passwords do not match. Please try again.")):n.value!==i.value?(n.value="",i.value="",n.focus(),alert("Git passwords do not match. Please try again.")):s.value!==a.value?(s.value="",a.value="",s.focus(),alert("Git tokens do not match. Please try again.")):await e()},sha256_1=e=>{var t=c.create();return t.update(e),t.hex()},ts1=()=>{const e=new Date;return function(){const t={Y:e.getFullYear(),m:("0"+(e.getMonth()+1)).slice(-2),d:("0"+e.getDate()).slice(-2),H:("0"+e.getHours()).slice(-2),M:("0"+e.getMinutes()).slice(-2),S:("0"+e.getSeconds()).slice(-2)};return"%Y%m%d_%H%M%S".replace(/%([YmHdHMS])/g,((e,r)=>t[r]))}()},window.uuidv4=n,window.str2bytes=str2bytes,window.bytes2str=bytes2str,window.bytes2base64str=bytes2base64str,window.base64str2bytes=base64str2bytes,window.sym_encrypt=sym_encrypt,window.sym_decrypt=sym_decrypt,window.gen_keys=gen_keys,window.sym_encrypt_json=sym_encrypt_json,window.sym_decrypt_json=sym_decrypt_json,window.encrypt=encrypt,window.decrypt=decrypt,window.save_file=save_file,window.open_file_picker=open_file_picker,window.open_file_picker_cb=open_file_picker_cb,window.open_file_picker_async_cb=open_file_picker_async_cb,window.handle_form_submit_async_cb=handle_form_submit_async_cb,window.open_file_picker_wz_filename_async_cb=open_file_picker_wz_filename_async_cb,window.handle_click_async_cb=handle_click_async_cb,window.handle_enter_async_cb=handle_enter_async_cb,window.validate_setup_form=validate_setup_form,window.form2json=form2json,window.populate_select_list=populate_select_list,window.get_file=async(e,t,r,n,i)=>await o.get(`https://api.github.com/repos/${e}/${t}/contents/${i}`,{headers:{Authorization:`token ${r}`},params:{ref:n}}),window.add_upd_file=async(e,t,r,n,i,s,a=void 0)=>(commit_msg=void 0,commit_msg=void 0===a?`added ${i}`:`updated ${i}`,await o.put(`https://api.github.com/repos/${e}/${t}/contents/${i}`,{message:commit_msg,content:s,branch:n,sha:a},{headers:{Authorization:`token ${r}`},params:{ref:n}})),window.del_file=async(e,t,r,n,i,s=void 0)=>await o.delete(`https://api.github.com/repos/${e}/${t}/contents/${i}`,{headers:{Authorization:`token ${r}`},params:{ref:n},data:{message:"del file",branch:n,sha:s}}),window.get_file_list=async(e,t,r,n)=>(await o.get(`https://api.github.com/repos/${e}/${t}/contents/`,{headers:{Authorization:`token ${r}`},params:{ref:n}})).data.filter((e=>"file"===e.type)).map((e=>e.path)),window._get=_get,window.show_div=show_div,window.wait1=wait1,window.ts1=ts1,window.sha256_1=sha256_1})();